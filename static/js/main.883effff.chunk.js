(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{105:function(e,t,a){},124:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},135:function(e,t,a){},159:function(e,t){},161:function(e,t){},168:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},173:function(e,t,a){},174:function(e,t,a){},175:function(e,t,a){},176:function(e,t,a){},177:function(e,t,a){},178:function(e,t,a){},179:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(31),s=a.n(c),i=a(26),o=a(73),l=a(1),u=a(28),m=a(5),f=function(){var e=function(){var e=sessionStorage.getItem("user"),t=JSON.parse(e);return t||void 0},t=Object(n.useState)(e()),a=Object(l.a)(t,2),r=a[0],c=a[1];return{getUser:e,setUser:function(e){sessionStorage.setItem("user",JSON.stringify(e)),c(e)},user:r,unsetUser:function(){sessionStorage.removeItem("user"),c(void 0)}}},d=a(9),p=a.n(d),g=a(19),v=(a(105),function(e){var t=e.label,a=e.name,n=e.value,c=e.onChange,s=e.checked;return r.a.createElement("div",{className:"radio"},r.a.createElement("input",{className:"custom-radio",type:"radio",id:"color-"+n,name:a,value:n,defaultChecked:s,onClick:function(e){return c(e.currentTarget.value)}}),r.a.createElement("label",{htmlFor:"color-"+n},t))}),b=a(74),h=a.n(b),E=a(37),O=h.a.create({baseURL:"".concat(E.a,"/api"),headers:{"Content-Type":"application/json"}});O.interceptors.response.use((function(e){return e}),(function(e){401===e.response.status&&(0,f().unsetUser)();return Promise.reject(e)}));var k=O,N=(a(124),function(){var e=Object(g.a)(p.a.mark((function e(t){var a,n,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.credentials,n=t.type,e.prev=1,"teacher"!==n){e.next=9;break}return e.next=5,k.post("/auth/teacher",a);case 5:return r=e.sent,e.abrupt("return",r.data);case 9:if("student"!==n){e.next=14;break}return e.next=12,k.post("/auth/student",a);case 12:return c=e.sent,e.abrupt("return",c.data);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(1),e.t0.response.data.errors;case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}()),j=function(e){var t=e.setAuth,a=Object(m.g)(),c=Object(i.d)(),s=f().setUser,o=Object(n.useState)(),u=Object(l.a)(o,2),d=u[0],b=u[1],h=Object(n.useState)(),E=Object(l.a)(h,2),O=E[0],k=E[1],j=Object(n.useState)("student"),w=Object(l.a)(j,2),y=w[0],C=w[1],x=function(){var e=Object(g.a)(p.a.mark((function e(n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t({user:void 0,isAuthenticated:!1,isLoading:!0}),e.prev=2,e.next=5,N({credentials:{login:d,password:O},type:y});case 5:r=e.sent,s(r),t({user:r,isAuthenticated:!0,isLoading:!1}),a.push("/"+r.type),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),t({user:void 0,isAuthenticated:!1,isLoading:!1}),e.t0.forEach((function(e){c.show(e.msg)}));case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"background-holder"},r.a.createElement("div",{className:"login-form"},r.a.createElement("form",{className:"form",onSubmit:function(e){return x(e)}},r.a.createElement("div",{className:"login-header"},r.a.createElement("p",null,"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 ",r.a.createElement("br",null),r.a.createElement("span",{className:"golden-compass"},r.a.createElement("span",{className:"g-letter"},"G"),"olden Compass"))),r.a.createElement("div",{className:"inputs-wrapper"},r.a.createElement("div",{className:"form-group field"},r.a.createElement("input",{type:"input",className:"form-field",placeholder:"\u041b\u043e\u0433\u0438\u043d",name:"login",id:"login",onChange:function(e){return b(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"login",className:"form-label"},"\u041b\u043e\u0433\u0438\u043d")),r.a.createElement("div",{className:"form-group field"},r.a.createElement("input",{type:"password",className:"form-field",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",id:"password",onChange:function(e){return k(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"password",className:"form-label"},"\u041f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement(v,{onChange:function(e){return C(e)},label:"\u0423\u0447\u0438\u0442\u0435\u043b\u044c",name:"type",value:"teacher"}),r.a.createElement(v,{onChange:function(e){return C(e)},label:"\u0423\u0447\u0435\u043d\u0438\u043a",name:"type",value:"student",checked:!0}),r.a.createElement("div",{className:"submit-btn-wrapper"},r.a.createElement("button",{type:"submit",className:"btn",id:"loginBtn"},r.a.createElement("span",null,"\u0412\u043e\u0439\u0442\u0438"))))),r.a.createElement("div",{className:"login-image"}))))},w=(a(130),function(e){var t=e.link,a=e.label;return r.a.createElement("div",{className:"menu-item underline"},r.a.createElement(u.b,{to:t},a))}),y=a(17),C=(a(131),function(){var e=Object(m.g)();return r.a.createElement("div",{className:"back-btn"},r.a.createElement("div",{className:"back",onClick:function(){e.goBack()}},r.a.createElement(y.a,null)))}),x=function(e){var t=e.logout,a=f().user;return r.a.createElement("div",{className:"menu-bg"},r.a.createElement("div",{className:"menu-wrapper"},r.a.createElement(w,{link:"/canvas/".concat(a.login),label:"\u041d\u0430\u0447\u0430\u0442\u044c \u0443\u0440\u043e\u043a"}),r.a.createElement(w,{link:"/reset-password/".concat(a.login,"/").concat(a.type),label:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"}),r.a.createElement("button",{className:"menu-button underline",onClick:t},"\u0412\u044b\u0439\u0442\u0438")),r.a.createElement(C,null))},P=function(e){var t=e.teacher;return r.a.createElement("div",null,r.a.createElement(w,{link:"/canvas/".concat(t.login),label:t.name}))},S=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],s=f().user;return Object(n.useEffect)((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.post("/student/get-teachers",{studentLogin:s.login});case 2:t=e.sent,c(t.data.teachers);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e)}))}),[s]),r.a.createElement("div",{className:"menu-bg",id:"resetPassForm"},r.a.createElement("div",{className:"menu-wrapper"},r.a.createElement("div",{className:"login-header"},r.a.createElement("p",null,a.length?"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0443\u0447\u0438\u0442\u0435\u043b\u044f...":"\u0414\u043b\u044f \u0432\u0430\u0441 \u043d\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043e \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0443\u0447\u0438\u0442\u0435\u043b\u044f...")),a.map((function(e){return r.a.createElement(P,{key:e._id,teacher:e})})),r.a.createElement(C,null)))},A=(a(132),function(){return r.a.createElement("div",{className:"error-wrapper"},r.a.createElement("div",{className:"error-text"},"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"))}),T=function(e){var t=e.logout,a=f();return r.a.createElement("div",{className:"menu-bg"},r.a.createElement("div",{className:"menu-wrapper"},r.a.createElement(w,{link:"/teachers-list",label:"\u041d\u0430\u0447\u0430\u0442\u044c \u0443\u0440\u043e\u043a"}),r.a.createElement(w,{link:"/reset-password/".concat(a.login,"/").concat(a.type),label:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"}),r.a.createElement("button",{className:"menu-button underline",onClick:t},"\u0412\u044b\u0439\u0442\u0438")),r.a.createElement(C,null))},M=a(96),I=(a(133),function(){return r.a.createElement("div",{className:"holder"},r.a.createElement("svg",{className:"loader",viewBox:"0 0 24 24"},r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"}),r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"}),r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"}),r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"}),r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"}),r.a.createElement("circle",{className:"loader__value",cx:"12",cy:"12",r:"10"})))}),R=["component","auth"],L=function(e){var t=e.component,a=e.auth,n=a.isAuthenticated,c=a.isLoading,s=Object(M.a)(e,R);return r.a.createElement(m.b,Object.assign({},s,{render:function(e){return c?r.a.createElement(I,null):n?r.a.createElement(t,Object.assign({},e,s)):r.a.createElement(m.a,{to:"/login"})}}))},B=(a(134),a(77)),H=a.n(B),W=function(e){var t=e.logout;return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"logo"},r.a.createElement("div",{className:"logo-icon"},r.a.createElement("img",{src:H.a,alt:"\u0417\u043e\u043b\u043e\u0442\u043e\u0439 \u043a\u043e\u043c\u043f\u0430\u0441"}))),r.a.createElement("div",{className:"logout"},r.a.createElement("div",{id:"logoutBtn",onClick:t},r.a.createElement(y.i,null))))},K=(a(135),function(e){var t=e.message,a=e.active;return r.a.createElement("div",{className:"waiting-screen ".concat(a?"":"hidden")},r.a.createElement("div",{className:"title"},t||"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430..."),r.a.createElement(C,null))}),F=a(42),Q=a.n(F),U=a(46),_=Object(U.a)(E.a),D=Object(n.createContext)(""),G=(a(168),function(e){var t=e.room,a=Object(n.useContext)(D),c=a.setup,s=a.caller,i=a.callAccepted,o=a.calling,l=a.receivingCall,u=a.myVideo,m=a.userVideo,d=a.callTeacher,p=a.answerCall,g=a.leaveCall;Object(n.useEffect)((function(){c()}),[]);var v=(0,f().getUser)();return r.a.createElement("div",{className:"video-wrapper"},o&&r.a.createElement("div",{className:"notification"},r.a.createElement("div",{className:"notification-inner"},"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u0432\u044b\u0437\u043e\u0432 \u0443\u0447\u0438\u0442\u0435\u043b\u044e")),l&&r.a.createElement("div",{className:"notification"},r.a.createElement("div",{className:"notification-inner"},"\u0423\u0447\u0435\u043d\u0438\u043a \u0432\u0430\u0441 \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442")),!i&&!o&&"student"===v.type&&r.a.createElement("div",{className:"notification"},r.a.createElement("div",{className:"notification-inner"},"\u0427\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e\u0441\u0432\u044f\u0437\u044c, \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443 \u043d\u0430\u0434 \u0432\u0430\u0448\u0438\u043c \u0432\u0438\u0434\u0435\u043e")),r.a.createElement("div",{className:"teacher-video video"},r.a.createElement("video",{ref:u,muted:!0,autoPlay:!0,className:"my-video"}),r.a.createElement("div",{className:"video-buttons start-call-buttons"},"student"===v.type&&!o&&!i&&r.a.createElement("div",{className:"video-button green",onClick:function(){return d(t)}},r.a.createElement(y.g,null)),"teacher"===v.type&&l&&r.a.createElement("div",{className:"video-button green",onClick:function(){return p(s)}},r.a.createElement(y.g,null)),i&&r.a.createElement("div",{className:"video-button red",onClick:function(){return g(s)}},r.a.createElement(y.h,null)))),r.a.createElement("div",{className:"video-border"}),r.a.createElement("div",{className:"student-video video"},r.a.createElement("video",{ref:m,autoPlay:!0,className:"accepted-video"})))}),V=function(e){var t=e.tip,a=f().user.type;return r.a.createElement("div",{className:"tip-area"},r.a.createElement("div",{className:"tip-text"},"teacher"===a?r.a.createElement("p",null,t||""):""))},X=a(81),Y=a.n(X),z=a(82),q=a.n(z),J="PENCIL",Z="ERASER",$="CURSOR",ee="";function te(e){var t,a,n,r,c,s,i,o,l=ee,u=!0,m=10,f="white";e.setup=function(){s=e.loadImage(q.a);var t=document.getElementById("mainCanvas");if(t){i=t.offsetWidth,o=t.offsetHeight;for(var a=t.getElementsByTagName("canvas"),l=0;l<a.length;l++)a[l]&&a[l].parentElement.removeChild(a[l]);n=e.createCanvas(i,o),r=e.createGraphics(i,o),c=e.createGraphics(i,o),n.parent("mainCanvas")}},e.draw=function(){if(e.clear(),e.image(r,0,0),e.image(c,0,0),l===$){e.noCursor();var n={x:e.mouseX/(i/100),y:e.mouseY/(o/100)};t.emit("canvas-cursor",{room:a,data:n})}else e.cursor(),l===Z&&d({x:e.mouseX,y:e.mouseY})},e.mouseDragged=function(){if(u)if(l===J){var n={x:e.mouseX/(i/100),y:e.mouseY/(o/100),pMouseX:e.pmouseX/(i/100),pMouseY:e.pmouseY/(o/100),size:m,color:f};t.emit("canvas-pencil",{room:a,data:n})}else if(l===Z){var r={x:e.mouseX/(i/100),y:e.mouseY/(o/100)};t.emit("canvas-eraser",{room:a,data:r})}},e.mouseClicked=function(){if(u&&l===Z){var n={x:e.mouseX/(i/100),y:e.mouseY/(o/100)};t.emit("canvas-eraser",{room:a,data:n})}};var d=function(t){var a=t.x,n=t.y;c.clear(),c.fill(0,255,0,100),c.circle(a,n,30),e.image(c,0,0)};e.myCustomRedrawAccordingToNewPropsHandler=function(n){a=n.room,u=n.active,l=n.activeTool,m=n.drawWidth,f=n.drawColor,n.socket&&(t||((t=n.socket).on("draw",(function(e){!function(e){var t=e.x,a=e.y,n=e.pMouseX,c=e.pMouseY,s=e.size,l=e.color,u=r.color(l);r.stroke(u),r.strokeWeight(s),r.line(i/100*t,o/100*a,i/100*n,o/100*c,s)}(e)})),t.on("erase",(function(e){!function(e){var t=e.x,a=e.y;r.erase(),r.circle(i/100*t,o/100*a,30),r.noErase()}(e)})),t.on("cursor",(function(t){!function(t){var a=t.x,n=t.y;c.clear(),c.image(s,i/100*a,o/100*n,s.width/50,s.height/50),e.image(c,0,0)}(t)})),t.on("canvas-reset",(function(){r.clear()})),t.on("loaded-image",(function(){e.setup()}))))}}a(71);var ae=a(3),ne=Object(U.a)(E.a,{transports:["websocket"],upgrade:!1}),re=function(){return{socket:ne}},ce=[{current:0,number:1,beads:[1,2,3,4]},{current:0,number:2,beads:[1,2,3,4]},{current:0,number:3,beads:[1,2,3,4]},{current:0,number:4,beads:[1,2,3,4]},{current:0,number:5,beads:[1,2,3,4]},{current:0,number:6,beads:[1,2,3,4]},{current:0,number:7,beads:[1,2,3,4]},{current:0,number:8,beads:[1,2,3,4]},{current:0,number:9,beads:[1,2,3,4]},{current:0,number:10,beads:[1,2,3,4]},{current:0,number:11,beads:[1,2,3,4]},{current:0,number:12,beads:[1,2,3,4]},{current:0,number:13,beads:[1,2,3,4]},{current:0,number:14,beads:[1,2,3,4]},{current:0,number:15,beads:[1,2,3,4]}],se=[{current:0,number:1,beads:[1]},{current:0,number:2,beads:[1]},{current:0,number:3,beads:[1]},{current:0,number:4,beads:[1]},{current:0,number:5,beads:[1]},{current:0,number:6,beads:[1]},{current:0,number:7,beads:[1]},{current:0,number:8,beads:[1]},{current:0,number:9,beads:[1]},{current:0,number:10,beads:[1]},{current:0,number:11,beads:[1]},{current:0,number:12,beads:[1]},{current:0,number:13,beads:[1]},{current:0,number:14,beads:[1]},{current:0,number:15,beads:[1]}],ie=function(e){var t=e.room,a=re().socket,c=Object(n.useState)(ce),s=Object(l.a)(c,2),i=s[0],o=s[1],u=Object(n.useState)(se),m=Object(l.a)(u,2),f=m[0],d=m[1],p=function(e,n,r){var c=("bottom"===e?i:f).map((function(e){if(e.number===n){var t=r;return e.current>=r&&(t=r-1),Object(ae.a)(Object(ae.a)({},e),{},{current:t})}return e}));a.emit("abacus-clicked",{room:t,section:e,state:c})};return Object(n.useEffect)((function(){a.on("change-abacus",(function(e){var t=e.section,a=e.state,n="bottom"===t?o:d;try{n(a)}catch(r){console.log(r),console.log("Abacus not open")}}))}),[]),r.a.createElement("div",{className:"abacus-holder"},r.a.createElement("div",{className:"section upper-row"},f.map((function(e){return r.a.createElement("div",{key:e.number,className:"spoke"},e.beads.map((function(t){return r.a.createElement("div",{key:t,onClick:function(){return p("upper",e.number,t)},className:"bead bead-".concat(t," ").concat(t===e.current?"active":"")})})))}))),r.a.createElement("div",{className:"abacus-divider"}),r.a.createElement("div",{className:"section bottom-row"},i.map((function(e){return r.a.createElement("div",{key:e.number,className:"spoke"},e.beads.map((function(t){return r.a.createElement("div",{key:t,onClick:function(){return p("bottom",e.number,t)},className:"bead bead-".concat(t," ").concat(t===e.current?"active":"")})})))}))))},oe=function(e){var t=e.room,a=e.visible;return r.a.createElement("div",{className:"abacus-slide ".concat(a?"":"hidden")},r.a.createElement("div",{className:"abacus-border"},r.a.createElement("div",{className:"border left"}),r.a.createElement("div",{className:"border right"}),r.a.createElement("div",{className:"border top"}),r.a.createElement("div",{className:"border bottom"}),r.a.createElement(ie,{room:t})))},le=a(4),ue=a(6),me=a(7),fe=a(83),de=a.n(fe),pe=a(84),ge=a.n(pe),ve=a(85),be=a.n(ve),he=a(86),Ee=a.n(he),Oe=a(87),ke=a.n(Oe),Ne=a(88),je=a.n(Ne),we=a(89),ye=a.n(we),Ce=a(90),xe=a.n(Ce),Pe=a(91),Se=a.n(Pe),Ae=a(92),Te=a.n(Ae),Me=a(93),Ie=a.n(Me),Re=a(94),Le=a.n(Re),Be=function(){function e(t,a){var n=this;Object(ue.a)(this,e),this.prepareCellInitialState=function(t,a){var n,r,c,s=t.split(""),i=Object(l.a)(s,2),o=i[0],u=i[1];return["1","2"].includes(u)&&(r=a?e.sides.ME:e.sides.OPPONENT,c=e.colors.WHITE),["7","8"].includes(u)&&(r=a?e.sides.OPPONENT:e.sides.ME,c=e.colors.BLACK),"2"!==u&&"7"!==u||(n=e.figures.PAWN),["a1","h1","a8","h8"].includes(t)&&(n=e.figures.ROOK),["b1","g1","b8","g8"].includes(t)&&(n=e.figures.HORSE),["c1","f1","c8","f8"].includes(t)&&(n=e.figures.BISHOP),["d1","d8"].includes(t)&&(n=e.figures.QUEEN),["e1","e8"].includes(t)&&(n=e.figures.KING),{x:o,y:u,figure:n||null,side:r||null,color:c||null,possibleMove:!1}},this.getPossibleMovesForQueen=function(e,t,a,r,c){var s=[];return s.push.apply(s,Object(le.a)(n.getPossibleMovesForRook(e,t,a,r,c))),s.push.apply(s,Object(le.a)(n.getPossibleMovesForBishop(e,t,a,r,c))),s},this.rows=t,this.columns=a}return Object(me.a)(e,[{key:"getCell",value:function(e,t,a){if(!(t<0||t>7||a<0||a>7))return e[t][a]}},{key:"getKing",value:function(t){var a;return t.forEach((function(t){return t.forEach((function(t){t.figure===e.figures.KING&&t.side===e.sides.ME&&(a=t)}))})),a}},{key:"getImg",value:function(t){switch(t){case e.figures.PAWN+e.colors.BLACK:return de.a;case e.figures.BISHOP+e.colors.BLACK:return ge.a;case e.figures.HORSE+e.colors.BLACK:return be.a;case e.figures.ROOK+e.colors.BLACK:return Ee.a;case e.figures.QUEEN+e.colors.BLACK:return ke.a;case e.figures.KING+e.colors.BLACK:return je.a;case e.figures.PAWN+e.colors.WHITE:return ye.a;case e.figures.BISHOP+e.colors.WHITE:return xe.a;case e.figures.HORSE+e.colors.WHITE:return Se.a;case e.figures.ROOK+e.colors.WHITE:return Te.a;case e.figures.QUEEN+e.colors.WHITE:return Ie.a;case e.figures.KING+e.colors.WHITE:return Le.a}}},{key:"getAttackingPawns",value:function(t,a,n,r){return[this.getCell(t,n-1,r-1),this.getCell(t,n-1,r+1)].filter((function(t){return t&&t.figure===e.figures.PAWN&&t.side===e.sides.OPPONENT}))}},{key:"getAttackingHorses",value:function(t,a,n,r){return this.getPossibleMovesForHorse(t,a,n,r).filter((function(t){return t.figure===e.figures.HORSE}))}},{key:"getAttackingBishopsOrQueens",value:function(t,a,n,r){return this.getPossibleMovesForBishop(t,a,n,r).filter((function(t){return t.figure===e.figures.BISHOP||t.figure===e.figures.QUEEN}))}},{key:"getAttackingRooksOrQueens",value:function(t,a,n,r){return this.getPossibleMovesForRook(t,a,n,r).filter((function(t){return t.figure===e.figures.ROOK||t.figure===e.figures.QUEEN}))}},{key:"getAttackingKings",value:function(t,a,n,r){return this.getAllMovesForKing(t,a,n,r).filter((function(t){return t.figure===e.figures.KING&&t.side===e.sides.OPPONENT}))}},{key:"isUnderAttack",value:function(e,t){var a=this.rows.indexOf(Number(t.y)),n=this.columns.indexOf(t.x),r=[];return r.push.apply(r,Object(le.a)(this.getAttackingPawns(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingHorses(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingBishopsOrQueens(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingRooksOrQueens(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingKings(e,t,a,n))),r.length>0}},{key:"getAttackers",value:function(e,t){var a=this.rows.indexOf(Number(t.y)),n=this.columns.indexOf(t.x),r=[];return r.push.apply(r,Object(le.a)(this.getAttackingPawns(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingHorses(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingBishopsOrQueens(e,t,a,n))),r.push.apply(r,Object(le.a)(this.getAttackingRooksOrQueens(e,t,a,n))),r}},{key:"getDiagonalCells",value:function(e,t,a){var n=this.rows.indexOf(Number(t.y)),r=this.columns.indexOf(t.x),c=this.rows.indexOf(Number(a.y)),s=this.columns.indexOf(a.x);if(Math.max(n,c)-Math.min(n,c)!==Math.max(r,s)-Math.min(r,s))return[];for(var i=[],o=n<c?1:-1,l=r<s?1:-1,u=c,m=s;u!==n&&m!==r;u-=o,m-=l)i.push(this.getCell(e,u,m));return i}},{key:"getHorizontalCells",value:function(e,t,a){var n=this.rows.indexOf(Number(t.y)),r=this.columns.indexOf(t.x),c=this.rows.indexOf(Number(a.y)),s=this.columns.indexOf(a.x),i=[];if(n===c){if(r<s)for(var o=r+1;o<=s;o++)i.push(this.getCell(e,n,o));else if(r>s)for(var l=s;l<r;l++)i.push(this.getCell(e,n,l))}else{if(r!==s)return[];if(n<c)for(var u=n+1;u<=c;u++)i.push(this.getCell(e,u,r));else if(n>c)for(var m=c;m<n;m++)i.push(this.getCell(e,m,r))}return i}},{key:"filterAttackingBishopsForPin",value:function(e,t,a,n){var r=this;return n.filter((function(n){var c=r.getDiagonalCells(e,a,n);if(!c.length)return!1;for(var s=0;s<c.length;s++){var i=c[s];if(i.figure&&i.x!==t.x&&i.y!==t.y&&i.x!==n.x&&i.y!==n.y)return!1}return!0}))}},{key:"filterAttackingRooksForPin",value:function(e,t,a,n){var r=this;return n.filter((function(n){var c=r.getHorizontalCells(e,a,n);if(!c.length)return!1;for(var s=0;s<c.length;s++){var i=c[s];if(i.figure&&i.x!==t.x&&i.y!==t.y&&i.x!==n.x&&i.y!==n.y)return!1}return!0}))}},{key:"getAllMovesForPawn",value:function(t,a,n,r,c){var s=[],i=this.getCell(t,r-1,c);if(!i.figure&&(s.push(i),6===r)){var o=this.getCell(t,r-2,c);o.figure||s.push(o)}var l=[this.getCell(t,r-1,c-1),this.getCell(t,r-1,c+1)],u=l[0],m=l[1];if(u&&u.figure&&u.side===e.sides.OPPONENT&&s.push(u),m&&m.figure&&m.side===e.sides.OPPONENT&&s.push(m),!a.to)return s;var f=this.rows.indexOf(Number(a.to.y)),d=this.rows.indexOf(Number(a.from.y));if(3===f&&1===d&&3===r){var p=[this.getCell(t,r,c-1),this.getCell(t,r,c+1)],g=p[0],v=p[1];a.to.x===g.x&&s.push(this.getCell(t,r-1,c-1)),a.to.x===v.x&&s.push(this.getCell(t,r-1,c+1))}return s}},{key:"getPossibleMovesForPawn",value:function(e,t,a,n,r,c){var s=this,i=[];i.push.apply(i,Object(le.a)(this.getAllMovesForPawn(e,t,a,n,r)));var o=this.getAttackingBishopsOrQueens(e,a,n,r);if(o.length&&(o=o.filter((function(t){return s.getDiagonalCells(e,c,t).length}))).length){var l=o.map((function(e){return e.x+e.y}));return i.filter((function(e){return l.includes(e.x+e.y)}))}var u=this.getAttackingRooksOrQueens(e,a,n,r);if(u.length){u=this.filterAttackingRooksForPin(e,a,c,u);for(var m=0;m<u.length;m++){var f=u[m];if(f.y===a.y)return[];if(f.x===a.x)return i.filter((function(e){return e.x===a.x}))}}return i}},{key:"getPossibleMovesForHorse",value:function(t,a,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[this.getCell(t,n-2,r+1),this.getCell(t,n-2,r-1),this.getCell(t,n+2,r+1),this.getCell(t,n+2,r-1),this.getCell(t,n+1,r-2),this.getCell(t,n-1,r-2),this.getCell(t,n+1,r+2),this.getCell(t,n-1,r+2)];if(!c)return s.filter((function(t){return t&&(!t.figure||t.side===e.sides.OPPONENT)}));var i=this.getAttackingBishopsOrQueens(t,a,n,r);if(i.length&&(i=this.filterAttackingBishopsForPin(t,a,c,i)).length)return[];var o=this.getAttackingRooksOrQueens(t,a,n,r);return o.length&&(o=this.filterAttackingRooksForPin(t,a,c,o)).length?[]:s.filter((function(t){return t&&(!t.figure||t.side===e.sides.OPPONENT)}))}},{key:"getPossibleMovesForBishop",value:function(t,a,n,r){for(var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[],i=n,o=r;;){i++,o++;var l=this.getCell(t,i,o);if(!l)break;if(l.figure){if(l.side===e.sides.OPPONENT){s.push(l);break}break}s.push(l)}for(i=n,o=r;;){i--,o--;var u=this.getCell(t,i,o);if(!u)break;if(u.figure){if(u.side===e.sides.OPPONENT){s.push(u);break}break}s.push(u)}for(i=n,o=r;;){o++,i--;var m=this.getCell(t,i,o);if(!m)break;if(m.figure){if(m.side===e.sides.OPPONENT){s.push(m);break}break}s.push(m)}for(i=n,o=r;;){o--,i++;var f=this.getCell(t,i,o);if(!f)break;if(f.figure){if(f.side===e.sides.OPPONENT){s.push(f);break}break}s.push(f)}if(!c)return s;var d=this.getAttackingBishopsOrQueens(t,a,n,r);if(d.length&&(d=this.filterAttackingBishopsForPin(t,a,c,d)).length){var p=d[0],g=a.x+a.y;return this.getDiagonalCells(t,c,p).filter((function(t){return t.x+t.y!==g&&t.side!==e.sides.ME}))}var v=this.getAttackingRooksOrQueens(t,a,n,r);return v.length&&(v=this.filterAttackingRooksForPin(t,a,c,v)).length?[]:s}},{key:"getPossibleMovesForRook",value:function(t,a,n,r){for(var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=[],i=n,o=r;;){i++;var l=this.getCell(t,i,o);if(!l)break;if(l.figure){if(l.side===e.sides.OPPONENT){s.push(l);break}break}s.push(l)}for(i=n,o=r;;){i--;var u=this.getCell(t,i,o);if(!u)break;if(u.figure){if(u.side===e.sides.OPPONENT){s.push(u);break}break}s.push(u)}for(i=n,o=r;;){o++;var m=this.getCell(t,i,o);if(!m)break;if(m.figure){if(m.side===e.sides.OPPONENT){s.push(m);break}break}s.push(m)}for(i=n,o=r;;){o--;var f=this.getCell(t,i,o);if(!f)break;if(f.figure){if(f.side===e.sides.OPPONENT){s.push(f);break}break}s.push(f)}if(!c)return s;var d=this.getAttackingBishopsOrQueens(t,a,n,r);if(d.length&&(d=this.filterAttackingBishopsForPin(t,a,c,d)).length)return[];var p=this.getAttackingRooksOrQueens(t,a,n,r);if(p.length&&(p=this.filterAttackingRooksForPin(t,a,c,p)).length){var g=p[0],v=a.x+a.y;return this.getHorizontalCells(t,c,g).filter((function(e){return e.x+e.y!==v}))}return s}},{key:"getCastlingMoves",value:function(t,a,n,r,c,s,i){var o,l=this;o=a.color===e.colors.WHITE?1:-1;var u=[];if(!c){if(!s)2===[this.getCell(t,n,r+o),this.getCell(t,n,r+2*o)].filter((function(e){return e&&!e.figure})).filter((function(e){return e&&!l.isUnderAttack(t,e)})).length&&u.push(this.getCell(t,n,r+2*o));if(!i)3===[this.getCell(t,n,r-o),this.getCell(t,n,r-2*o),this.getCell(t,n,r-3*o)].filter((function(e){return e&&!e.figure})).filter((function(e){return e&&!l.isUnderAttack(t,e)})).length&&u.push(this.getCell(t,n,r-2*o))}return u}},{key:"getAllMovesForKing",value:function(e,t,a,n){return[this.getCell(e,a-1,n),this.getCell(e,a+1,n),this.getCell(e,a,n+1),this.getCell(e,a,n-1),this.getCell(e,a+1,n+1),this.getCell(e,a-1,n+1),this.getCell(e,a+1,n-1),this.getCell(e,a-1,n-1)].filter((function(e){return!!e}))}},{key:"getPossibleMovesForKing",value:function(t,a,n,r,c,s,i){var o,l=this,u=this.getAllMovesForKing(t,a,n,r),m=t.map((function(t){return t.map((function(t){return t.figure===e.figures.KING&&t.side===e.sides.ME?Object(ae.a)(Object(ae.a)({},t),{},{figure:null,side:null,color:null}):t}))}));return(o=u=u.filter((function(t){return(!t.figure||t.side===e.sides.OPPONENT)&&!l.isUnderAttack(m,t)}))).push.apply(o,Object(le.a)(this.getCastlingMoves(t,a,n,r,c,s,i))),u}},{key:"getLegalMovesDuringCheck",value:function(t,a,n){var r=[];if(1===n.length){var c=n[0];c.figure===e.figures.PAWN||c.figure===e.figures.HORSE?r.push(c):(r.push.apply(r,Object(le.a)(this.getDiagonalCells(t,a,c))),r.push.apply(r,Object(le.a)(this.getHorizontalCells(t,a,c))))}return r}},{key:"getPossibleMoves",value:function(t,a,n,r,c,s){var i,o,l,u,m,f,d=[],p=this.rows.indexOf(Number(n.y)),g=this.columns.indexOf(n.x),v=this.getKing(t),b=this.isUnderAttack(t,v);switch(n.figure){case e.figures.PAWN:(i=d).push.apply(i,Object(le.a)(this.getPossibleMovesForPawn(t,a,n,p,g,v)));break;case e.figures.HORSE:(o=d).push.apply(o,Object(le.a)(this.getPossibleMovesForHorse(t,n,p,g,v)));break;case e.figures.BISHOP:(l=d).push.apply(l,Object(le.a)(this.getPossibleMovesForBishop(t,n,p,g,v)));break;case e.figures.ROOK:(u=d).push.apply(u,Object(le.a)(this.getPossibleMovesForRook(t,n,p,g,v)));break;case e.figures.QUEEN:(m=d).push.apply(m,Object(le.a)(this.getPossibleMovesForQueen(t,n,p,g,v)));break;case e.figures.KING:(f=d).push.apply(f,Object(le.a)(this.getPossibleMovesForKing(t,n,p,g,r,c,s)))}if(b){var h=this.getAttackers(t,v),E=this.getLegalMovesDuringCheck(t,v,h).map((function(e){return e.x+e.y}));n.figure!==e.figures.KING&&(d=d.filter((function(e){return E.includes(e.x+e.y)})))}return d}},{key:"checkCastlingMoves",value:function(t,a,n){var r,c,s=this.columns.indexOf(a.x),i=this.rows.indexOf(Number(n.y)),o=this.columns.indexOf(n.x),l=new e(this.rows,this.columns);return a.figure===e.figures.KING&&(s-o===-2?(r=l.getCell(t,i,7),c=l.getCell(t,i,s+1)):s-o===2&&(r=l.getCell(t,i,0),c=l.getCell(t,i,o+1))),[r,c]}},{key:"checkAnPassant",value:function(t,a,n){var r=this.rows.indexOf(Number(n.y)),c=this.columns.indexOf(n.x);if(a.figure===e.figures.PAWN&&a.x!==n.x&&!n.figure)return new e(this.rows,this.columns).getCell(t,r+1,c)}},{key:"checkQueen",value:function(t,a,n){var r=this.rows.indexOf(Number(a.y)),c=this.rows.indexOf(Number(n.y));return(1===r&&0===c||6===r&&7===c)&&a.figure===e.figures.PAWN}}]),e}();Be.colors={WHITE:"WHITE",BLACK:"BLACK"},Be.figures={PAWN:"PAWN",HORSE:"HORSE",BISHOP:"BISHOP",ROOK:"ROOK",QUEEN:"QUEEN",KING:"KING"},Be.sides={OPPONENT:"OPPONENT",ME:"ME"};a(72);var He=function(e){var t=e.boardState,a=e.setBoardState,c=e.makeMove,s=e.hideMoves,i=e.rows,o=e.columns,u=e.isPlayingAsWhite,m=e.isWhiteTurn,f=e.previousMove,d=e.castingInfo,p=d.whiteKingMoved,g=d.blackKingMoved,v=d.whiteShortRookMoved,b=d.blackShortRookMoved,h=d.whiteLongRookMoved,E=d.blackLongRookMoved,O=Object(n.useState)(null),k=Object(l.a)(O,2),N=k[0],j=k[1],w=function(e){e.possibleMove?(m&&u||!m&&!u)&&c(N,e):e.figure&&e.side===Be.sides.ME?(j(e),function(e){var n=e.color===Be.colors.WHITE?p:g,r=e.color===Be.colors.WHITE?v:b,c=e.color===Be.colors.WHITE?h:E,s=new Be(i,o).getPossibleMoves(t,f,e,n,r,c).map((function(e){return e.x+e.y}));a(t.map((function(e){return e.map((function(e){return e.possibleMove=s.includes(e.x+e.y),e}))})))}(e)):(j(null),s(t))},y=!0;return r.a.createElement("div",{className:"chessboard-holder"},t.map((function(e,t){return y=!y,e.map((function(e,a){var n=new Be(i,o).getImg(e.figure+e.color),c=r.a.createElement("div",{onClick:function(){return w(e)},key:e.x+e.y,className:"chessboard-cell ".concat(y?"black":"white")},r.a.createElement("div",{className:"chess-number ".concat(0===a?"visible":"")},e.y),r.a.createElement("div",{className:"chess-letter ".concat(7===t?"visible":"")},e.x),n&&r.a.createElement("img",{className:"chess-piece-img",src:n,alt:""}),r.a.createElement("span",{className:"point ".concat(e.possibleMove?"active":"")}));return y=!y,c}))})))},We=a(44),Ke=a(43),Fe=function(e){var t=e.room,a=e.visible,c=f().user.type,s=Object(n.useState)(!1),i=Object(l.a)(s,2),o=i[0],u=i[1],m=Object(n.useState)(!1),d=Object(l.a)(m,2),p=d[0],g=d[1],v=Object(n.useState)(!1),b=Object(l.a)(v,2),h=b[0],E=b[1],O=Object(n.useState)(!1),k=Object(l.a)(O,2),N=k[0],j=k[1],w=Object(n.useState)(!1),y=Object(l.a)(w,2),C=y[0],x=y[1],P=Object(n.useState)(!1),S=Object(l.a)(P,2),A=S[0],T=S[1],M=Object(n.useState)(!0),I=Object(l.a)(M,2),R=I[0],L=I[1],B=Object(n.useState)(!0),H=Object(l.a)(B,2),W=H[0],K=H[1],F=Object(n.useState)(!1),Q=Object(l.a)(F,2),U=Q[0],_=Q[1],D=Object(n.useState)([8,7,6,5,4,3,2,1]),G=Object(l.a)(D,2),V=G[0],X=G[1],Y=Object(n.useState)(["a","b","c","d","e","f","g","h"]),z=Object(l.a)(Y,2),q=z[0],J=z[1],Z=Object(n.useState)(V.map((function(e){return q.map((function(t){return"".concat(t).concat(e)}))}))),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=Object(n.useState)([]),ce=Object(l.a)(ne,2),se=ce[0],ie=ce[1],oe=Object(n.useState)([]),ue=Object(l.a)(oe,2),me=ue[0],fe=ue[1],de=Object(n.useState)(ee.map((function(e){return e.map((function(e){return new Be(V,q).prepareCellInitialState(e,R)}))}))),pe=Object(l.a)(de,2),ge=pe[0],ve=pe[1],be=Object(n.useRef)(ge);r.a.useEffect((function(){be.current=ge}),[ge]);var he=Object(n.useRef)(se);r.a.useEffect((function(){he.current=se}),[se]);var Ee=Object(n.useRef)(me);r.a.useEffect((function(){Ee.current=me}),[me]);var Oe=Object(n.useRef)(R);r.a.useEffect((function(){Oe.current=R}),[R]),Object(n.useEffect)((function(){if(U){var e=Object(le.a)(V),t=Object(le.a)(q),a=V.reverse(),n=q.reverse(),r=ge,c=a.map((function(e){return n.map((function(t){return"".concat(t).concat(e)}))}));ve(c.map((function(a){return a.map((function(a){var n,c=a.split(""),s=Object(l.a)(c,2),i=s[0],o=s[1],u=e.indexOf(Number(o)),m=t.indexOf(i),f=new Be(V,q).getCell(r,u,m);return n=R?f.color===Be.colors.WHITE?Be.sides.ME:f.color===Be.colors.BLACK?Be.sides.OPPONENT:null:f.color===Be.colors.WHITE?Be.sides.OPPONENT:f.color===Be.colors.BLACK?Be.sides.ME:null,Object(ae.a)(Object(ae.a)({},f),{},{side:n})}))}))),X(a),J(n),te(c)}else _(!0)}),[R]);var ke=re().socket;Object(n.useEffect)((function(){ke.on("move-made",(function(e){var t=e.from,a=e.to;we(t,a)})),ke.on("sides-switched",(function(e){var t=e.isWhite;L(t)})),ke.on("new-game-started",(function(e){var t=e.isPlayingAsWhite;L(t),xe(t)})),ke.on("move-taken-back",(function(e){var t=e.previousMove;Pe(t)})),Ce()}),[]);var Ne=function(e){ve(e.map((function(e){return e.map((function(e){return e.possibleMove=!1,e}))})))},je=function(e,a){ke.emit("chess-make-move",{room:t,from:e,to:a})},we=function(e,t){var a=be.current,n=he.current,r=new Be(V,q),c=r.checkCastlingMoves(a,e,t),s=Object(l.a)(c,2),i=s[0],o=s[1],m=r.checkQueen(a,e,t);!function(e){e.figure===Be.figures.KING&&(e.color===Be.colors.WHITE?u(!0):g(!0)),e.figure===Be.figures.ROOK&&"a"===e.x&&(e.color===Be.colors.WHITE?E(!0):j(!0)),e.figure===Be.figures.ROOK&&"h"===e.x&&(e.color===Be.colors.WHITE?x(!0):T(!0))}(e);var f=r.checkAnPassant(a,e,t);ie([].concat(Object(le.a)(n),[{from:e,to:t,figure:e.figure,anPassant:f,fromTwo:i,toTwo:o,isCastle:!!i,isAnPassant:!!f}])),Ne(a),ye(e,t,i,o,f,a,m),K(e.color===Be.colors.BLACK)},ye=function(e,t,a,n,r,c,s){var i=Oe.current,o=s?Be.figures.QUEEN:e.figure,l=Be.colors.WHITE,u=Be.colors.BLACK,m=Be.sides.ME,f=Be.sides.OPPONENT;ve(c.map((function(c){return c.map((function(c){if(c.x===e.x&&c.y===e.y)return Object(ae.a)(Object(ae.a)({},c),{},{figure:null,side:null,color:null});if(c.x===t.x&&c.y===t.y){var s=e.color,d=s===l&&i||s===u&&!i?m:f;return Object(ae.a)(Object(ae.a)({},c),{},{figure:o,side:d,color:e.color})}if(a&&c.x===a.x&&c.y===a.y)return Object(ae.a)(Object(ae.a)({},c),{},{figure:null,side:null,color:null});if(n&&c.x===n.x&&c.y===n.y){var p=a.color,g=p===l&&i||p===u&&!i?m:f;return Object(ae.a)(Object(ae.a)({},c),{},{figure:a.figure,side:g,color:a.color})}return r&&c.x===r.x&&c.y===r.y?Object(ae.a)(Object(ae.a)({},c),{},{figure:null,side:null,color:null}):c}))})))},Ce=function(){ke.emit("start-new-game",{room:t,isPlayingAsWhite:R})},xe=function(e){var t,a;e?(t=[8,7,6,5,4,3,2,1],a=["a","b","c","d","e","f","g","h"]):(t=[8,7,6,5,4,3,2,1].reverse(),a=["a","b","c","d","e","f","g","h"].reverse());var n=t.map((function(e){return a.map((function(t){return"".concat(t).concat(e)}))}));ve(n.map((function(n){return n.map((function(n){return new Be(t,a).prepareCellInitialState(n,e)}))}))),K(!0)},Pe=function(e){var t=be.current,a=he.current,n=Ee.current,r=Be.colors.WHITE,c=Be.colors.BLACK,s=Be.sides.ME,i=Be.sides.OPPONENT;e.isCastle&&(e.fromTwo.color===r?u(!1):g(!1),"h"===e.fromTwo.x?e.fromTwo.color===r?E(!1):j(!1):e.fromTwo.color===r?x(!1):T(!1)),ve(t.map((function(t){return t.map((function(t){if(t.x===e.from.x&&t.y===e.from.y){var a=e.from.color,n=a===r&&R||a===c&&!R?s:i;return n=a?n:null,Object(ae.a)(Object(ae.a)({},t),{},{figure:e.from.figure,side:n,color:e.from.color})}if(t.x===e.to.x&&t.y===e.to.y){var o=e.to.color,l=o===r&&R||o===c&&!R?s:i;return l=o?l:null,Object(ae.a)(Object(ae.a)({},t),{},{figure:e.to.figure,side:l,color:e.to.color})}if(e.isCastle&&t.x===e.fromTwo.x&&t.y===e.fromTwo.y){var u=e.fromTwo.color,m=u===r&&R||u===c&&!R?s:i;return m=u?m:null,Object(ae.a)(Object(ae.a)({},t),{},{figure:e.fromTwo.figure,side:m,color:e.fromTwo.color})}if(e.isCastle&&t.x===e.toTwo.x&&t.y===e.toTwo.y){var f=e.toTwo.color,d=f===r&&R||f===c&&!R?s:i;return d=f?d:null,Object(ae.a)(Object(ae.a)({},t),{},{figure:e.toTwo.figure,side:d,color:e.toTwo.color})}if(e.isAnPassant&&t.x===e.anPassant.x&&t.y===e.anPassant.y){var p=e.anPassant.color,g=p===r&&R||p===c&&!R?s:i;return g=p?g:null,Object(ae.a)(Object(ae.a)({},t),{},{figure:e.anPassant.figure,side:g,color:e.anPassant.color})}return t}))}))),K(e.from.color===Be.colors.WHITE),ie(a.slice(0,-1)),fe([].concat(Object(le.a)(n),[e]))};return r.a.createElement("div",{className:"chess-slide ".concat(a?"":"hidden")},c&&r.a.createElement("div",{className:"chess-buttons"},r.a.createElement("div",{className:"chess-button",title:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430",onClick:function(){return Ce()}},r.a.createElement(We.a,{icon:Ke.a})),r.a.createElement("div",{className:"chess-button",title:"\u041f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u0441\u0442\u043e\u0440\u043e\u043d\u044b",onClick:function(){ke.emit("switch-sides",{room:t,isPlayingAsWhite:!R})}},r.a.createElement(We.a,{icon:Ke.c})),r.a.createElement("div",{className:"chess-button",title:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0445\u043e\u0434",onClick:function(){return function(){if(0!==se.length){var e=se[se.length-1];ke.emit("take-move-back",{room:t,previousMove:e,state:ge,previousMoves:se,takenBackMoves:me})}}()}},r.a.createElement(We.a,{icon:Ke.b})),r.a.createElement("div",{className:"chess-button",title:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043d\u044b\u0439 \u0445\u043e\u0434",onClick:function(){return function(){if(0!==me.length){var e=new Be(V,q),t=me[me.length-1],a=q.indexOf(t.from.x),n=V.indexOf(Number(t.from.y)),r=q.indexOf(t.to.x),c=V.indexOf(Number(t.to.y)),s=e.getCell(ge,n,a),i=e.getCell(ge,c,r);je(s,i),fe(me.slice(0,-1))}}()}},r.a.createElement(We.a,{icon:Ke.d}))),r.a.createElement(He,{boardState:ge,setBoardState:ve,makeMove:je,hideMoves:Ne,rows:V,columns:q,isPlayingAsWhite:R,isWhiteTurn:W,previousMove:se.length>0?se[se.length-1]:{},castingInfo:{whiteKingMoved:o,blackKingMoved:p,whiteShortRookMoved:h,blackShortRookMoved:N,whiteLongRookMoved:C,blackLongRookMoved:A}}))},Qe=function(e){var t=e.room,a=e.img,c=e.hasChessboard,s=e.hasAbacus,i=e.activeTool,o=e.drawWidth,u=e.drawColor,m=e.active,d=re().socket,p=f().getUser,g=Object(n.useState)("100px"),v=Object(l.a)(g,2),b=v[0],h=v[1],E=Object(n.useState)("100px"),O=Object(l.a)(E,2),k=O[0],N=O[1],j=r.a.createRef();return r.a.createElement("div",{className:"canvas-background",ref:j},r.a.createElement("div",{className:"canvas-border ".concat(a?"":"hidden")},r.a.createElement("img",{className:"slide-img",src:a,alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0434\u043b\u044f \u0441\u043b\u0430\u0439\u0434\u0430 \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u043b\u0430\u0441\u044c",onLoad:function(e){var t=e.target,a=j.current.offsetHeight,n=j.current.offsetWidth,r=window.innerWidth>1300?"4em":".3em",c=n/a,s=t.width/t.height,i=1;t.height>a||t.width>n?c>=s?(i=t.height/t.width,N("calc(".concat(a,"px - ").concat(r,")")),h("calc((".concat(a,"px - ").concat(r,") / ").concat(i,")"))):(i=t.width/t.height,h("calc(".concat(n,"px - ").concat(r,")")),N("calc((".concat(n,"px - ").concat(r,") / ").concat(i,")"))):(h(t.width),N(t.height));var o=p();d.emit("image-loaded",{login:o.login})}}),r.a.createElement("div",{id:"mainCanvas",className:"canvas",style:{backgroundImage:a?"url(".concat(a,")"):"none",width:b,height:k}},r.a.createElement(oe,{visible:s,room:t}),r.a.createElement(Fe,{visible:c,room:t}),r.a.createElement(Y.a,{sketch:te,socket:d,room:t,width:parseInt(b),height:parseInt(k),active:m,activeTool:i,drawWidth:o,drawColor:u}))))},Ue=(a(170),function(e){var t=e.labelOne,a=e.labelTwo,n=e.onChange,c=e.valueOne,s=e.valueTwo,i=function(e){n(e?s:c)};return r.a.createElement("div",{className:"switch"},""!==t?r.a.createElement("div",{className:"label"},t):"",r.a.createElement("label",{className:"toggle-control"},r.a.createElement("input",{type:"checkbox",onChange:function(e){return i(e.target.checked)}}),r.a.createElement("span",{className:"control"})),""!==a?r.a.createElement("div",{className:"label"},a):"")}),_e=(a(171),function(e){var t=e.defaultValue,a=e.values,c=e.valueField,s=e.onChangeComplete,i=a.find((function(e){return e[c]===t})),o=Object(n.useState)(i),u=Object(l.a)(o,2),m=u[0],f=u[1];return r.a.createElement("div",{className:"inline-picker-wrapper"},r.a.createElement("div",{className:"p-item-picker-wrapper"},a.map((function(e){return r.a.createElement("div",{onClick:function(){s(e[c]),f(e)},className:"p-item-wrapper ".concat(m.value===e.value?"active":""),key:e[c]},r.a.createElement("span",{className:"p-item size".concat(e[c])}))}))))}),De=(a(172),function(e){var t=e.color,a=e.onChangeComplete,c=Object(n.useState)(t),s=Object(l.a)(c,2),i=s[0],o=s[1];return r.a.createElement("div",{className:"inline-color-picker-wrapper"},r.a.createElement("div",{className:"p-item-picker-wrapper"},["red","blue","yellow","green"].map((function(e){return r.a.createElement("div",{onClick:function(){a(e),o(e)},className:"p-item-wrapper ".concat(i===e?"active":""),key:e},r.a.createElement("span",{className:"p-item ".concat(e)}))}))))}),Ge=function(e){var t=e.activeTool,a=e.setActiveTool,c=e.defWidth,s=e.setDrawWidth,i=e.defColor,o=e.setDrawColor,u=re().socket,m=f().user,d=m.type,p=m.login,g="teacher"===d,v=Object(n.useState)(!1),b=Object(l.a)(v,2),h=b[0],E=b[1],O=Object(n.useState)(0),k=Object(l.a)(O,2),N=k[0],j=k[1],w=Object(n.useState)(0),C=Object(l.a)(w,2),x=C[0],P=C[1];return function(e,t){var a=Object(n.useRef)(e);Object(n.useEffect)((function(){a.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t){var e=setInterval((function(){return a.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){x<59?P(x+1):(P(0),j(N+1))}),h?1e3:null),r.a.createElement("div",{className:"tool-panel"},r.a.createElement(_e,{defaultValue:c,valueField:"value",labelField:"label",values:[{label:"2px",value:2},{label:"5px",value:5},{label:"8px",value:8}],onChangeComplete:function(e){s(e)}}),r.a.createElement("div",{className:"tool-panel-divider"}),r.a.createElement(De,{color:i,onChangeComplete:function(e){o(e)}}),r.a.createElement("div",{className:"tool-panel-divider"}),r.a.createElement("div",{className:"tools-buttons"},r.a.createElement("div",{className:"tool-btn salad ".concat(t===J?"active":""),onClick:function(){a(J)}},r.a.createElement(y.f,null)),r.a.createElement("div",{className:"tool-btn salad ".concat(t===Z?"active":""),onClick:function(){a(Z)}},r.a.createElement(y.c,null)),g&&r.a.createElement("div",{className:"tool-btn salad ".concat(t===$?"active":""),onClick:function(){a($)}},r.a.createElement(y.e,null)),g&&r.a.createElement("div",{className:"tool-btn green",onClick:function(){E(!h)}},r.a.createElement(y.b,null)),g&&r.a.createElement("div",{className:"time-holder"},r.a.createElement("span",{className:"minute"},N<10?"0"+N:N),r.a.createElement("span",{className:"colon"},":"),r.a.createElement("span",{className:"seconds"},x<10?"0"+x:x)),g&&r.a.createElement("div",{className:"tool-btn red",onClick:function(){P(0),j(0),E(!1)}},r.a.createElement(y.d,null)),g&&r.a.createElement(Ue,{labelOne:"",labelTwo:"",valueOne:!0,valueTwo:!1,onChange:function(e){return t=e,void u.emit("set-drawing-enabled",{login:p,isEnabled:t});var t}}),g&&r.a.createElement("div",{className:"tool-btn salad",onClick:function(){u.emit("reset-canvas",{teacherLogin:p})}},r.a.createElement(y.j,null))))},Ve=Object(n.createContext)(""),Xe=Object(n.createContext)(""),Ye=(a(173),function(e){var t=e.room,a=e.sidebarOpen,c=f().user.type,s=Object(n.useContext)(Ve).slide,i=Object(n.useContext)(Xe),o=i.slide,u=i.allowedToDraw,m="teacher"===c?s:o,d=m.img,p=m.tip,g=m.hasChessboard,v=m.hasAbacus,b="teacher"===c||u,h=Object(n.useState)(2),E=Object(l.a)(h,2),O=E[0],k=E[1],N=Object(n.useState)("red"),j=Object(l.a)(N,2),w=j[0],y=j[1],C=Object(n.useState)(ee),x=Object(l.a)(C,2),P=x[0],S=x[1];return r.a.createElement("div",{className:"canvas-area"},r.a.createElement(V,{tip:p}),r.a.createElement(Qe,{room:t,img:d,hasChessboard:g,hasAbacus:v,active:a&&b,activeTool:P,drawWidth:O,drawColor:w}),r.a.createElement(Ge,{activeTool:P,setActiveTool:S,defWidth:O,setDrawWidth:k,defColor:w,setDrawColor:y}))}),ze=(a(174),function(e){var t=e.setAllowedStudent,a=e.student,n=e.allowedStudent;return r.a.createElement("div",{className:"item-wrapper"},r.a.createElement("div",{className:"item ".concat(a.login===n?"current":"")},r.a.createElement("div",{className:"name"},a.name),r.a.createElement("div",{className:"button",onClick:function(){return t(a.login)}},"\u0414\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c")))}),qe=function(e){var t=e.open,a=e.setOpen,n=e.students,c=e.setAllowedStudent,s=e.allowedStudent;return r.a.createElement("div",{className:"item-picker student-picker ".concat(t?"open":"")},r.a.createElement("div",{className:"picker-area"},r.a.createElement("div",{className:"picker-menu-bg",onClick:function(){return a(!1)}}),r.a.createElement("div",{className:"picker-items students"},n.map((function(e){return r.a.createElement(ze,{key:e._id,setAllowedStudent:c,student:e,allowedStudent:s})})))))},Je=function(e){var t=e.setLevel,a=e.level;return r.a.createElement("div",{className:"item-wrapper",onClick:t},r.a.createElement("div",{className:"item"},a.name))},Ze=function(e){var t=e.open,a=e.setOpen,n=e.levels,c=e.setLevel;return r.a.createElement("div",{className:"item-picker level-picker ".concat(t?"open":"")},r.a.createElement("div",{className:"picker-area"},r.a.createElement("div",{className:"picker-menu-bg",onClick:function(){return a(!1)}}),r.a.createElement("div",{className:"picker-items levels"},n.map((function(e){return r.a.createElement(Je,{key:e._id,setLevel:function(){return c(e)},level:e})})))))},$e=function(e){var t=e.setLesson,a=e.lesson;return r.a.createElement("div",{className:"item-wrapper",onClick:t},r.a.createElement("div",{className:"item"},a.name))},et=function(e){var t=e.open,a=e.setOpen,n=e.lessons,c=e.setLesson;return r.a.createElement("div",{className:"item-picker lesson-picker ".concat(t?"open":"")},r.a.createElement("div",{className:"picker-area"},r.a.createElement("div",{className:"picker-menu-bg",onClick:function(){return a(!1)}}),r.a.createElement("div",{className:"picker-items levels"},n&&n.map((function(e){return r.a.createElement($e,{key:e._id,setLesson:function(){return c(e)},lesson:e})})))))},tt=function(e){var t=e.setSlide,a=e.slide;return r.a.createElement("div",{className:"item-wrapper slide ".concat(a.img?"":"empty"),onClick:t},r.a.createElement("div",{className:"img-wrapper"},a.img?r.a.createElement("img",{src:a.img,alt:"\u0421\u043b\u0430\u0439\u0434"}):r.a.createElement("div",{className:"content"},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0434\u043b\u044f \u043f\u0435\u0434\u0430\u0433\u043e\u0433\u0430")))},at=function(e){var t=e.open,a=e.setOpen,n=e.slides,c=e.setSlide;return r.a.createElement("div",{className:"item-picker slide-picker ".concat(t?"open":"")},r.a.createElement("div",{className:"picker-area"},r.a.createElement("div",{className:"picker-menu-bg slides",onClick:function(){return a(!1)}}),r.a.createElement("div",{className:"picker-items slides"},n&&n.map((function(e){return r.a.createElement(tt,{key:e._id,setSlide:function(){return c(e)},slide:e})})))))},nt=(a(175),function(e){var t=e.logout,a=Object(m.h)().teacher,c=re().socket,s=f().user,i=Object(n.useContext)(Ve).allowedStudent,o=Object(n.useContext)(Xe),u=o.waitingScreen,d=o.waitingScreenMessage,v=Object(n.useState)({}),b=Object(l.a)(v,2),h=b[0],E=b[1],O=Object(n.useState)({}),N=Object(l.a)(O,2),j=N[0],w=N[1],y=Object(n.useState)([]),C=Object(l.a)(y,2),x=C[0],P=C[1],S=Object(n.useState)([]),A=Object(l.a)(S,2),T=A[0],M=A[1],I=Object(n.useState)([]),R=Object(l.a)(I,2),L=R[0],B=R[1],H=Object(n.useState)([]),F=Object(l.a)(H,2),Q=F[0],U=F[1],_=Object(n.useState)(!1),D=Object(l.a)(_,2),V=D[0],X=D[1],Y=Object(n.useState)(!1),z=Object(l.a)(Y,2),q=z[0],J=z[1],Z=Object(n.useState)(!1),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),ne=Object(l.a)(ae,2),ce=ne[0],se=ne[1];Object(n.useEffect)((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("teacher"!==s.type){e.next=5;break}return e.next=3,k.post("/teacher/get-students",{teacherLogin:s.login});case 3:t=e.sent,P(t.data.students);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e)}))}),[s]),Object(n.useEffect)((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("teacher"!==s.type){e.next=5;break}return e.next=3,k.post("/level/get-levels",{login:s.login});case 3:t=e.sent,M(t.data.levels);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e)}))}),[s]),Object(n.useEffect)((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("teacher"!==s.type||!j._id){e.next=5;break}return e.next=3,k.post("/level/get-lessons",{level:j._id});case 3:t=e.sent,B(t.data.lessons);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e)}))}),[j]),Object(n.useEffect)((function(){(function(){var e=Object(g.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("teacher"!==s.type||!h._id){e.next=5;break}return e.next=3,k.post("/level/get-slides",{lesson:h._id});case 3:t=e.sent,U(t.data.slides);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch((function(e){return console.error(e)}))}),[h]),Object(n.useEffect)((function(){"teacher"===s.type?c.emit("join-teacher",{room:a,login:s.login}):"student"===s.type&&c.emit("join-student",{room:a,login:s.login})}),[s,c,a]);return r.a.createElement("div",{className:"class-room"},r.a.createElement(K,{message:d,active:u}),r.a.createElement(W,{logout:t}),r.a.createElement("div",{className:"waiting-screen-class-room-wrapper"},r.a.createElement("section",{className:"class-room-wrapper"},r.a.createElement(G,{room:a}),r.a.createElement(Ye,{room:a,sidebarOpen:!q&&!ee&&!ce}),"teacher"===s.type?r.a.createElement(at,{open:V,setOpen:X,slides:Q,setSlide:function(e){c.emit("canvas-change-slide",{teacherLogin:a,slide:e})}}):"","teacher"===s.type?r.a.createElement("div",{className:"pickers"},r.a.createElement(et,{open:q,setOpen:J,lessons:L,setLesson:function(e){E(e),J(!1),X(!0)}}),r.a.createElement(Ze,{open:ee,setOpen:te,levels:T,setLevel:function(e){w(e),te(!1),J(!0)}}),r.a.createElement(qe,{open:ce,setOpen:se,students:x,setAllowedStudent:function(e){c.emit("student-allow",{teacherLogin:a,studentLogin:e})},allowedStudent:i}),r.a.createElement("div",{className:"menus-buttons"},!ce&&r.a.createElement("div",{className:"button-holder levels"},r.a.createElement("div",{className:"button",onClick:function(){return te(!ee)}},"\u0423\u0440\u043e\u0432\u043d\u0438")),!q&&r.a.createElement("div",{className:"button-holder students"},r.a.createElement("div",{className:"button",onClick:function(){return se(!ce)}},"\u0423\u0447\u0435\u043d\u0438\u043a\u0438")))):"")))}),rt=function(){var e=Object(i.d)(),t=Object(m.h)(),a=t.user,c=t.type,s=Object(n.useState)(),o=Object(l.a)(s,2),u=o[0],f=o[1],d=Object(n.useState)(),v=Object(l.a)(d,2),b=v[0],h=v[1],E=Object(n.useState)(),O=Object(l.a)(E,2),N=O[0],j=O[1],w=function(){var t=Object(g.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b===N){t.next=2;break}return t.abrupt("return",e.show("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"));case 2:return t.prev=2,t.next=5,k.post("/".concat(c,"/set-password"),{login:a,oldPassword:u,password:b});case 5:e.show("\u041f\u0430\u0440\u043e\u043b\u044c \u0441\u043c\u0435\u043d\u0435\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),t.t0.response.data.errors.forEach((function(t){e.show(t.msg)}));case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"menu-bg",id:"resetPassForm"},r.a.createElement("div",{className:"menu-wrapper"},r.a.createElement("form",{className:"form",onSubmit:function(e){return w(e)}},r.a.createElement("div",{className:"login-header"},r.a.createElement("p",null,r.a.createElement("span",{className:"golden-compass"},r.a.createElement("span",{className:"g-letter"},"\u0421")),"\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"inputs-wrapper"},r.a.createElement("div",{className:"form-group field"},r.a.createElement("input",{type:"password",className:"form-field",placeholder:"\u0412\u0430\u0448 \u0441\u0442\u0430\u0440\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",name:"oldPassword",id:"oldPassword",onChange:function(e){return f(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"oldPassword",className:"form-label"},"\u0412\u0430\u0448 \u0441\u0442\u0430\u0440\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"form-group field"},r.a.createElement("input",{type:"password",className:"form-field",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",name:"password",id:"password",onChange:function(e){return h(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"password",className:"form-label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"form-group field"},r.a.createElement("input",{type:"password",className:"form-field",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e",name:"passwordConfirm",id:"passwordConfirm",onChange:function(e){return j(e.target.value)},required:!0}),r.a.createElement("label",{htmlFor:"passwordConfirm",className:"form-label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e")),r.a.createElement("div",{className:"submit-btn-wrapper"},r.a.createElement("button",{type:"submit",className:"btn",id:"loginBtn"},r.a.createElement("span",null,"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"))))),r.a.createElement(C,null)))},ct=a(95),st=(a(176),a(177),function(){console.log(".");var e=f(),t=e.user,a=e.getUser,c=Object(n.useState)({user:t,isAuthenticated:Boolean(t&&t.token),isLoading:!1}),s=Object(l.a)(c,2),i=s[0],o=s[1],d=function(){o({user:void 0,isAuthenticated:!1,isLoading:!1})};return window.addEventListener("error",(function(e){var t=a(),n=e.error.message||e.message||e.error,r=e.error.stack||"";k.post("/errors",{error:n,componentStack:r,user:t}).catch(console.error)})),r.a.createElement(ct.ErrorBoundary,{FallbackComponent:A,onError:function(e,t){var n=a(),r=e,c=t.componentStack||t;k.post("/errors",{error:r,componentStack:c,user:n}).catch(console.error)}},r.a.createElement("section",{className:"container"},r.a.createElement(u.a,null,r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"".concat(".","/login"),render:function(e){return r.a.createElement(j,Object.assign({},e,{setAuth:o}))}}),i.user&&"teacher"===i.user.type&&r.a.createElement(L,{exact:!0,path:"".concat(".","/teacher"),component:x,auth:{isAuthenticated:i.isAuthenticated,isLoading:i.isLoading},logout:d}),i.user&&"student"===i.user.type&&r.a.createElement(L,{exact:!0,path:"".concat(".","/student"),component:T,auth:{isAuthenticated:i.isAuthenticated,isLoading:i.isLoading},logout:d}),i.user&&"student"===i.user.type&&r.a.createElement(L,{exact:!0,path:"".concat(".","/teachers-list"),component:S,auth:{isAuthenticated:i.isAuthenticated,isLoading:i.isLoading}}),r.a.createElement(L,{exact:!0,path:"".concat(".","/canvas/:teacher"),component:nt,auth:i,user:i.user,logout:d}),r.a.createElement(L,{exact:!0,path:"".concat(".","/reset-password/:user/:type"),component:rt,auth:i,user:i.user,logout:d}),r.a.createElement(m.b,{path:"*",render:function(){return i.isAuthenticated?"student"===i.user.type?r.a.createElement(m.a,{to:"".concat(".","/student")}):"teacher"===i.user.type?r.a.createElement(m.a,{to:"".concat(".","/teacher")}):r.a.createElement(m.a,{to:"".concat(".","/login")}):r.a.createElement(m.a,{to:"".concat(".","/login")})}})))))}),it=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce((function(e,t){return function(a){var n=a.children;return r.a.createElement(e,null,r.a.createElement(t,null,n))}}),(function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,t)}))}.apply(void 0,[function(e){var t=e.children,a=f().getUser,c=Object(n.useRef)(),s=Object(n.useRef)(),i=Object(n.useRef)({}),o=Object(n.useState)({}),u=Object(l.a)(o,2),m=u[0],d=u[1],p=Object(n.useState)(),g=Object(l.a)(p,2),v=g[0],b=g[1],h=Object(n.useState)(),E=Object(l.a)(h,2),O=E[0],k=E[1],N=Object(n.useState)(!1),j=Object(l.a)(N,2),w=j[0],y=j[1],C=Object(n.useState)(!1),x=Object(l.a)(C,2),P=x[0],S=x[1],A=Object(n.useState)(!1),T=Object(l.a)(A,2),M=T[0],I=T[1],R=Object(n.useState)(!0),L=Object(l.a)(R,2),B=L[0],H=L[1],W=Object(n.useState)(!0),K=Object(l.a)(W,2),F=K[0],U=K[1];Object(n.useEffect)((function(){if(w){var e=a();m.getVideoTracks().forEach((function(e){return e.enabled=B})),m.getAudioTracks().forEach((function(e){return e.enabled=F})),("student"===e.type||"teacher"===e.type)&&(i.current=new Q.a({initiator:!1,trickle:!1,stream:m,config:{iceServers:[{urls:"stun:stun.golden-compass-app.com:3478"},{urls:["turn:turn.golden-compass-app.com:3478?transport=udp","turn:turn.golden-compass-app.com:3478?transport=tcp","turn:turn.golden-compass-app.com:443?transport=tcp"],username:"tiredman",credential:"pleasework"}]}}),i.current.on("signal",(function(e){i.current.signal(e)})),i.current.on("stream",(function(e){s.current&&(s.current.srcObject=e)})))}}),[B,F]);var G=function(){I(!1),y(!1),S(!1),i.current.destroy(),window.location.reload()};return r.a.createElement(D.Provider,{value:{setup:function(){var e=a();_.emit("add-to-video",{login:e.login}),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){d(e.clone()),c.current&&(c.current.srcObject=e)})),_.on("student-calling",(function(e){var t=e.studentLogin,a=e.signal;I(!0),k(t),b(a)})),_.on("caller-ended-call",(function(){G()}))},caller:O,callAccepted:w,calling:P,receivingCall:M,myVideo:c,userVideo:s,callTeacher:function(e){var t=a();m.getVideoTracks().forEach((function(e){return e.enabled=B})),m.getAudioTracks().forEach((function(e){return e.enabled=F})),S(!0),i.current.destroy&&i.current.destroy();var n=new Q.a({initiator:!0,trickle:!1,config:{iceServers:[{urls:"stun:stun.golden-compass-app.com:3478"},{urls:["turn:turn.golden-compass-app.com:3478?transport=udp","turn:turn.golden-compass-app.com:3478?transport=tcp","turn:turn.golden-compass-app.com:443?transport=tcp"],username:"tiredman",credential:"pleasework"}]},stream:m});n.on("signal",(function(a){_.emit("call-teacher",{teacherLogin:e,studentLogin:t.login,signalData:a})})),n.on("stream",(function(e){s.current&&(s.current.srcObject=e)})),_.on("teacher-accepted-call",(function(e){var t=e.teacherLogin,a=e.signal;k(t),S(!1),y(!0),i.current.signal(a)})),n.on("error",(function(e){console.error(e)})),n.on("close",(function(){return G()})),i.current=n},answerCall:function(e){var t=a();m.getVideoTracks().forEach((function(e){return e.enabled=B})),m.getAudioTracks().forEach((function(e){return e.enabled=F}));var n=new Q.a({initiator:!1,trickle:!1,stream:m,config:{iceServers:[{urls:"stun:stun.golden-compass-app.com:3478"},{urls:["turn:turn.golden-compass-app.com:3478?transport=udp","turn:turn.golden-compass-app.com:3478?transport=tcp","turn:turn.golden-compass-app.com:443?transport=tcp"],username:"tiredman",credential:"pleasework"}]}});n.on("signal",(function(a){y(!0),I(!1),_.emit("call-accepted",{teacherLogin:t.login,studentLogin:e,signal:a})})),n.on("stream",(function(e){s.current&&(s.current.srcObject=e)})),n.on("close",(function(){return G()})),n.signal(v),i.current=n},leaveCall:function(){_.emit("call-ended",{caller:O}),G()},captureVideo:B,captureAudio:F,setCaptureVideo:H,setCaptureAudio:U}},t)},function(e){var t=e.children,a=Object(i.d)(),c=re().socket,s=Object(n.useState)(!1),o=Object(l.a)(s,2),u=o[0],m=o[1],f=Object(n.useState)(""),d=Object(l.a)(f,2),p=d[0],g=d[1],v=Object(n.useState)(),b=Object(l.a)(v,2),h=b[0],E=b[1],O=Object(n.useState)({}),k=Object(l.a)(O,2),N=k[0],j=k[1];return Object(n.useEffect)((function(){c.on("student-requests-entrance",(function(e){var t=e.name;a.show("\u0423\u0447\u0435\u043d\u0438\u043a ".concat(t," \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u0445\u043e\u0434 \u0432 \u043a\u043b\u0430\u0441\u043d\u0443\u044e \u043a\u043e\u043c\u043d\u0430\u0442\u0443"),"primary")})),c.on("allowed-student-set",(function(e){var t=e.login;E(t)})),c.on("canvas-slide-picked",(function(e){var t=e.slide;j(t)})),c.on("teacher-joined",(function(){m(!1),g("")}))}),[a,c]),r.a.createElement(Ve.Provider,{value:{waitingScreen:u,waitingScreenMessage:p,slide:N,allowedStudent:h}},t)},function(e){var t=e.children,a=re().socket,c=f().getUser,s=Object(n.useState)(!1),i=Object(l.a)(s,2),o=i[0],u=i[1],m=Object(n.useState)(""),d=Object(l.a)(m,2),p=d[0],g=d[1],v=Object(n.useState)({}),b=Object(l.a)(v,2),h=b[0],E=b[1],O=Object(n.useState)(!0),k=Object(l.a)(O,2),N=k[0],j=k[1];return Object(n.useEffect)((function(){a.on("student-disallowed",(function(e){var t=e.name;u(!0),g("\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0432\u0445\u043e\u0434 \u0432 \u043a\u043b\u0430\u0441\u0441\u043d\u0443\u044e \u043a\u043e\u043c\u043d\u0430\u0442\u0443 \u0443\u0447\u0438\u0442\u0435\u043b\u044e ".concat(t))})),a.on("student-allowed",(function(e){var t=e.teacher,n=c();a.emit("join-student",{room:t,login:n.login})})),a.on("teacher-absent",(function(e){var t=e.name;u(!0),g("\u0423\u0447\u0438\u0442\u0435\u043b\u044c ".concat(t," \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043d\u0430 \u0440\u0430\u0431\u043e\u0447\u0435\u043c \u043c\u0435\u0441\u0442\u0435"))})),a.on("teacher-present",(function(e){var t=e.login,n=c();u(!1),g(""),a.emit("join-student",{room:t,login:n.login})})),a.on("student-joined",(function(){u(!1),g("")})),a.on("canvas-slide-changed",(function(e){var t=e.slide;E(t)})),a.on("drawing-enabled-set",(function(e){var t=e.isEnabled;j(t)}))}),[]),r.a.createElement(Xe.Provider,{value:{waitingScreen:o,waitingScreenMessage:p,slide:h,allowedToDraw:N}},t)}]),ot=(a(178),{position:i.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:i.c.SCALE});s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,Object.assign({template:o.a},ot),r.a.createElement(it,null,r.a.createElement(st,null)))),document.getElementById("root"))},37:function(e){e.exports=JSON.parse('{"a":"https://young-everglades-58883.herokuapp.com/"}')},71:function(e,t,a){},72:function(e,t,a){},77:function(e,t,a){e.exports=a.p+"static/media/logo.7352a14e.png"},82:function(e,t,a){e.exports=a.p+"static/media/cursor.7fd2b441.png"},83:function(e,t,a){e.exports=a.p+"static/media/blackPawn.1315ca02.png"},84:function(e,t,a){e.exports=a.p+"static/media/blackBishop.eaf3b510.png"},85:function(e,t,a){e.exports=a.p+"static/media/blackHorse.fecb1acf.png"},86:function(e,t,a){e.exports=a.p+"static/media/blackRook.d4a99eb8.png"},87:function(e,t,a){e.exports=a.p+"static/media/blackQueen.eb705e84.png"},88:function(e,t,a){e.exports=a.p+"static/media/blackKing.90fe0414.png"},89:function(e,t,a){e.exports=a.p+"static/media/whitePawn.1926aeb5.png"},90:function(e,t,a){e.exports=a.p+"static/media/whiteBishop.4e79228b.png"},91:function(e,t,a){e.exports=a.p+"static/media/whiteHorse.9621487d.png"},92:function(e,t,a){e.exports=a.p+"static/media/whiteRook.29917334.png"},93:function(e,t,a){e.exports=a.p+"static/media/whiteQueen.ece13601.png"},94:function(e,t,a){e.exports=a.p+"static/media/whiteKing.c8f01d9c.png"},97:function(e,t,a){e.exports=a(179)}},[[97,1,2]]]);
//# sourceMappingURL=main.883effff.chunk.js.map