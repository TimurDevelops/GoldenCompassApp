{"version":3,"sources":["hooks/useUser.js","components/ui/Checkbox.js","utils/api.js","components/login/Login.js","components/ui/MenuItem.js","components/ui/GoBack.js","components/teacherMenu/TeacherMenu.js","components/teachersList/TeacherItem.js","components/teachersList/TeachersList.js","components/ui/ErrorFallback.js","components/studentMenu/StudentMenu.js","components/ui/Spinner.js","components/ui/PrivateRoute.js","components/ui/Header.js","components/ui/WaitingScreen.js","context/VideoContext.js","components/classRoom/videoArea/VideoArea.js","components/classRoom/canvasArea/canvasAreaLayout/TipArea.js","utils/types.js","components/classRoom/canvasArea/canvasAreaLayout/Sketch.js","hooks/useSocket.js","components/classRoom/canvasArea/canvasAreaLayout/Abacus/Abacus.js","components/classRoom/canvasArea/canvasAreaLayout/Abacus/AbacusSlide.js","components/classRoom/canvasArea/canvasAreaLayout/Chessboard/ChessLogic.js","components/classRoom/canvasArea/canvasAreaLayout/Chessboard/Chessboard.js","components/classRoom/canvasArea/canvasAreaLayout/Chessboard/ChessboardSlide.js","components/classRoom/canvasArea/canvasAreaLayout/Canvas.js","components/ui/Switch.js","components/ui/InlinePicker.js","components/ui/InlineColorPicker.js","components/classRoom/canvasArea/canvasAreaLayout/ToolPanel.js","utils/interval.js","context/TeacherContext.js","context/StudentContext.js","components/classRoom/canvasArea/CanvasArea.js","components/classRoom/pickersArea/studentPicker/StudentItem.js","components/classRoom/pickersArea/studentPicker/StudentPicker.js","components/classRoom/pickersArea/levelPicker/LevelItem.js","components/classRoom/pickersArea/levelPicker/LevelPicker.js","components/classRoom/pickersArea/lessonPicker/LessonItem.js","components/classRoom/pickersArea/lessonPicker/LessonPicker.js","components/classRoom/pickersArea/slidePicker/SlideItem.js","components/classRoom/pickersArea/slidePicker/SlidePicker.js","components/classRoom/ClassRoom.js","components/resetPassword/ResetPassword.js","App.js","context/AppContextProvider.js","utils/combineComponents.js","index.js","img/logo.png","img/cursor.png","img/chessPieces/blackPawn.png","img/chessPieces/blackBishop.png","img/chessPieces/blackHorse.png","img/chessPieces/blackRook.png","img/chessPieces/blackQueen.png","img/chessPieces/blackKing.png","img/chessPieces/whitePawn.png","img/chessPieces/whiteBishop.png","img/chessPieces/whiteHorse.png","img/chessPieces/whiteRook.png","img/chessPieces/whiteQueen.png","img/chessPieces/whiteKing.png"],"names":["useUser","getUser","userString","sessionStorage","getItem","user","JSON","parse","undefined","useState","setUser","setItem","stringify","unsetUser","removeItem","Checkbox","label","name","value","onChange","checked","className","type","id","defaultChecked","onClick","e","currentTarget","htmlFor","api","axios","create","baseURL","serverUrl","headers","interceptors","response","use","res","err","status","Promise","reject","loginUser","a","credentials","post","data","errors","Login","setAuth","history","useHistory","alert","useAlert","login","setLogin","password","setPassword","setType","handleSubmit","preventDefault","isAuthenticated","isLoading","push","console","log","forEach","show","msg","onSubmit","placeholder","target","required","MenuItem","link","to","GoBack","goBack","TeacherMenu","logout","TeacherItem","teacher","TeachersList","teachers","setTeachers","useEffect","studentLogin","getTeachers","catch","error","length","map","key","_id","ErrorFallback","StudentMenu","Spinner","viewBox","cx","cy","r","PrivateRoute","Component","component","auth","rest","render","props","Header","src","logo","alt","WaitingScreen","message","active","socket","io","VideoContext","createContext","VideoArea","room","useContext","setup","caller","callAccepted","calling","receivingCall","myVideo","userVideo","callTeacher","answerCall","leaveCall","ref","muted","autoPlay","TipArea","tip","usertype","TOOLS","sketch","p","canvas","drawingCanvas","cursorCanvas","cursorImg","sketchWidth","sketchHeight","activeTool","drawWidth","drawColor","loadImage","image","container","document","getElementById","offsetWidth","offsetHeight","canvases","getElementsByTagName","i","parentElement","removeChild","createCanvas","createGraphics","parent","draw","clear","noCursor","x","mouseX","y","mouseY","emit","cursor","eraserCursor","mouseDragged","pMouseX","pmouseX","pMouseY","pmouseY","size","color","mouseClicked","fill","circle","myCustomRedrawAccordingToNewPropsHandler","newProps","on","c","stroke","strokeWeight","line","pencilDraw","erase","noErase","eraser","width","height","transports","upgrade","useSocket","bottomRowInitial","current","number","beads","upperRowInitial","Abacus","bottomRow","setBottomRow","upperRow","setUpperRow","emmit","section","bead","state","row","setter","AbacusSlide","visible","ChessLogic","rows","columns","prepareCellInitialState","isPlayingAsWhite","figure","side","split","includes","sides","ME","OPPONENT","colors","WHITE","BLACK","figures","PAWN","ROOK","HORSE","BISHOP","QUEEN","KING","possibleMove","getPossibleMovesForQueen","boardState","cell","j","kingCell","activeCells","getPossibleMovesForRook","getPossibleMovesForBishop","this","_","figureColor","blackPawn","blackBishop","blackHorse","blackRook","blackQueen","blackKing","whitePawn","whiteBishop","whiteHorse","whiteRook","whiteQueen","whiteKing","getCell","filter","move","getPossibleMovesForHorse","getAllMovesForKing","indexOf","Number","attackingPieces","getAttackingPawns","getAttackingHorses","getAttackingBishopsOrQueens","getAttackingRooksOrQueens","getAttackingKings","attackers","start","end","startI","startJ","endI","endJ","Math","max","min","cells","modI","modJ","king","attackingBishopsOrQueens","attacker","diagonalCells","getDiagonalCells","diagonalCell","attackingRooksOrQueens","horizontalCells","getHorizontalCells","horizontalCell","previousMove","oneForward","twoForward","left","right","prevToI","prevFromI","from","enPassantLeft","enPassantRight","getAllMovesForPawn","attackersCoordinates","aCell","filterAttackingRooksForPin","horseMoves","filterAttackingBishopsForPin","cursorX","cursorY","gotCell","cellCoordinate","kingMoved","shortRookMoved","longRookMoved","sign","isUnderAttack","kingMoves","boardStateWithNoKing","getCastlingMoves","legalMoves","getKing","isCheck","getPossibleMovesForPawn","getPossibleMovesForKing","getAttackers","legalMovesCoordinates","getLegalMovesDuringCheck","fromTwo","toTwo","fromJ","toI","toJ","rules","fromY","toY","Chessboard","setBoardState","makeMove","hideMoves","isWhiteTurn","castingInfo","whiteKingMoved","blackKingMoved","whiteShortRookMoved","blackShortRookMoved","whiteLongRookMoved","blackLongRookMoved","clickedCell","setClickedCell","handleClick","activeCellsCoordinates","getPossibleMoves","showPossibleMoves","isBlack","rowIndex","index","img","getImg","el","ChessboardSlide","setWhiteKingMoved","setBlackKingMoved","setWhiteShortRookMoved","setBlackShortRookMoved","setWhiteLongRookMoved","setBlackLongRookMoved","setIsPlayingAsWhite","setIsWhiteTurn","activeSwitch","setActiveSwitch","setRows","setColumns","desk","setDesk","previousMoves","setPreviousMoves","takenBackMoves","setTakenBackMoves","stateRef","useRef","React","previousMovesRef","takenBackMovesRef","isPlayingAsWhiteRef","oldRows","oldColumns","newRows","reverse","newColumns","oldState","newDesk","field","moveMade","isWhite","newGameStarted","pMove","moveTakenBack","startNewGame","pMoves","logic","checkCastlingMoves","isQueen","checkQueen","checkCastlingRights","anPassant","checkAnPassant","isCastle","isAnPassant","setStateMakeMove","toFigure","tbMoves","slice","title","icon","faArrowsRotate","faRepeat","takeMoveBack","faLeftLong","fromI","fromCell","toCell","unTakeMoveBack","faRightLong","Canvas","hasChessboard","hasAbacus","setWidth","setHeight","canvasBackground","createRef","onLoad","maxHeight","maxWidth","padding","window","innerWidth","maxProportion","imageProportion","proportion","style","backgroundImage","parseInt","Switch","labelOne","labelTwo","valueOne","valueTwo","switchChange","InlinePicker","defaultValue","values","valueField","onChangeComplete","defItem","find","activeItem","setActiveItem","InlineColorPicker","activeColor","setActiveColor","ToolPanel","setActiveTool","defWidth","setDrawWidth","defColor","setDrawColor","displayTeacherTools","timerRunning","setTimerRunning","minute","setMinute","second","setSecond","callback","delay","savedCallback","setInterval","clearInterval","Interval","labelField","isEnabled","teacherLogin","TeacherContext","StudentContext","CanvasArea","sidebarOpen","teacherContextSlide","slide","studentContextSlide","contextAllowedToDraw","allowedToDraw","SlideItem","setAllowedStudent","student","allowedStudent","StudentPicker","open","setOpen","students","LevelItem","setLevel","level","LevelPicker","levels","LessonItem","setLesson","lesson","LessonPicker","lessons","setSlide","SlidePicker","slides","ClassRoom","useParams","waitingScreen","waitingScreenMessage","setStudents","setLevels","setLessons","setSlides","slidePickerOpen","setSlidePickerOpen","lessonPickerOpen","setLessonPickerOpen","levelPickerOpen","setLevelPickerOpen","studentPickerOpen","setStudentPickerOpen","getStudents","getLessons","getLevels","getSlides","newLesson","newLevel","ResetPassword","oldPassword","setOldPassword","passwordConfirm","setPasswordConfirm","App","process","Boolean","token","addEventListener","componentStack","stack","FallbackComponent","onError","exact","path","AppContextProvider","components","reduce","AccumulatedComponents","CurrentComponent","children","connectionRef","stream","setStream","callerSignal","setCallerSignal","setCaller","setCallAccepted","setCalling","setReceivingCall","captureVideo","setCaptureVideo","captureAudio","setCaptureAudio","getVideoTracks","track","enabled","getAudioTracks","Peer","initiator","trickle","config","iceServers","urls","username","credential","signal","otherStream","srcObject","hangUp","destroy","location","reload","Provider","navigator","mediaDevices","getUserMedia","video","audio","then","currentStream","clone","studentPeer","signalData","teacherPeer","setWaitingScreen","setWaitingScreenMessage","setAllowedToDraw","allowStudentToDraw","options","position","positions","BOTTOM_CENTER","timeout","offset","transition","transitions","SCALE","ReactDOM","StrictMode","template","AlertTemplate","module","exports"],"mappings":"wmBAEaA,EAAU,WACrB,IAAMC,EAAU,WACd,IAAMC,EAAaC,eAAeC,QAAQ,QACpCC,EAAOC,KAAKC,MAAML,GACxB,OAAOG,QAAcG,GAGvB,EAAwBC,mBAASR,KAAjC,mBAAOI,EAAP,KAAaK,EAAb,KAYA,MAAO,CACLT,UACAS,QAZe,SAAAL,GACfF,eAAeQ,QAAQ,OAAQL,KAAKM,UAAUP,IAC9CK,EAAQL,IAWRA,KAAMA,EACNQ,UATgB,WAChBV,eAAeW,WAAW,QAC1BJ,OAAQF,M,wBCOGO,G,OApBE,SAAC,GAA6C,IAA5CC,EAA2C,EAA3CA,MAAOC,EAAoC,EAApCA,KAAMC,EAA8B,EAA9BA,MAAOC,EAAuB,EAAvBA,SAAUC,EAAa,EAAbA,QAE/C,OACE,yBAAKC,UAAU,SACb,2BAAOA,UAAU,eAAeC,KAAK,QAAQC,GAAI,SAAWL,EAAOD,KAAMA,EAAMC,MAAOA,EAAOM,eAAgBJ,EACtGK,QAAS,SAAAC,GAAC,OAAIP,EAASO,EAAEC,cAAcT,UAC9C,2BAAOU,QAAS,SAAWV,GAAQF,M,yBCNnCa,EAAMC,IAAMC,OAAO,CACvBC,QAAQ,GAAD,OAAKC,IAAL,QACPC,QAAS,CACP,eAAgB,sBAWpBL,EAAIM,aAAaC,SAASC,KACxB,SAAAC,GAAG,OAAIA,KACP,SAAAC,GAC8B,MAAxBA,EAAIH,SAASI,SAEf3B,EADoBb,IAAba,aAGT,OAAO4B,QAAQC,OAAOH,MAIXV,QCjBTc,G,OAAS,uCAAG,mCAAAC,EAAA,yDAAQC,EAAR,EAAQA,YAAavB,EAArB,EAAqBA,KAArB,SAED,YAATA,EAFU,gCAGMO,EAAIiB,KAAK,gBAAiBD,GAHhC,cAGNP,EAHM,yBAILA,EAAIS,MAJC,UAKM,YAATzB,EALG,kCAMMO,EAAIiB,KAAK,gBAAiBD,GANhC,eAMNP,EANM,yBAOLA,EAAIS,MAPC,gEAUR,KAAEX,SAASW,KAAKC,OAVR,0DAAH,uDAgHAC,EAlGD,SAAC,GAAe,IAAdC,EAAa,EAAbA,QACRC,EAAUC,cACVC,EAAQC,cAEP5C,EAAWV,IAAXU,QAEP,EAA0BD,qBAA1B,mBAAO8C,EAAP,KAAcC,EAAd,KACA,EAAgC/C,qBAAhC,mBAAOgD,EAAP,KAAiBC,EAAjB,KACA,EAAwBjD,mBAAS,WAAjC,mBAAOa,EAAP,KAAaqC,EAAb,KAQMC,EAAY,uCAAG,WAAMlC,GAAN,eAAAkB,EAAA,6DACnBlB,EAAEmC,iBACFX,EAAQ,CAAC7C,UAAMG,EAAWsD,iBAAiB,EAAOC,WAAW,IAF1C,kBAIEpB,EAAU,CAC3BE,YAAa,CACXU,QACAE,YAEFnC,SATe,OAIXjB,EAJW,OAYjBK,EAAQL,GACR6C,EAAQ,CAAC7C,KAAMA,EAAMyD,iBAAiB,EAAMC,WAAW,IACvDZ,EAAQa,KAAK,IAAM3D,EAAKiB,MAdP,kDAiBjB2C,QAAQC,IAAR,MACAhB,EAAQ,CAAC7C,UAAMG,EAAWsD,iBAAiB,EAAOC,WAAW,IAChD,EAAD,GAxBPI,SAAQ,SAAA5B,GACbc,EAAMe,KAAK7B,EAAI8B,QAIE,0DAAH,sDAuBlB,OACE,yBAAKhD,UAAU,iBACb,yBAAKA,UAAU,qBACb,yBAAKA,UAAU,cAEb,0BAAMA,UAAU,OAAOiD,SAAU,SAAC5C,GAAD,OAAOkC,EAAalC,KACnD,yBAAKL,UAAU,gBACb,iIAAsB,6BACpB,0BAAMA,UAAU,kBAAiB,0BAAMA,UAAU,YAAhB,KAAjC,mBAEJ,yBAAKA,UAAW,kBACd,yBAAKA,UAAU,oBACb,2BAAOC,KAAK,QAAQD,UAAU,aAAakD,YAAY,iCAAQtD,KAAK,QAAQM,GAAG,QACxEJ,SAAU,SAAAO,GAAC,OAAI8B,EAAS9B,EAAE8C,OAAOtD,QAAQuD,UAAQ,IACxD,2BAAO7C,QAAQ,QAAQP,UAAU,cAAjC,mCAGF,yBAAKA,UAAU,oBACb,2BAAOC,KAAK,WAAWD,UAAU,aAAakD,YAAY,uCAAStD,KAAK,WAAWM,GAAG,WAC/EJ,SAAU,SAAAO,GAAC,OAAIgC,EAAYhC,EAAE8C,OAAOtD,QAAQuD,UAAQ,IAC3D,2BAAO7C,QAAQ,WAAWP,UAAU,cAApC,yCAGF,kBAAC,EAAD,CAAUF,SAAU,SAACD,GAAD,OAAWyC,EAAQzC,IAC7BF,MAAO,6CACPC,KAAM,OACNC,MAAO,YAEjB,kBAAC,EAAD,CAAUC,SAAU,SAACD,GAAD,OAAWyC,EAAQzC,IAC7BF,MAAO,uCACPC,KAAM,OACNC,MAAO,UACPE,SAAS,IAOnB,yBAAKC,UAAU,sBACb,4BAAQC,KAAK,SAASD,UAAU,MAAME,GAAG,YACvC,oEAKR,yBAAKF,UAAU,oBC7FVqD,G,OAbE,SAAC,GAAmB,IAAlBC,EAAiB,EAAjBA,KAAM3D,EAAW,EAAXA,MACvB,OACE,yBAAKK,UAAW,uBACd,kBAAC,IAAD,CAAMuD,GAAID,GAAO3D,M,QCaR6D,G,OAhBA,WACb,IAAM1B,EAAUC,cAMhB,OACE,yBAAK/B,UAAW,YACd,yBAAKA,UAAW,OAAQI,QAAS,WALnC0B,EAAQ2B,WAMJ,kBAAC,IAAD,UCUOC,EAnBK,SAAC,GAAc,IAAbC,EAAY,EAAZA,OACb3E,EAAQL,IAARK,KAEP,OACE,yBAAKgB,UAAW,WACd,yBAAKA,UAAW,gBACd,kBAAC,EAAD,CAAUsD,KAAI,kBAAatE,EAAKkD,OAASvC,MAAO,kEAChD,kBAAC,EAAD,CAAU2D,KAAI,0BAAqBtE,EAAKkD,MAA1B,YAAmClD,EAAKiB,MAAQN,MAAO,oFACrE,4BAAQK,UAAW,wBAAyBI,QAASuD,GAArD,mCAEF,kBAAC,EAAD,QCDSC,EAZK,SAAC,GAAe,IAAdC,EAAa,EAAbA,QACpB,OACE,6BACE,kBAAC,EAAD,CAAUP,KAAI,kBAAaO,EAAQ3B,OAASvC,MAAOkE,EAAQjE,SC+BlDkE,EA7BM,WACnB,MAAgC1E,mBAAS,IAAzC,mBAAO2E,EAAP,KAAiBC,EAAjB,KACOhF,EAAQL,IAARK,KAWP,OATAiF,qBAAU,YACS,uCAAG,4BAAA1C,EAAA,sEACAf,EAAIiB,KAAK,wBAAyB,CAACyC,aAAclF,EAAKkD,QADtD,OACZjB,EADY,OAElB+C,EAAY/C,EAAIS,KAAKqC,UAFH,2CAAH,qDAIjBI,GAAcC,OAAM,SAAClD,GAAD,OAAS0B,QAAQyB,MAAMnD,QAE1C,CAAClC,IAGF,yBAAKgB,UAAW,UAAWE,GAAI,iBAC7B,yBAAKF,UAAW,gBACd,yBAAKA,UAAU,gBACb,2BAAI+D,EAASO,OAAS,iGAAwB,8MAG/CP,EAASQ,KAAI,SAAAV,GAAO,OAAI,kBAAC,EAAD,CAAaW,IAAKX,EAAQY,IAAKZ,QAASA,OAEjE,kBAAC,EAAD,SCjBOa,G,OAVO,WACpB,OACE,yBAAK1E,UAAW,iBACd,yBAAKA,UAAW,cAAhB,kQCmBS2E,EAnBK,SAAC,GAAc,IAAbhB,EAAY,EAAZA,OACd3E,EAAOL,IAEb,OACE,yBAAKqB,UAAW,WACd,yBAAKA,UAAW,gBACd,kBAAC,EAAD,CAAUsD,KAAM,iBAAkB3D,MAAO,kEACzC,kBAAC,EAAD,CAAU2D,KAAI,0BAAqBtE,EAAKkD,MAA1B,YAAmClD,EAAKiB,MAAQN,MAAO,oFACrE,4BAAQK,UAAW,wBAAyBI,QAASuD,GAArD,mCAEF,kBAAC,EAAD,Q,QCESiB,G,OAfC,WACd,OACE,yBAAK5E,UAAU,UACb,yBAAKA,UAAU,SAAS6E,QAAQ,aAC9B,4BAAQ7E,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,OACpD,4BAAQhF,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,OACpD,4BAAQhF,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,OACpD,4BAAQhF,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,OACpD,4BAAQhF,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,OACpD,4BAAQhF,UAAU,gBAAgB8E,GAAG,KAAKC,GAAG,KAAKC,EAAE,W,uBCc7CC,EAtBM,SAAC,GAAyE,IAA7DC,EAA4D,EAAvEC,UAAuE,IAAjDC,KAAO3C,EAA0C,EAA1CA,gBAAiBC,EAAyB,EAAzBA,UAAe2C,EAAU,iBAE5F,OACE,kBAAC,IAAD,iBACMA,EADN,CAEEC,OAAQ,SAAAC,GAAK,OACX7C,EACE,kBAAC,EAAD,MACED,EACF,kBAACyC,EAAD,iBAAeK,EAAWF,IAE1B,kBAAC,IAAD,CAAU9B,GAAG,gB,0BCaRiC,EAtBA,SAAC,GAAc,IAAb7B,EAAY,EAAZA,OAEf,OACE,4BAAQ3D,UAAU,UAChB,yBAAKA,UAAU,QACb,yBAAKA,UAAU,aACb,yBAAKyF,IAAKC,IAAMC,IAAI,sFAGxB,yBAAK3F,UAAW,UACd,yBAAKE,GAAG,YAAYE,QAASuD,GAC3B,kBAAC,IAAD,UCEKiC,G,OAdO,SAAC,GAAuB,IAAtBC,EAAqB,EAArBA,QAASC,EAAY,EAAZA,OAC/B,OACE,yBAAK9F,UAAS,yBAAqB8F,EAAoB,GAAX,WAC1C,yBAAK9F,UAAW,SAAU6F,GAAoB,2HAC9C,kBAAC,EAAD,S,yBCHAE,EAASC,YAAGpF,KAEZqF,EAAeC,wBAAc,ICoGpBC,G,OAlGG,SAAC,GAAY,IAAXC,EAAU,EAAVA,KAClB,EAoBIC,qBAAWJ,GAnBbK,EADF,EACEA,MACAC,EAFF,EAEEA,OAEAC,EAJF,EAIEA,aACAC,EALF,EAKEA,QACAC,EANF,EAMEA,cAEAC,EARF,EAQEA,QACAC,EATF,EASEA,UAEAC,EAXF,EAWEA,YACAC,EAZF,EAYEA,WACAC,EAbF,EAaEA,UAUF9C,qBAAU,WACRqC,MACC,IAEH,IACMtH,GAAOJ,EADKD,IAAXC,WAGP,OACE,yBAAKoB,UAAW,iBACbyG,GAAW,yBAAKzG,UAAW,gBAC1B,yBAAKA,UAAW,sBAAhB,qIAGD0G,GAAiB,yBAAK1G,UAAW,gBAChC,yBAAKA,UAAW,sBAAhB,8GAGAwG,IAAiBC,GAAyB,YAAdzH,EAAKiB,MAAsB,yBAAKD,UAAW,gBACvE,yBAAKA,UAAW,sBAAhB,oTAGF,yBAAKA,UAAW,uBAEd,2BACEgH,IAAKL,EACLM,OAAK,EACLC,UAAQ,EACRlH,UAAU,aAGZ,yBAAKA,UAAW,oCAGE,YAAdhB,EAAKiB,OAAuBwG,IAAYD,GACxC,yBAAKxG,UAAU,qBAAqBI,QAAS,kBAAMyG,EAAYT,KAAO,kBAAC,IAAD,OAGxD,YAAdpH,EAAKiB,MAAsByG,GAC3B,yBAAK1G,UAAU,qBAAqBI,QAAS,kBAAM0G,EAAWP,KAAS,kBAAC,IAAD,OAGvEC,GACA,yBAAKxG,UAAU,mBAAmBI,QAAS,kBAAM2G,EAAUR,KAAS,kBAAC,IAAD,SAe1E,yBAAKvG,UAAW,iBAEhB,yBAAKA,UAAW,uBACd,2BACEgH,IAAKJ,EACLM,UAAQ,EACRlH,UAAU,uBC9ELmH,EAhBC,SAAC,GAAW,IAAVC,EAAS,EAATA,IACIC,EAAa1I,IAA1BK,KAAOiB,KAEd,OACE,yBAAKD,UAAW,YACd,yBAAKA,UAAW,YACA,YAAbqH,EAAyB,2BAAID,GAAO,IAAU,M,kCCV1CE,EAEH,SAFGA,EAGH,SAHGA,EAIH,SAJGA,GAQF,GCLI,SAASC,GAAOC,GAE7B,IAAIzB,EACAK,EAEAqB,EACAC,EACAC,EAEAC,EAQAC,EACAC,EAPAC,EAAaT,GACbxB,GAAS,EAETkC,EAAY,GACZC,EAAY,QAKhBT,EAAElB,MAAQ,WACRsB,EAAYJ,EAAEU,UAAUC,KACxB,IAAMC,EAAYC,SAASC,eAAe,cAC1C,GAAIF,EAAJ,CAGAP,EAAcO,EAAUG,YACxBT,EAAeM,EAAUI,aAIzB,IADA,IAAMC,EAAWL,EAAUM,qBAAqB,UACvCC,EAAI,EAAGA,EAAIF,EAASnE,OAAQqE,IAC/BF,EAASE,IAAIF,EAASE,GAAGC,cAAcC,YAAYJ,EAASE,IAElElB,EAASD,EAAEsB,aAAajB,EAAaC,GACrCJ,EAAgBF,EAAEuB,eAAelB,EAAaC,GAC9CH,EAAeH,EAAEuB,eAAelB,EAAaC,GAC7CL,EAAOuB,OAAO,gBAGhBxB,EAAEyB,KAAO,WAKP,GAJAzB,EAAE0B,QACF1B,EAAEW,MAAMT,EAAe,EAAG,GAC1BF,EAAEW,MAAMR,EAAc,EAAG,GAErBI,IAAeT,EAAc,CAE/BE,EAAE2B,WAEF,IAAIzH,EAAO,CACT0H,EAAG5B,EAAE6B,QAAQxB,EAAY,KACzByB,EAAG9B,EAAE+B,QAAQzB,EAAa,MAE5B/B,EAAOyD,KAAK,gBAAiB,CAACpD,OAAM1E,cAIpC8F,EAAEiC,SAEE1B,IAAeT,GACjBoC,EAAa,CAACN,EAAG5B,EAAE6B,OAAQC,EAAG9B,EAAE+B,UAMtC/B,EAAEmC,aAAe,WACf,GAAK7D,EACL,GAAIiC,IAAeT,EAAc,CAC/B,IAAI5F,EAAO,CACT0H,EAAG5B,EAAE6B,QAAQxB,EAAY,KACzByB,EAAG9B,EAAE+B,QAAQzB,EAAa,KAC1B8B,QAASpC,EAAEqC,SAAShC,EAAY,KAChCiC,QAAStC,EAAEuC,SAASjC,EAAa,KACjCkC,KAAMhC,EACNiC,MAAOhC,GAETlC,EAAOyD,KAAK,gBAAiB,CAACpD,OAAM1E,cAC/B,GAAIqG,IAAeT,EAAc,CACtC,IAAI5F,EAAO,CACT0H,EAAG5B,EAAE6B,QAAQxB,EAAY,KACzByB,EAAG9B,EAAE+B,QAAQzB,EAAa,MAE5B/B,EAAOyD,KAAK,gBAAiB,CAACpD,OAAM1E,WAIxC8F,EAAE0C,aAAe,WACf,GAAKpE,GACDiC,IAAeT,EAAc,CAC/B,IAAI5F,EAAO,CACT0H,EAAG5B,EAAE6B,QAAQxB,EAAY,KACzByB,EAAG9B,EAAE+B,QAAQzB,EAAa,MAE5B/B,EAAOyD,KAAK,gBAAiB,CAACpD,OAAM1E,WAIxC,IAyBMgI,EAAe,SAAC,GAAY,IAAXN,EAAU,EAAVA,EAAGE,EAAO,EAAPA,EACxB3B,EAAauB,QACbvB,EAAawC,KAAK,EAAG,IAAK,EAAG,KAC7BxC,EAAayC,OAAOhB,EAAGE,EAAG,IAC1B9B,EAAEW,MAAMR,EAAc,EAAG,IAG3BH,EAAE6C,yCAA2C,SAAAC,GAC3ClE,EAAOkE,EAASlE,KAEhBN,EAASwE,EAASxE,OAClBiC,EAAauC,EAASvC,WACtBC,EAAYsC,EAAStC,UACrBC,EAAYqC,EAASrC,UAEhBqC,EAASvE,SACRA,KAENA,EAASuE,EAASvE,QAEXwE,GAAG,QAAQ,SAAC7I,IAzCF,SAAC,GAA2C,IAA1C0H,EAAyC,EAAzCA,EAAGE,EAAsC,EAAtCA,EAAGM,EAAmC,EAAnCA,QAASE,EAA0B,EAA1BA,QAASE,EAAiB,EAAjBA,KAAMC,EAAW,EAAXA,MAC7CO,EAAI9C,EAAcuC,MAAMA,GAC5BvC,EAAc+C,OAAOD,GACrB9C,EAAcgD,aAAaV,GAC3BtC,EAAciD,KAAK9C,EAAY,IAAIuB,EAAGtB,EAAa,IAAIwB,EAAGzB,EAAY,IAAI+B,EAAS9B,EAAa,IAAIgC,EAASE,GAsC3GY,CAAWlJ,MAGbqE,EAAOwE,GAAG,SAAS,SAAC7I,IAtCP,SAAC,GAAY,IAAX0H,EAAU,EAAVA,EAAGE,EAAO,EAAPA,EAClB5B,EAAcmD,QACdnD,EAAc0C,OAAOvC,EAAY,IAAIuB,EAAGtB,EAAa,IAAIwB,EAAG,IAC5D5B,EAAcoD,UAoCZC,CAAOrJ,MAGTqE,EAAOwE,GAAG,UAAU,SAAC7I,IApCR,SAAC,GAAY,IAAX0H,EAAU,EAAVA,EAAGE,EAAO,EAAPA,EAClB3B,EAAauB,QAEbvB,EAAaQ,MAAMP,EAAWC,EAAY,IAAIuB,EAAGtB,EAAa,IAAIwB,EAAG1B,EAAUoD,MAAQ,GAAIpD,EAAUqD,OAAS,IAE9GzD,EAAEW,MAAMR,EAAc,EAAG,GAgCvB8B,CAAO/H,MAGTqE,EAAOwE,GAAG,gBAAgB,WAxD1B7C,EAAcwB,WA4DdnD,EAAOwE,GAAG,gBAAgB,WACxB/C,EAAElB,c,kBChKFP,GAASC,YAAGpF,IAAW,CAACsK,WAAY,CAAC,aAAcC,SAAS,IAErDC,GAAY,WACvB,MAAO,CAAErF,YCCLsF,GAAmB,CACvB,CAACC,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IAEzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IAEzC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,EAAG,EAAG,EAAG,IACzC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,IAC1C,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,IAC1C,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,IAE1C,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,IAC1C,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,IAC1C,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,EAAG,EAAG,EAAG,KAMtCC,GAAkB,CACtB,CAACH,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,EAAGC,MAAO,CAAC,IAChC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,IACjC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,IACjC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,IACjC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,IACjC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,IACjC,CAACF,QAAS,EAAGC,OAAQ,GAAIC,MAAO,CAAC,KAwEpBE,GAnEA,SAAC,GAAY,IAAXtF,EAAU,EAAVA,KACRL,EAAUqF,KAAVrF,OACP,EAAkC3G,mBAASiM,IAA3C,mBAAOM,EAAP,KAAkBC,EAAlB,KACA,EAAgCxM,mBAASqM,IAAzC,mBAAOI,EAAP,KAAiBC,EAAjB,KAEMC,EAAQ,SAACC,EAAST,EAAQU,GAC9B,IAEMC,GAFuB,WAAZF,EAAuBL,EAAYE,GAE7BtH,KAAI,SAAC4H,GAC1B,GAAIA,EAAIZ,SAAWA,EAAQ,CACzB,IAAID,EAAUW,EAKd,OAJIE,EAAIb,SAAWW,IACjBX,EAAUW,EAAO,GAGZ,6BAAIE,GAAX,IAAgBb,YAElB,OAAOa,KAGTpG,EAAOyD,KAAK,iBAAkB,CAACpD,OAAM4F,UAASE,WAgBhD,OAbAjI,qBAAU,WACR8B,EAAOwE,GAAG,iBAAiB,YAAuB,IAArByB,EAAoB,EAApBA,QAASE,EAAW,EAAXA,MAC9BE,EAAqB,WAAZJ,EAAuBJ,EAAeE,EACrD,IACEM,EAAOF,GACP,MAAO7L,GACPuC,QAAQC,IAAIxC,GACZuC,QAAQC,IAAI,yBAIf,IAGD,yBAAK7C,UAAW,iBACd,yBAAKA,UAAW,qBACb6L,EAAStH,KAAI,SAAC4H,GAAD,OACZ,yBAAK3H,IAAK2H,EAAIZ,OAAQvL,UAAW,SAC9BmM,EAAIX,MAAMjH,KAAI,SAAA1E,GAAK,OAClB,yBAAK2E,IAAK3E,EAAOO,QAAS,kBAAM2L,EAAM,QAASI,EAAIZ,OAAQ1L,IACtDG,UAAS,oBAAeH,EAAf,YAAwBA,IAAUsM,EAAIb,QAAU,SAAW,cAKjF,yBAAKtL,UAAW,mBAChB,yBAAKA,UAAW,sBACb2L,EAAUpH,KAAI,SAAC4H,GAAD,OACb,yBAAK3H,IAAK2H,EAAIZ,OAAQvL,UAAW,SAC9BmM,EAAIX,MAAMjH,KAAI,SAAA1E,GAAK,OAClB,yBAAK2E,IAAK3E,EAAOO,QAAS,kBAAM2L,EAAM,SAAUI,EAAIZ,OAAQ1L,IACvDG,UAAS,oBAAeH,EAAf,YAAwBA,IAAUsM,EAAIb,QAAU,SAAW,gBC9ExEe,GArBK,SAAC,GAAqB,IAApBjG,EAAmB,EAAnBA,KAAMkG,EAAa,EAAbA,QAE1B,OACE,yBAAKtM,UAAS,uBAAmBsM,EAAqB,GAAX,WACzC,yBAAKtM,UAAW,iBACd,yBAAKA,UAAW,gBAChB,yBAAKA,UAAW,iBAChB,yBAAKA,UAAW,eAChB,yBAAKA,UAAW,kBAEhB,kBAAC,GAAD,CAAQoG,KAAMA,O,wQCHhBmG,G,WAkBJ,WAAYC,EAAMC,GAAU,IAAD,iCAoD3BC,wBAA0B,SAAC/D,EAAGgE,GAC5B,IACIC,EACAC,EACA5C,EAHJ,EAAetB,EAAEmE,MAAM,IAAvB,mBAAO1D,EAAP,KAAUE,EAAV,KA8BA,MA1BI,CAAC,IAAK,KAAKyD,SAASzD,KACtBuD,EAAOF,EAAmBJ,EAAWS,MAAMC,GAAKV,EAAWS,MAAME,SACjEjD,EAAQsC,EAAWY,OAAOC,OAExB,CAAC,IAAK,KAAKL,SAASzD,KACtBuD,EAAOF,EAAmBJ,EAAWS,MAAME,SAAWX,EAAWS,MAAMC,GACvEhD,EAAQsC,EAAWY,OAAOE,OAElB,MAAN/D,GAAmB,MAANA,IACfsD,EAASL,EAAWe,QAAQC,MAE1B,CAAC,KAAM,KAAM,KAAM,MAAMR,SAASpE,KACpCiE,EAASL,EAAWe,QAAQE,MAE1B,CAAC,KAAM,KAAM,KAAM,MAAMT,SAASpE,KACpCiE,EAASL,EAAWe,QAAQG,OAE1B,CAAC,KAAM,KAAM,KAAM,MAAMV,SAASpE,KACpCiE,EAASL,EAAWe,QAAQI,QAE1B,CAAC,KAAM,MAAMX,SAASpE,KACxBiE,EAASL,EAAWe,QAAQK,OAE1B,CAAC,KAAM,MAAMZ,SAASpE,KACxBiE,EAASL,EAAWe,QAAQM,MAEvB,CACLxE,IACAE,IACAsD,OAAQA,GAAkB,KAC1BC,KAAMA,GAAc,KACpB5C,MAAOA,GAAgB,KACvB4D,cAAc,IAzFS,KAqgB3BC,yBAA2B,SAACC,EAAYC,EAAMrF,EAAGsF,EAAGC,GAClD,IAAMC,EAAc,GAGpB,OAFAA,EAAYxL,KAAZ,MAAAwL,EAAW,aAAS,EAAKC,wBAAwBL,EAAYC,EAAMrF,EAAGsF,EAAGC,KACzEC,EAAYxL,KAAZ,MAAAwL,EAAW,aAAS,EAAKE,0BAA0BN,EAAYC,EAAMrF,EAAGsF,EAAGC,KACpEC,GAxgBPG,KAAK9B,KAAOA,EACZ8B,KAAK7B,QAAUA,E,4CAKjB,SAAQsB,EAAY3E,EAAGE,GACrB,KAAIF,EAAI,GAAKA,EAAI,GAAKE,EAAI,GAAKA,EAAI,GAEnC,OAAOyE,EAAW3E,GAAGE,K,qBAGvB,SAAQyE,GACN,IAAIG,EAMJ,OALAH,EAAWjL,SAAQ,SAAAyL,GAAC,OAAIA,EAAEzL,SAAQ,SAAAkL,GAC5BA,EAAKpB,SAAWL,EAAWe,QAAQM,MAAQI,EAAKnB,OAASN,EAAWS,MAAMC,KAC5EiB,EAAWF,SAGRE,I,oBAGT,SAAOM,GACL,OAAQA,GACN,KAAMjC,EAAWe,QAAQC,KAAOhB,EAAWY,OAAOE,MAChD,OAAOoB,KACT,KAAMlC,EAAWe,QAAQI,OAASnB,EAAWY,OAAOE,MAClD,OAAOqB,KACT,KAAMnC,EAAWe,QAAQG,MAAQlB,EAAWY,OAAOE,MACjD,OAAOsB,KACT,KAAMpC,EAAWe,QAAQE,KAAOjB,EAAWY,OAAOE,MAChD,OAAOuB,KACT,KAAMrC,EAAWe,QAAQK,MAAQpB,EAAWY,OAAOE,MACjD,OAAOwB,KACT,KAAMtC,EAAWe,QAAQM,KAAOrB,EAAWY,OAAOE,MAChD,OAAOyB,KACT,KAAMvC,EAAWe,QAAQC,KAAOhB,EAAWY,OAAOC,MAChD,OAAO2B,KACT,KAAMxC,EAAWe,QAAQI,OAASnB,EAAWY,OAAOC,MAClD,OAAO4B,KACT,KAAMzC,EAAWe,QAAQG,MAAQlB,EAAWY,OAAOC,MACjD,OAAO6B,KACT,KAAM1C,EAAWe,QAAQE,KAAOjB,EAAWY,OAAOC,MAChD,OAAO8B,KACT,KAAM3C,EAAWe,QAAQK,MAAQpB,EAAWY,OAAOC,MACjD,OAAO+B,KACT,KAAM5C,EAAWe,QAAQM,KAAOrB,EAAWY,OAAOC,MAChD,OAAOgC,Q,+BAiDb,SAAkBrB,EAAYC,EAAMrF,EAAGsF,GAMrC,MALc,CACZK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IAGzBqB,QAAO,SAAAC,GAAI,OAAIA,GAAQA,EAAK3C,SAAWL,EAAWe,QAAQC,MAAQgC,EAAK1C,OAASN,EAAWS,MAAME,c,gCAGhH,SAAmBa,EAAYC,EAAMrF,EAAGsF,GAEtC,OADcK,KAAKkB,yBAAyBzB,EAAYC,EAAMrF,EAAGsF,GACpDqB,QAAO,SAAA3G,GAAC,OAAIA,EAAEiE,SAAWL,EAAWe,QAAQG,W,yCAG3D,SAA4BM,EAAYC,EAAMrF,EAAGsF,GAE/C,OADcK,KAAKD,0BAA0BN,EAAYC,EAAMrF,EAAGsF,GACrDqB,QAAO,SAAA3G,GAAC,OAAIA,EAAEiE,SAAWL,EAAWe,QAAQI,QAAU/E,EAAEiE,SAAWL,EAAWe,QAAQK,W,uCAGrG,SAA0BI,EAAYC,EAAMrF,EAAGsF,GAE7C,OADcK,KAAKF,wBAAwBL,EAAYC,EAAMrF,EAAGsF,GACnDqB,QAAO,SAAA3G,GAAC,OAAIA,EAAEiE,SAAWL,EAAWe,QAAQE,MAAQ7E,EAAEiE,SAAWL,EAAWe,QAAQK,W,+BAGnG,SAAkBI,EAAYC,EAAMrF,EAAGsF,GAErC,OADcK,KAAKmB,mBAAmB1B,EAAYC,EAAMrF,EAAGsF,GAC9CqB,QAAO,SAAA3G,GAAC,OAAIA,EAAEiE,SAAWL,EAAWe,QAAQM,MAAQjF,EAAEkE,OAASN,EAAWS,MAAME,c,2BAG/F,SAAca,EAAYC,GACxB,IAAMrF,EAAI2F,KAAK9B,KAAKkD,QAAQC,OAAO3B,EAAK1E,IAClC2E,EAAIK,KAAK7B,QAAQiD,QAAQ1B,EAAK5E,GAC9BwG,EAAkB,GAMxB,OALAA,EAAgBjN,KAAhB,MAAAiN,EAAe,aAAStB,KAAKuB,kBAAkB9B,EAAYC,EAAMrF,EAAGsF,KACpE2B,EAAgBjN,KAAhB,MAAAiN,EAAe,aAAStB,KAAKwB,mBAAmB/B,EAAYC,EAAMrF,EAAGsF,KACrE2B,EAAgBjN,KAAhB,MAAAiN,EAAe,aAAStB,KAAKyB,4BAA4BhC,EAAYC,EAAMrF,EAAGsF,KAC9E2B,EAAgBjN,KAAhB,MAAAiN,EAAe,aAAStB,KAAK0B,0BAA0BjC,EAAYC,EAAMrF,EAAGsF,KAC5E2B,EAAgBjN,KAAhB,MAAAiN,EAAe,aAAStB,KAAK2B,kBAAkBlC,EAAYC,EAAMrF,EAAGsF,KAC7D2B,EAAgBtL,OAAS,I,0BAGlC,SAAayJ,EAAYG,GACvB,IAAMvF,EAAI2F,KAAK9B,KAAKkD,QAAQC,OAAOzB,EAAS5E,IACtC2E,EAAIK,KAAK7B,QAAQiD,QAAQxB,EAAS9E,GAClC8G,EAAY,GAKlB,OAJAA,EAAUvN,KAAV,MAAAuN,EAAS,aAAS5B,KAAKuB,kBAAkB9B,EAAYG,EAAUvF,EAAGsF,KAClEiC,EAAUvN,KAAV,MAAAuN,EAAS,aAAS5B,KAAKwB,mBAAmB/B,EAAYG,EAAUvF,EAAGsF,KACnEiC,EAAUvN,KAAV,MAAAuN,EAAS,aAAS5B,KAAKyB,4BAA4BhC,EAAYG,EAAUvF,EAAGsF,KAC5EiC,EAAUvN,KAAV,MAAAuN,EAAS,aAAS5B,KAAK0B,0BAA0BjC,EAAYG,EAAUvF,EAAGsF,KACnEiC,I,8BAOT,SAAiBnC,EAAYoC,EAAOC,GAClC,IAAMC,EAAS/B,KAAK9B,KAAKkD,QAAQC,OAAOQ,EAAM7G,IACxCgH,EAAShC,KAAK7B,QAAQiD,QAAQS,EAAM/G,GAEpCmH,EAAOjC,KAAK9B,KAAKkD,QAAQC,OAAOS,EAAI9G,IACpCkH,EAAOlC,KAAK7B,QAAQiD,QAAQU,EAAIhH,GAEtC,GAAIqH,KAAKC,IAAIL,EAAQE,GAAQE,KAAKE,IAAIN,EAAQE,KAAUE,KAAKC,IAAIJ,EAAQE,GAAQC,KAAKE,IAAIL,EAAQE,GAChG,MAAO,GAQT,IALA,IAAMI,EAAQ,GAEVC,EAAOR,EAASE,EAAO,GAAK,EAC5BO,EAAOR,EAASE,EAAO,GAAK,EAEvB7H,EAAI4H,EAAMtC,EAAIuC,EAAM7H,IAAM0H,GAAUpC,IAAMqC,EAAQ3H,GAAKkI,EAAM5C,GAAK6C,EACzEF,EAAMjO,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAGsF,IAEzC,OAAO2C,I,gCAGT,SAAmB7C,EAAYoC,EAAOC,GACpC,IAAMC,EAAS/B,KAAK9B,KAAKkD,QAAQC,OAAOQ,EAAM7G,IACxCgH,EAAShC,KAAK7B,QAAQiD,QAAQS,EAAM/G,GAEpCmH,EAAOjC,KAAK9B,KAAKkD,QAAQC,OAAOS,EAAI9G,IACpCkH,EAAOlC,KAAK7B,QAAQiD,QAAQU,EAAIhH,GAEhCwH,EAAQ,GAEd,GAAIP,IAAWE,GACb,GAAID,EAASE,EACX,IAAK,IAAI7H,EAAI2H,EAAS,EAAG3H,GAAK6H,EAAM7H,IAClCiI,EAAMjO,KAAK2L,KAAKe,QAAQtB,EAAYsC,EAAQ1H,SAEzC,GAAI2H,EAASE,EAClB,IAAK,IAAI7H,EAAI6H,EAAM7H,EAAI2H,EAAQ3H,IAC7BiI,EAAMjO,KAAK2L,KAAKe,QAAQtB,EAAYsC,EAAQ1H,QAG3C,IAAI2H,IAAWE,EAWpB,MAAO,GAVP,GAAIH,EAASE,EACX,IAAK,IAAI5H,EAAI0H,EAAS,EAAG1H,GAAK4H,EAAM5H,IAClCiI,EAAMjO,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAG2H,SAEpC,GAAID,EAASE,EAClB,IAAK,IAAI5H,EAAI4H,EAAM5H,EAAI0H,EAAQ1H,IAC7BiI,EAAMjO,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAG2H,IAM7C,OAAOM,I,0CAOT,SAA6B7C,EAAYC,EAAM+C,EAAMC,GAA2B,IAAD,OAC7E,OAAOA,EAAyB1B,QAAO,SAAA2B,GACrC,IAAMC,EAAgB,EAAKC,iBAAiBpD,EAAYgD,EAAME,GAC9D,IAAKC,EAAc5M,OAAQ,OAAO,EAClC,IAAK,IAAIqE,EAAI,EAAGA,EAAIuI,EAAc5M,OAAQqE,IAAK,CAC7C,IAAIyI,EAAeF,EAAcvI,GACjC,GAAIyI,EAAaxE,QACXwE,EAAahI,IAAM4E,EAAK5E,GAAKgI,EAAa9H,IAAM0E,EAAK1E,GACrD8H,EAAahI,IAAM6H,EAAS7H,GAAKgI,EAAa9H,IAAM2H,EAAS3H,EACjE,OAAO,EAEX,OAAO,O,wCAIX,SAA2ByE,EAAYC,EAAM+C,EAAMM,GAAyB,IAAD,OACzE,OAAOA,EAAuB/B,QAAO,SAAA2B,GACnC,IAAMK,EAAkB,EAAKC,mBAAmBxD,EAAYgD,EAAME,GAClE,IAAKK,EAAgBhN,OAAQ,OAAO,EACpC,IAAK,IAAIqE,EAAI,EAAGA,EAAI2I,EAAgBhN,OAAQqE,IAAK,CAC/C,IAAI6I,EAAiBF,EAAgB3I,GACrC,GAAI6I,EAAe5E,QACb4E,EAAepI,IAAM4E,EAAK5E,GAAKoI,EAAelI,IAAM0E,EAAK1E,GACzDkI,EAAepI,IAAM6H,EAAS7H,GAAKoI,EAAelI,IAAM2H,EAAS3H,EACrE,OAAO,EAEX,OAAO,O,gCAKX,SAAmByE,EAAY0D,EAAczD,EAAMrF,EAAGsF,GACpD,IAAME,EAAc,GAEduD,EAAapD,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,GACnD,IAAKyD,EAAW9E,SACduB,EAAYxL,KAAK+O,GACP,IAAN/I,GAAS,CACX,IAAMgJ,EAAarD,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,GAC9C0D,EAAW/E,QAAQuB,EAAYxL,KAAKgP,GAI7C,MAAsB,CAACrD,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GAAIK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IAA5F2D,EAAP,KAAaC,EAAb,KAIA,GAHID,GAAQA,EAAKhF,QAAUgF,EAAK/E,OAASN,EAAWS,MAAME,UAAUiB,EAAYxL,KAAKiP,GACjFC,GAASA,EAAMjF,QAAUiF,EAAMhF,OAASN,EAAWS,MAAME,UAAUiB,EAAYxL,KAAKkP,IAEnFJ,EAAalO,GAAI,OAAO4K,EAE7B,IAAM2D,EAAUxD,KAAK9B,KAAKkD,QAAQC,OAAO8B,EAAalO,GAAG+F,IACnDyI,EAAYzD,KAAK9B,KAAKkD,QAAQC,OAAO8B,EAAaO,KAAK1I,IAC7D,GAAgB,IAAZwI,GAA+B,IAAdC,GAAyB,IAANpJ,EAAS,CAC/C,MAAwC,CAAC2F,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAI,GAAIK,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAI,IAAtGgE,EAAP,KAAsBC,EAAtB,KAEIT,EAAalO,GAAG6F,IAAM6I,EAAc7I,GACtC+E,EAAYxL,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IAEnDwD,EAAalO,GAAG6F,IAAM8I,EAAe9I,GACvC+E,EAAYxL,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IAIzD,OAAOE,I,qCAGT,SAAwBJ,EAAY0D,EAAczD,EAAMrF,EAAGsF,EAAG8C,GAAO,IAAD,OAC5D5C,EAAc,GAEpBA,EAAYxL,KAAZ,MAAAwL,EAAW,aAASG,KAAK6D,mBAAmBpE,EAAY0D,EAAczD,EAAMrF,EAAGsF,KAE/E,IAAI+C,EAA2B1C,KAAKyB,4BAA4BhC,EAAYC,EAAMrF,EAAGsF,GACrF,GAAI+C,EAAyB1M,SAC3B0M,EAA2BA,EAAyB1B,QAAO,SAAA2B,GAAQ,OAAI,EAAKE,iBAAiBpD,EAAYgD,EAAME,GAAU3M,WAC5FA,OAAQ,CACnC,IAAM8N,EAAuBpB,EAAyBzM,KAAI,SAAAoE,GAAC,OAAIA,EAAES,EAAIT,EAAEW,KACvE,OAAO6E,EAAYmB,QAAO,SAAA+C,GAAK,OAAID,EAAqBrF,SAASsF,EAAMjJ,EAAIiJ,EAAM/I,MAIrF,IAAI+H,EAAyB/C,KAAK0B,0BAA0BjC,EAAYC,EAAMrF,EAAGsF,GACjF,GAAIoD,EAAuB/M,OAAQ,CACjC+M,EAAyB/C,KAAKgE,2BAA2BvE,EAAYC,EAAM+C,EAAMM,GAEjF,IAAK,IAAI1I,EAAI,EAAGA,EAAI0I,EAAuB/M,OAAQqE,IAAK,CACtD,IAAIsI,EAAWI,EAAuB1I,GACtC,GAAIsI,EAAS3H,IAAM0E,EAAK1E,EACtB,MAAO,GACF,GAAI2H,EAAS7H,IAAM4E,EAAK5E,EAC7B,OAAO+E,EAAYmB,QAAO,SAAA+C,GAAK,OAAIA,EAAMjJ,IAAM4E,EAAK5E,MAK1D,OAAO+E,I,sCAGT,SAAyBJ,EAAYC,EAAMrF,EAAGsF,GAAiB,IAAd8C,EAAa,uDAAN,KAChDwB,EAAa,CACjBjE,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IAGtC,IAAK8C,EACH,OAAOwB,EAAWjD,QAAO,SAAA3G,GACvB,OAAOA,KAAOA,EAAEiE,QAAUjE,EAAEkE,OAASN,EAAWS,MAAME,aAI1D,IAAI8D,EAA2B1C,KAAKyB,4BAA4BhC,EAAYC,EAAMrF,EAAGsF,GACrF,GAAI+C,EAAyB1M,SAC3B0M,EAA2B1C,KAAKkE,6BAA6BzE,EAAYC,EAAM+C,EAAMC,IACxD1M,OAAQ,MAAO,GAG9C,IAAI+M,EAAyB/C,KAAK0B,0BAA0BjC,EAAYC,EAAMrF,EAAGsF,GACjF,OAAIoD,EAAuB/M,SACzB+M,EAAyB/C,KAAKgE,2BAA2BvE,EAAYC,EAAM+C,EAAMM,IACtD/M,OAAe,GAErCiO,EAAWjD,QAAO,SAAA3G,GACvB,OAAOA,KAAOA,EAAEiE,QAAUjE,EAAEkE,OAASN,EAAWS,MAAME,e,uCAI1D,SAA0Ba,EAAYC,EAAMrF,EAAGsF,GAI7C,IAJ8D,IAAd8C,EAAa,uDAAN,KACjD5C,EAAc,GAChBsE,EAAU9J,EACV+J,EAAUzE,IACD,CACXwE,IACAC,IACA,IAAIC,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXwE,IACAC,IACA,IAAIC,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXyE,IACAD,IACA,IAAIE,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXyE,IACAD,IACA,IAAIE,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAU1C,IAAK5B,EACH,OAAO5C,EAET,IAAI6C,EAA2B1C,KAAKyB,4BAA4BhC,EAAYC,EAAMrF,EAAGsF,GACrF,GAAI+C,EAAyB1M,SAC3B0M,EAA2B1C,KAAKkE,6BAA6BzE,EAAYC,EAAM+C,EAAMC,IACxD1M,OAAQ,CACnC,IAAM2M,EAAWD,EAAyB,GACpC4B,EAAiB5E,EAAK5E,EAAI4E,EAAK1E,EACrC,OAAOgF,KAAK6C,iBAAiBpD,EAAYgD,EAAME,GAAU3B,QAAO,SAAA3G,GAAC,OAAIA,EAAES,EAAIT,EAAEW,IAAMsJ,GAAkBjK,EAAEkE,OAASN,EAAWS,MAAMC,MAIrI,IAAIoE,EAAyB/C,KAAK0B,0BAA0BjC,EAAYC,EAAMrF,EAAGsF,GACjF,OAAIoD,EAAuB/M,SACzB+M,EAAyB/C,KAAKgE,2BAA2BvE,EAAYC,EAAM+C,EAAMM,IACtD/M,OAAe,GAErC6J,I,qCAGT,SAAwBJ,EAAYC,EAAMrF,EAAGsF,GAI3C,IAJ4D,IAAd8C,EAAa,uDAAN,KAC/C5C,EAAc,GAChBsE,EAAU9J,EACV+J,EAAUzE,IACD,CACXwE,IACA,IAAIE,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXwE,IACA,IAAIE,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXyE,IACA,IAAIC,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAW1C,IAFAF,EAAU9J,EACV+J,EAAUzE,IACG,CACXyE,IACA,IAAIC,EAAUrE,KAAKe,QAAQtB,EAAY0E,EAASC,GAChD,IAAIC,EAQG,MAPL,GAAKA,EAAQ/F,OACR,IAAI+F,EAAQ9F,OAASN,EAAWS,MAAME,SAAU,CACnDiB,EAAYxL,KAAKgQ,GACjB,MAEA,MALmBxE,EAAYxL,KAAKgQ,GAU1C,IAAK5B,EACH,OAAO5C,EAET,IAAI6C,EAA2B1C,KAAKyB,4BAA4BhC,EAAYC,EAAMrF,EAAGsF,GACrF,GAAI+C,EAAyB1M,SAC3B0M,EAA2B1C,KAAKkE,6BAA6BzE,EAAYC,EAAM+C,EAAMC,IACxD1M,OAAQ,MAAO,GAI9C,IAAI+M,EAAyB/C,KAAK0B,0BAA0BjC,EAAYC,EAAMrF,EAAGsF,GACjF,GAAIoD,EAAuB/M,SACzB+M,EAAyB/C,KAAKgE,2BAA2BvE,EAAYC,EAAM+C,EAAMM,IACtD/M,OAAQ,CACjC,IAAM2M,EAAWI,EAAuB,GAClCuB,EAAiB5E,EAAK5E,EAAI4E,EAAK1E,EACrC,OAAOgF,KAAKiD,mBAAmBxD,EAAYgD,EAAME,GAAU3B,QAAO,SAAA3G,GAAC,OAAIA,EAAES,EAAIT,EAAEW,IAAMsJ,KAGzF,OAAOzE,I,8BAUT,SAAiBJ,EAAYC,EAAMrF,EAAGsF,EAAG4E,EAAWC,EAAgBC,GAAgB,IAC9EC,EAD6E,OAG/EA,EADEhF,EAAK/D,QAAUsC,EAAWY,OAAOC,MAC5B,GAEC,EAGV,IAAMe,EAAc,GACpB,IAAK0E,EAAW,CACd,IAAKC,EAQgC,IAPrB,CACZxE,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK+E,GACjC1E,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK,EAAI+E,IAEL1D,QAAO,SAAAC,GAAI,OAAIA,IAASA,EAAK3C,UACf0C,QAAO,SAAAC,GAAI,OAAIA,IAAS,EAAK0D,cAAclF,EAAYwB,MAE/EjL,QACtB6J,EAAYxL,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK,EAAI+E,IAG1D,IAAKD,EASgC,IARrB,CACZzE,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK+E,GACjC1E,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK,EAAI+E,GACrC1E,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK,EAAI+E,IAEL1D,QAAO,SAAAC,GAAI,OAAIA,IAASA,EAAK3C,UACf0C,QAAO,SAAAC,GAAI,OAAIA,IAAS,EAAK0D,cAAclF,EAAYwB,MAE/EjL,QACtB6J,EAAYxL,KAAK2L,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAK,EAAI+E,IAI5D,OAAO7E,I,gCAGT,SAAmBJ,EAAYC,EAAMrF,EAAGsF,GACtC,MAAO,CACLK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,GAChCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,GAEhCK,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAI,GAChCK,KAAKe,QAAQtB,EAAYpF,EAAGsF,EAAI,GAEhCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GAEpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,GACpCK,KAAKe,QAAQtB,EAAYpF,EAAI,EAAGsF,EAAI,IACpCqB,QAAO,SAAAC,GAAI,QAAMA,O,qCAIrB,SAAwBxB,EAAYC,EAAMrF,EAAGsF,EAAG4E,EAAWC,EAAgBC,GAAgB,IAAD,SACpFG,EAAY5E,KAAKmB,mBAAmB1B,EAAYC,EAAMrF,EAAGsF,GACvDkF,EAAuBpF,EAAWxJ,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GACrD,OAAIA,EAAEiE,SAAWL,EAAWe,QAAQM,MAAQjF,EAAEkE,OAASN,EAAWS,MAAMC,GAC/D,6BACFtE,GADL,IAEEiE,OAAQ,KACRC,KAAM,KACN5C,MAAO,OAIJtB,QAQT,OAFA,EAJAuK,EAAYA,EAAU5D,QAAO,SAAAC,GAC3B,QAASA,EAAK3C,QAAU2C,EAAK1C,OAASN,EAAWS,MAAME,YAAc,EAAK+F,cAAcE,EAAsB5D,OAGtG5M,KAAV,qBAAkB2L,KAAK8E,iBAAiBrF,EAAYC,EAAMrF,EAAGsF,EAAG4E,EAAWC,EAAgBC,KAEpFG,I,sCAOT,SAAyBnF,EAAYG,EAAUgC,GAC7C,IAAMmD,EAAa,GAEnB,GAAyB,IAArBnD,EAAU5L,OAAc,CAC1B,IAAM2M,EAAWf,EAAU,GACvBe,EAASrE,SAAWL,EAAWe,QAAQC,MAAQ0D,EAASrE,SAAWL,EAAWe,QAAQG,MACxF4F,EAAW1Q,KAAKsO,IAEhBoC,EAAW1Q,KAAX,MAAA0Q,EAAU,aAAS/E,KAAK6C,iBAAiBpD,EAAYG,EAAU+C,KAC/DoC,EAAW1Q,KAAX,MAAA0Q,EAAU,aAAS/E,KAAKiD,mBAAmBxD,EAAYG,EAAU+C,MAIrE,OAAOoC,I,8BAGT,SAAiBtF,EAAY0D,EAAczD,EAAM6E,EAAWC,EAAgBC,GAAgB,IAAD,YACrF5E,EAAc,GACZxF,EAAI2F,KAAK9B,KAAKkD,QAAQC,OAAO3B,EAAK1E,IAClC2E,EAAIK,KAAK7B,QAAQiD,QAAQ1B,EAAK5E,GAC9B8E,EAAWI,KAAKgF,QAAQvF,GACxBwF,EAAUjF,KAAK2E,cAAclF,EAAYG,GAE/C,OAAQF,EAAKpB,QACX,KAAML,EAAWe,QAAQC,MACvB,EAAAY,GAAYxL,KAAZ,qBAAoB2L,KAAKkF,wBAAwBzF,EAAY0D,EAAczD,EAAMrF,EAAGsF,EAAGC,KACvF,MACF,KAAM3B,EAAWe,QAAQG,OACvB,EAAAU,GAAYxL,KAAZ,qBAAoB2L,KAAKkB,yBAAyBzB,EAAYC,EAAMrF,EAAGsF,EAAGC,KAC1E,MACF,KAAM3B,EAAWe,QAAQI,QACvB,EAAAS,GAAYxL,KAAZ,qBAAoB2L,KAAKD,0BAA0BN,EAAYC,EAAMrF,EAAGsF,EAAGC,KAC3E,MACF,KAAM3B,EAAWe,QAAQE,MACvB,EAAAW,GAAYxL,KAAZ,qBAAoB2L,KAAKF,wBAAwBL,EAAYC,EAAMrF,EAAGsF,EAAGC,KACzE,MACF,KAAM3B,EAAWe,QAAQK,OACvB,EAAAQ,GAAYxL,KAAZ,qBAAoB2L,KAAKR,yBAAyBC,EAAYC,EAAMrF,EAAGsF,EAAGC,KAC1E,MACF,KAAM3B,EAAWe,QAAQM,MACvB,EAAAO,GAAYxL,KAAZ,qBAAoB2L,KAAKmF,wBAAwB1F,EAAYC,EAAMrF,EAAGsF,EAAG4E,EAAWC,EAAgBC,KAIxG,GAAIQ,EAAS,CACX,IAAMrD,EAAY5B,KAAKoF,aAAa3F,EAAYG,GAE1CyF,EADwBrF,KAAKsF,yBAAyB7F,EAAYG,EAAUgC,GAC9B3L,KAAI,SAAAoE,GAAC,OAAIA,EAAES,EAAIT,EAAEW,KAEjE0E,EAAKpB,SAAWL,EAAWe,QAAQM,OACrCO,EAAcA,EAAYmB,QAAO,SAAA+C,GAAK,OAAIsB,EAAsB5G,SAASsF,EAAMjJ,EAAIiJ,EAAM/I,OAK7F,OAAO6E,I,gCAOT,SAAmBJ,EAAYiE,EAAMzO,GACnC,IAAIsQ,EAASC,EACPC,EAAQzF,KAAK7B,QAAQiD,QAAQsC,EAAK5I,GAClC4K,EAAM1F,KAAK9B,KAAKkD,QAAQC,OAAOpM,EAAG+F,IAClC2K,EAAM3F,KAAK7B,QAAQiD,QAAQnM,EAAG6F,GAC9B8K,EAAQ,IAAI3H,EAAW+B,KAAK9B,KAAM8B,KAAK7B,SAY7C,OAVIuF,EAAKpF,SAAWL,EAAWe,QAAQM,OACjCmG,EAAQE,KAAS,GACnBJ,EAAUK,EAAM7E,QAAQtB,EAAYiG,EAAK,GACzCF,EAAQI,EAAM7E,QAAQtB,EAAYiG,EAAKD,EAAQ,IACtCA,EAAQE,IAAQ,IACzBJ,EAAUK,EAAM7E,QAAQtB,EAAYiG,EAAK,GACzCF,EAAQI,EAAM7E,QAAQtB,EAAYiG,EAAKC,EAAM,KAI1C,CAACJ,EAASC,K,4BAGnB,SAAe/F,EAAYiE,EAAMzO,GAC/B,IAAMoF,EAAI2F,KAAK9B,KAAKkD,QAAQC,OAAOpM,EAAG+F,IAChC2E,EAAIK,KAAK7B,QAAQiD,QAAQnM,EAAG6F,GAClC,GAAI4I,EAAKpF,SAAWL,EAAWe,QAAQC,MAAQyE,EAAK5I,IAAM7F,EAAG6F,IAAM7F,EAAGqJ,OACpE,OAAO,IAAIL,EAAW+B,KAAK9B,KAAM8B,KAAK7B,SAAS4C,QAAQtB,EAAYpF,EAAI,EAAGsF,K,wBAI9E,SAAWF,EAAYiE,EAAMzO,GAC3B,IAAM4Q,EAAQ7F,KAAK9B,KAAKkD,QAAQC,OAAOqC,EAAK1I,IACtC8K,EAAM9F,KAAK9B,KAAKkD,QAAQC,OAAOpM,EAAG+F,IAExC,OAAmB,IAAV6K,GAAuB,IAARC,GAAyB,IAAVD,GAAuB,IAARC,IAAepC,EAAKpF,SAAWL,EAAWe,QAAQC,S,KA/sBtGhB,GACGY,OAAS,CACdC,MAAO,QACPC,MAAO,SAHLd,GAKGe,QAAU,CACfC,KAAM,OACNE,MAAO,QACPC,OAAQ,SACRF,KAAM,OACNG,MAAO,QACPC,KAAM,QAXJrB,GAaGS,MAAQ,CACbE,SAAU,WACVD,GAAI,M,UC4EOoH,GAjGI,SAAC,GAkBO,IAjBLtG,EAiBI,EAjBJA,WACAuG,EAgBI,EAhBJA,cACAC,EAeI,EAfJA,SACAC,EAcI,EAdJA,UACAhI,EAaI,EAbJA,KACAC,EAYI,EAZJA,QACAE,EAWI,EAXJA,iBACA8H,EAUI,EAVJA,YACAhD,EASI,EATJA,aASI,IARJiD,YACEC,EAOE,EAPFA,eACAC,EAME,EANFA,eACAC,EAKE,EALFA,oBACAC,EAIE,EAJFA,oBACAC,EAGE,EAHFA,mBACAC,EAEE,EAFFA,mBAItB,EAAsC5V,mBAAS,MAA/C,mBAAO6V,EAAP,KAAoBC,EAApB,KAeMC,EAAc,SAACnH,GACfA,EAAKH,cACF4G,GAAe9H,IAAuB8H,IAAgB9H,IACzD4H,EAASU,EAAajH,GAGpBA,EAAKpB,QAAUoB,EAAKnB,OAASN,GAAWS,MAAMC,IAChDiI,EAAelH,GApBK,SAACA,GACzB,IAAM6E,EAAY7E,EAAK/D,QAAUsC,GAAWY,OAAOC,MAAQuH,EAAiBC,EACtE9B,EAAiB9E,EAAK/D,QAAUsC,GAAWY,OAAOC,MAAQyH,EAAsBC,EAChF/B,EAAgB/E,EAAK/D,QAAUsC,GAAWY,OAAOC,MAAQ2H,EAAqBC,EAE9EI,EADc,IAAI7I,GAAWC,EAAMC,GAAS4I,iBAAiBtH,EAAY0D,EAAczD,EAAM6E,EAAWC,EAAgBC,GACnFxO,KAAI,SAAAoE,GAAC,OAAIA,EAAES,EAAIT,EAAEW,KAE5DgL,EAAcvG,EAAWxJ,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GAEtC,OADAA,EAAEkF,aAAeuH,EAAuBrI,SAASpE,EAAES,EAAIT,EAAEW,GAClDX,SAYL2M,CAAkBtH,KAElBkH,EAAe,MACfV,EAAUzG,KAKZwH,GAAU,EAEd,OACE,yBAAKvV,UAAW,qBAEZ+N,EAAWxJ,KAAI,SAACoE,EAAG6M,GAEjB,OADAD,GAAWA,EACJ5M,EAAEpE,KAAI,SAACyJ,EAAMyH,GAClB,IAAMC,EAAM,IAAInJ,GAAWC,EAAMC,GAASkJ,OAAO3H,EAAKpB,OAASoB,EAAK/D,OAEhE2L,EACF,yBAAKxV,QAAS,kBAAM+U,EAAYnH,IAAOxJ,IAAKwJ,EAAK5E,EAAI4E,EAAK1E,EACrDtJ,UAAS,0BAAqBuV,EAAU,QAAU,UAErD,yBAAKvV,UAAS,uBAA4B,IAAVyV,EAAc,UAAY,KAAOzH,EAAK1E,GACtE,yBAAKtJ,UAAS,uBAA+B,IAAbwV,EAAiB,UAAY,KAAOxH,EAAK5E,GAExEsM,GAAO,yBAAK1V,UAAW,kBAAmByF,IAAKiQ,EAAK/P,IAAI,KAEzD,0BAAM3F,UAAS,gBAAWgO,EAAKH,aAAe,SAAW,OAK7D,OADA0H,GAAWA,EACJK,U,kBCsSJC,GA7WS,SAAC,GAAqB,IAApBzP,EAAmB,EAAnBA,KAAMkG,EAAa,EAAbA,QACVjF,EAAa1I,IAA1BK,KAAOiB,KAEd,EAA4Cb,oBAAS,GAArD,mBAAOuV,EAAP,KAAuBmB,EAAvB,KACA,EAA4C1W,oBAAS,GAArD,mBAAOwV,EAAP,KAAuBmB,EAAvB,KACA,EAAsD3W,oBAAS,GAA/D,mBAAOyV,EAAP,KAA4BmB,EAA5B,KACA,EAAsD5W,oBAAS,GAA/D,mBAAO0V,EAAP,KAA4BmB,EAA5B,KACA,EAAoD7W,oBAAS,GAA7D,mBAAO2V,EAAP,KAA2BmB,EAA3B,KACA,EAAoD9W,oBAAS,GAA7D,mBAAO4V,EAAP,KAA2BmB,EAA3B,KAEA,EAAgD/W,oBAAS,GAAzD,mBAAOuN,EAAP,KAAyByJ,EAAzB,KACA,EAAsChX,oBAAS,GAA/C,mBAAOqV,EAAP,KAAoB4B,EAApB,KACA,EAAwCjX,oBAAS,GAAjD,mBAAOkX,EAAP,KAAqBC,EAArB,KAEA,EAAwBnX,mBAAS,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAAvD,mBAAOoN,EAAP,KAAagK,EAAb,KACA,EAA8BpX,mBAAS,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,MAA3E,mBAAOqN,EAAP,KAAgBgK,EAAhB,KACA,EAAwBrX,mBAASoN,EAAKjI,KAAI,SAAAoE,GAAC,OAAI8D,EAAQlI,KAAI,SAAA0J,GAAC,gBAAOA,GAAP,OAAWtF,UAAvE,mBAAO+N,GAAP,KAAaC,GAAb,KAEA,GAA0CvX,mBAAS,IAAnD,qBAAOwX,GAAP,MAAsBC,GAAtB,MACA,GAA4CzX,mBAAS,IAArD,qBAAO0X,GAAP,MAAuBC,GAAvB,MAEA,GAAoC3X,mBAASsX,GAAKnS,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GAC/D,OAAO,IAAI4D,GAAWC,EAAMC,GAASC,wBAAwB/D,EAAGgE,UADlE,qBAAOoB,GAAP,MAAmBuG,GAAnB,MAIM0C,GAAWC,iBAAOlJ,IACxBmJ,IAAMjT,WAAU,WACd+S,GAAS1L,QAAUyC,KAClB,CAACA,KAEJ,IAAMoJ,GAAmBF,iBAAOL,IAChCM,IAAMjT,WAAU,WACdkT,GAAiB7L,QAAUsL,KAC1B,CAACA,KAEJ,IAAMQ,GAAoBH,iBAAOH,IACjCI,IAAMjT,WAAU,WACdmT,GAAkB9L,QAAUwL,KAC3B,CAACA,KAEJ,IAAMO,GAAsBJ,iBAAOtK,GACnCuK,IAAMjT,WAAU,WACdoT,GAAoB/L,QAAUqB,IAC7B,CAACA,IAEJ1I,qBAAU,WACR,GAAKqS,EAAL,CAIA,IAAMgB,EAAO,aAAO9K,GACd+K,EAAU,aAAO9K,GACjB+K,EAAUhL,EAAKiL,UACfC,EAAajL,EAAQgL,UACrBE,EAAW5J,GACX6J,EAAUJ,EAAQjT,KAAI,SAAAoE,GAAC,OAAI+O,EAAWnT,KAAI,SAAA0J,GAAC,gBAAOA,GAAP,OAAWtF,SAE5D2L,GAAcsD,EAAQrT,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAsT,GAEnC,IAOIhL,EAPJ,EAAegL,EAAM/K,MAAM,IAA3B,mBAAO1D,EAAP,KAAUE,EAAV,KACMX,EAAI2O,EAAQ5H,QAAQC,OAAOrG,IAC3B2E,EAAIsJ,EAAW7H,QAAQtG,GAGvB4E,EAFQ,IAAIzB,GAAWC,EAAMC,GAEhB4C,QAAQsI,EAAUhP,EAAGsF,GAqBxC,OAhBIpB,EAFAF,EACEqB,EAAK/D,QAAUsC,GAAWY,OAAOC,MAC5Bb,GAAWS,MAAMC,GACfe,EAAK/D,QAAUsC,GAAWY,OAAOE,MACnCd,GAAWS,MAAME,SAEjB,KAGLc,EAAK/D,QAAUsC,GAAWY,OAAOC,MAC5Bb,GAAWS,MAAME,SACfc,EAAK/D,QAAUsC,GAAWY,OAAOE,MACnCd,GAAWS,MAAMC,GAEjB,KAIJ,6BACFe,GADL,IAEEnB,KAAMA,WAIV2J,EAAQgB,GACRf,EAAWiB,GACXf,GAAQiB,QA9CNrB,GAAgB,KAgDjB,CAAC5J,IAEJ,IAAO5G,GAAUqF,KAAVrF,OAEP9B,qBAAU,WACR8B,GAAOwE,GAAG,aAAa,YAAiB,IAAfyH,EAAc,EAAdA,KAAMzO,EAAQ,EAARA,GAC7BuU,GAAS9F,EAAMzO,MAGjBwC,GAAOwE,GAAG,kBAAkB,YAAgB,IAAdwN,EAAa,EAAbA,QAC5B3B,EAAoB2B,MAGtBhS,GAAOwE,GAAG,oBAAoB,YAAkC,IAAdwN,EAAa,EAA/BpL,iBAC9ByJ,EAAoB2B,GACpBC,GAAeD,MAGjBhS,GAAOwE,GAAG,mBAAmB,YAA4B,IAAZ0N,EAAW,EAAzBxG,aAC7ByG,GAAcD,MAGhBE,OACC,IAEH,IAwBM3D,GAAY,SAACtI,GACjBoI,GAAcpI,EAAM3H,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GAEjC,OADAA,EAAEkF,cAAe,EACVlF,UAIL4L,GAAW,SAACvC,EAAMzO,GACtBwC,GAAOyD,KAAK,kBAAmB,CAACpD,OAAM4L,OAAMzO,QAGxCuU,GAAW,SAAC9F,EAAMzO,GACtB,IAAM2I,EAAQ8K,GAAS1L,QACjB8M,EAASjB,GAAiB7L,QAC1B+M,EAAQ,IAAI9L,GAAWC,EAAMC,GACnC,EAAyB4L,EAAMC,mBAAmBpM,EAAO8F,EAAMzO,GAA/D,mBAAOsQ,EAAP,KAAgBC,EAAhB,KACMyE,EAAUF,EAAMG,WAAWtM,EAAO8F,EAAMzO,IAxCpB,SAACyO,GACvBA,EAAKpF,SAAWL,GAAWe,QAAQM,OACjCoE,EAAK/H,QAAUsC,GAAWY,OAAOC,MACnC0I,GAAkB,GAElBC,GAAkB,IAGlB/D,EAAKpF,SAAWL,GAAWe,QAAQE,MAAmB,MAAXwE,EAAK5I,IAC9C4I,EAAK/H,QAAUsC,GAAWY,OAAOC,MACnC4I,GAAuB,GAEvBC,GAAuB,IAGvBjE,EAAKpF,SAAWL,GAAWe,QAAQE,MAAmB,MAAXwE,EAAK5I,IAC9C4I,EAAK/H,QAAUsC,GAAWY,OAAOC,MACnC8I,GAAsB,GAEtBC,GAAsB,IAsB1BsC,CAAoBzG,GACpB,IAAM0G,EAAYL,EAAMM,eAAezM,EAAO8F,EAAMzO,GACpDsT,GAAiB,GAAD,oBAAKuB,GAAL,CAAa,CAC3BpG,OACAzO,KACAqJ,OAAQoF,EAAKpF,OACb8L,YACA7E,UACAC,QACA8E,WAAY/E,EACZgF,cAAeH,MAEjBlE,GAAUtI,GACV4M,GAAiB9G,EAAMzO,EAAIsQ,EAASC,EAAO4E,EAAWxM,EAAOqM,GAC7DlC,EAAerE,EAAK/H,QAAUsC,GAAWY,OAAOE,QAG5CyL,GAAmB,SAAC9G,EAAMzO,EAAIsQ,EAASC,EAAO4E,EAAWxM,EAAOqM,GACpE,IAAMR,EAAUV,GAAoB/L,QAC9ByN,EAAWR,EAAUhM,GAAWe,QAAQK,MAAQqE,EAAKpF,OACrDQ,EAAQb,GAAWY,OAAOC,MAC1BC,EAAQd,GAAWY,OAAOE,MAC1BJ,EAAKV,GAAWS,MAAMC,GACtBC,EAAWX,GAAWS,MAAME,SAElCoH,GAAcpI,EAAM3H,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GACjC,GAAIA,EAAES,IAAM4I,EAAK5I,GAAKT,EAAEW,IAAM0I,EAAK1I,EAAG,OAAO,6BAAIX,GAAX,IAAciE,OAAQ,KAAMC,KAAM,KAAM5C,MAAO,OACrF,GAAItB,EAAES,IAAM7F,EAAG6F,GAAKT,EAAEW,IAAM/F,EAAG+F,EAAG,CAChC,IAAIW,EAAQ+H,EAAK/H,MACb4C,EAAQ5C,IAAUmD,GAAS2K,GAAa9N,IAAUoD,IAAU0K,EAAW9K,EAAKC,EAChF,OAAO,6BAAIvE,GAAX,IAAciE,OAAQmM,EAAUlM,KAAMA,EAAM5C,MAAO+H,EAAK/H,QAE1D,GAAI4J,GAAWlL,EAAES,IAAMyK,EAAQzK,GAAKT,EAAEW,IAAMuK,EAAQvK,EAAG,OAAO,6BAAIX,GAAX,IAAciE,OAAQ,KAAMC,KAAM,KAAM5C,MAAO,OACtG,GAAI6J,GAASnL,EAAES,IAAM0K,EAAM1K,GAAKT,EAAEW,IAAMwK,EAAMxK,EAAE,CAC9C,IAAIW,EAAQ4J,EAAQ5J,MAChB4C,EAAQ5C,IAAUmD,GAAS2K,GAAa9N,IAAUoD,IAAU0K,EAAW9K,EAAKC,EAChF,OAAO,6BAAIvE,GAAX,IAAciE,OAAQiH,EAAQjH,OAAQC,KAAMA,EAAM5C,MAAO4J,EAAQ5J,QAEnE,OAAIyO,GAAa/P,EAAES,IAAMsP,EAAUtP,GAAKT,EAAEW,IAAMoP,EAAUpP,EACjD,6BAAIX,GAAX,IAAciE,OAAQ,KAAMC,KAAM,KAAM5C,MAAO,OAE1CtB,UAILwP,GAAe,WACnBpS,GAAOyD,KAAK,iBAAkB,CAACpD,OAAMuG,sBAGjCqL,GAAiB,SAACD,GACtB,IAAIP,EACAE,EACAK,GACFP,EAAU,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAChCE,EAAa,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,OAEjDF,EAAU,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAGC,UACnCC,EAAa,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAKD,WAExD,IAAMG,EAAUJ,EAAQjT,KAAI,SAAAoE,GAAC,OAAI+O,EAAWnT,KAAI,SAAA0J,GAAC,gBAAOA,GAAP,OAAWtF,SAE5D2L,GAAcsD,EAAQrT,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GACnC,OAAO,IAAI4D,GAAWiL,EAASE,GAAYhL,wBAAwB/D,EAAGoP,UAExE1B,GAAe,IAaX6B,GAAgB,SAACD,GACrB,IAAM/L,EAAQ8K,GAAS1L,QACjB8M,EAASjB,GAAiB7L,QAC1B0N,EAAU5B,GAAkB9L,QAC5B8B,EAAQb,GAAWY,OAAOC,MAC1BC,EAAQd,GAAWY,OAAOE,MAC1BJ,EAAKV,GAAWS,MAAMC,GACtBC,EAAWX,GAAWS,MAAME,SAE9B+K,EAAMW,WACJX,EAAMpE,QAAQ5J,QAAUmD,EAC1B0I,GAAkB,GAElBC,GAAkB,GAEI,MAApBkC,EAAMpE,QAAQzK,EACZ6O,EAAMpE,QAAQ5J,QAAUmD,EAC1B4I,GAAuB,GAEvBC,GAAuB,GAGrBgC,EAAMpE,QAAQ5J,QAAUmD,EAC1B8I,GAAsB,GAEtBC,GAAsB,IAK5B7B,GAAcpI,EAAM3H,KAAI,SAAAgK,GAAC,OAAIA,EAAEhK,KAAI,SAAAoE,GACjC,GAAIA,EAAES,IAAM6O,EAAMjG,KAAK5I,GAAKT,EAAEW,IAAM2O,EAAMjG,KAAK1I,EAAG,CAChD,IAAIW,EAAQgO,EAAMjG,KAAK/H,MACnB4C,EAAQ5C,IAAUmD,GAAST,GAAsB1C,IAAUoD,IAAUV,EAAoBM,EAAKC,EAElG,OADAL,EAAO5C,EAAQ4C,EAAO,KACf,6BAAIlE,GAAX,IAAciE,OAAQqL,EAAMjG,KAAKpF,OAAQC,KAAMA,EAAM5C,MAAOgO,EAAMjG,KAAK/H,QAEzE,GAAItB,EAAES,IAAM6O,EAAM1U,GAAG6F,GAAKT,EAAEW,IAAM2O,EAAM1U,GAAG+F,EAAG,CAC5C,IAAIW,EAAQgO,EAAM1U,GAAG0G,MACjB4C,EAAQ5C,IAAUmD,GAAST,GAAsB1C,IAAUoD,IAAUV,EAAoBM,EAAKC,EAElG,OADAL,EAAO5C,EAAQ4C,EAAO,KACf,6BAAIlE,GAAX,IAAciE,OAAQqL,EAAM1U,GAAGqJ,OAAQC,KAAMA,EAAM5C,MAAOgO,EAAM1U,GAAG0G,QAErE,GAAIgO,EAAMW,UAAYjQ,EAAES,IAAM6O,EAAMpE,QAAQzK,GAAKT,EAAEW,IAAM2O,EAAMpE,QAAQvK,EAAG,CACxE,IAAIW,EAAQgO,EAAMpE,QAAQ5J,MACtB4C,EAAQ5C,IAAUmD,GAAST,GAAsB1C,IAAUoD,IAAUV,EAAoBM,EAAKC,EAElG,OADAL,EAAO5C,EAAQ4C,EAAO,KACf,6BAAIlE,GAAX,IAAciE,OAAQqL,EAAMpE,QAAQjH,OAAQC,KAAMA,EAAM5C,MAAOgO,EAAMpE,QAAQ5J,QAE/E,GAAIgO,EAAMW,UAAYjQ,EAAES,IAAM6O,EAAMnE,MAAM1K,GAAKT,EAAEW,IAAM2O,EAAMnE,MAAMxK,EAAG,CACpE,IAAIW,EAAQgO,EAAMnE,MAAM7J,MACpB4C,EAAQ5C,IAAUmD,GAAST,GAAsB1C,IAAUoD,IAAUV,EAAoBM,EAAKC,EAElG,OADAL,EAAO5C,EAAQ4C,EAAO,KACf,6BAAIlE,GAAX,IAAciE,OAAQqL,EAAMnE,MAAMlH,OAAQC,KAAMA,EAAM5C,MAAOgO,EAAMnE,MAAM7J,QAE3E,GAAIgO,EAAMY,aAAelQ,EAAES,IAAM6O,EAAMS,UAAUtP,GAAKT,EAAEW,IAAM2O,EAAMS,UAAUpP,EAAG,CAC/E,IAAIW,EAAQgO,EAAMS,UAAUzO,MACxB4C,EAAQ5C,IAAUmD,GAAST,GAAsB1C,IAAUoD,IAAUV,EAAoBM,EAAKC,EAElG,OADAL,EAAO5C,EAAQ4C,EAAO,KACf,6BAAIlE,GAAX,IAAciE,OAAQqL,EAAMS,UAAU9L,OAAQC,KAAMA,EAAM5C,MAAOgO,EAAMS,UAAUzO,QAEnF,OAAOtB,SAGT0N,EAAe4B,EAAMjG,KAAK/H,QAAUsC,GAAWY,OAAOC,OACtDyJ,GAAiBuB,EAAOa,MAAM,GAAI,IAClClC,GAAkB,GAAD,oBAAKiC,GAAL,CAAcf,MAoBjC,OACE,yBAAKjY,UAAS,sBAAkBsM,EAAqB,GAAX,WACvCjF,GAAY,yBAAKrH,UAAW,iBAC3B,yBAAKA,UAAW,eAAgBkZ,MAAM,0DAAa9Y,QAAS,kBAAM+X,OAAgB,kBAAC,KAAD,CAChFgB,KAAMC,QACR,yBAAKpZ,UAAW,eAAgBkZ,MAAM,8FAAmB9Y,QAAS,WApGtE2F,GAAOyD,KAAK,eAAgB,CAACpD,OAAMuG,kBAAmBA,MAoGqC,kBAAC,KAAD,CACrFwM,KAAME,QACR,yBAAKrZ,UAAW,eAAgBkZ,MAAM,mIAA0B9Y,QAAS,kBAnG1D,WACnB,GAA6B,IAAzBwW,GAActS,OAAlB,CACA,IAAMmN,EAAemF,GAAcA,GAActS,OAAS,GAC1DyB,GAAOyD,KAAK,iBAAkB,CAACpD,OAAMqL,eAAcvF,MAAO6B,GAAY6I,iBAAeE,qBAgGFwC,KAAgB,kBAAC,KAAD,CAC7FH,KAAMI,QACR,yBAAKvZ,UAAW,eAAgBkZ,MAAM,yIAA2B9Y,QAAS,kBA1BzD,WACrB,GAA8B,IAA1B0W,GAAexS,OAAnB,CACA,IAAM+T,EAAQ,IAAI9L,GAAWC,EAAMC,GAC7BgF,EAAeqF,GAAeA,GAAexS,OAAS,GAEtDyP,EAAQtH,EAAQiD,QAAQ+B,EAAaO,KAAK5I,GAC1CoQ,EAAQhN,EAAKkD,QAAQC,OAAO8B,EAAaO,KAAK1I,IAC9C2K,EAAMxH,EAAQiD,QAAQ+B,EAAalO,GAAG6F,GACtC4K,EAAMxH,EAAKkD,QAAQC,OAAO8B,EAAalO,GAAG+F,IAE1CmQ,EAAWpB,EAAMhJ,QAAQtB,GAAYyL,EAAOzF,GAC5C2F,EAASrB,EAAMhJ,QAAQtB,GAAYiG,EAAKC,GAE9CM,GAASkF,EAAUC,GACnB3C,GAAkBD,GAAemC,MAAM,GAAI,KAYyCU,KAC9E,kBAAC,KAAD,CAAiBR,KAAMS,SAG3B,kBAAC,GAAD,CACE7L,WAAYA,GACZuG,cAAeA,GACfC,SAAUA,GACVC,UAAWA,GACXhI,KAAMA,EACNC,QAASA,EACTE,iBAAkBA,EAClB8H,YAAaA,EACbhD,aAAcmF,GAActS,OAAS,EAAIsS,GAAcA,GAActS,OAAS,GAAK,GACnFoQ,YAAa,CACXC,iBACAC,iBACAC,sBACAC,sBACAC,qBACAC,0BC3QK6E,GAvFA,SAAC,GAAqF,IAApFzT,EAAmF,EAAnFA,KAAMsP,EAA6E,EAA7EA,IAAKoE,EAAwE,EAAxEA,cAAeC,EAAyD,EAAzDA,UAAWhS,EAA8C,EAA9CA,WAAYC,EAAkC,EAAlCA,UAAWC,EAAuB,EAAvBA,UAAWnC,EAAY,EAAZA,OAC/EC,EAAUqF,KAAVrF,OACAnH,EAAWD,IAAXC,QACP,EAA0BQ,mBAAS,SAAnC,mBAAO4L,EAAP,KAAcgP,EAAd,KAEA,EAA4B5a,mBAAS,SAArC,mBAAO6L,EAAP,KAAegP,EAAf,KAEMC,EAAmBhD,IAAMiD,YA+B/B,OAEE,yBAAKna,UAAW,oBAAqBgH,IAAKkT,GAExC,yBAAKla,UAAS,wBAAmB0V,EAAM,GAAK,WAE1C,yBAAK1V,UAAW,YAAayF,IAAKiQ,EAAK/P,IAAI,2LAAqCyU,OAnCpE,SAAC,GAAmB,IAAV1E,EAAS,EAAjBvS,OACZkX,EAAYH,EAAiB5O,QAAQ9C,aACrC8R,EAAWJ,EAAiB5O,QAAQ/C,YACpCgS,EAAUC,OAAOC,WAAa,KAAO,MAAQ,OAC7CC,EAAgBJ,EAAWD,EAC3BM,EAAkBjF,EAAI1K,MAAQ0K,EAAIzK,OAEpC2P,EAAa,EAEblF,EAAIzK,OAASoP,GAAa3E,EAAI1K,MAAQsP,EACpCI,GAAiBC,GACnBC,EAAalF,EAAIzK,OAASyK,EAAI1K,MAE9BiP,EAAU,QAAD,OAASI,EAAT,gBAA0BE,EAA1B,MACTP,EAAS,SAAD,OAAUK,EAAV,gBAA2BE,EAA3B,eAAyCK,EAAzC,QAERA,EAAalF,EAAI1K,MAAQ0K,EAAIzK,OAE7B+O,EAAS,QAAD,OAASM,EAAT,gBAAyBC,EAAzB,MACRN,EAAU,SAAD,OAAUK,EAAV,gBAA0BC,EAA1B,eAAwCK,EAAxC,QAGXZ,EAAStE,EAAI1K,OACbiP,EAAUvE,EAAIzK,SAEhB,IAAMjM,EAAOJ,IACbmH,EAAOyD,KAAK,eAAgB,CAACtH,MAAOlD,EAAKkD,WAWrC,yBAAKhC,GAAG,aAAaF,UAAW,SAC3B6a,MAAO,CACLC,gBAAiBpF,EAAG,cAAUA,EAAV,KAAmB,OACvC1K,MAAOA,EACPC,OAAQA,IAGb,kBAAC,GAAD,CAAaqB,QAASyN,EAAW3T,KAAMA,IACvC,kBAAC,GAAD,CAAiBkG,QAASwN,EAAe1T,KAAMA,IAG/C,kBAAC,IAAD,CACEmB,OAAQA,GACRxB,OAAQA,EACRK,KAAMA,EAEN4E,MAAO+P,SAAS/P,GAChBC,OAAQ8P,SAAS9P,GAEjBnF,OAAQA,EACRiC,WAAYA,EACZC,UAAWA,EACXC,UAAWA,QC/CR+S,I,OA3BA,SAAC,GAAwD,IAAvDC,EAAsD,EAAtDA,SAAUC,EAA4C,EAA5CA,SAAUpb,EAAkC,EAAlCA,SAAUqb,EAAwB,EAAxBA,SAAUC,EAAc,EAAdA,SACjDC,EAAe,SAACtb,GACpBD,EAASC,EAAUqb,EAAWD,IAGhC,OACE,yBAAKnb,UAAU,UACC,KAAbib,EAAkB,yBAAKjb,UAAU,SAASib,GAAkB,GAE7D,2BAAOjb,UAAU,kBACf,2BAAOC,KAAK,WAAWH,SAAU,SAAAO,GAAC,OAAIgb,EAAahb,EAAE8C,OAAOpD,YAC5D,0BAAMC,UAAU,aAGJ,KAAbkb,EAAkB,yBAAKlb,UAAU,SAASkb,GAAkB,MCkBpDI,I,OA/BM,SAAC,GAA0D,IAAzDC,EAAwD,EAAxDA,aAAcC,EAA0C,EAA1CA,OAAQC,EAAkC,EAAlCA,WAAYC,EAAsB,EAAtBA,iBACjDC,EAAUH,EAAOI,MAAK,SAACjT,GAAD,OAAOA,EAAE8S,KAAgBF,KAErD,EAAoCnc,mBAASuc,GAA7C,mBAAOE,EAAP,KAAmBC,EAAnB,KACA,OAEE,yBAAK9b,UAAW,yBACd,yBAAKA,UAAW,yBAEbwb,EAAOjX,KAAI,SAAAoE,GAAC,OACX,yBAAKvI,QACH,WACEsb,EAAiB/S,EAAE8S,IACnBK,EAAcnT,IAEhB3I,UAAS,yBAAoB6b,EAAWhc,QAAU8I,EAAE9I,MAAQ,SAAW,IAAM2E,IAAKmE,EAAE8S,IACpF,0BAAMzb,UAAS,qBAAgB2I,EAAE8S,cCkB9BM,I,OAlCW,SAAC,GAA+B,IAA9B9R,EAA6B,EAA7BA,MAAOyR,EAAsB,EAAtBA,iBACjC,EAAsCtc,mBAAS6K,GAA/C,mBAAO+R,EAAP,KAAoBC,EAApB,KAQA,OAEE,yBAAKjc,UAAW,+BACd,yBAAKA,UAAW,yBAVP,CACX,MACA,OACA,SACA,SAQYuE,KAAI,SAAAoE,GAAC,OACX,yBAAKvI,QACH,WACEsb,EAAiB/S,GACjBsT,EAAetT,IAEjB3I,UAAS,yBAAoBgc,IAAgBrT,EAAI,SAAW,IAAMnE,IAAKmE,GACvE,0BAAM3I,UAAS,iBAAY2I,aCuGxBuT,GApHG,SAAC,GAAiF,IAAhFnU,EAA+E,EAA/EA,WAAYoU,EAAmE,EAAnEA,cAAeC,EAAoD,EAApDA,SAAUC,EAA0C,EAA1CA,aAAcC,EAA4B,EAA5BA,SAAUC,EAAkB,EAAlBA,aAExExW,EAAUqF,KAAVrF,OAEP,EAAwCpH,IAAjCK,KAAaqI,EAApB,EAAcpH,KAAgBiC,EAA9B,EAA8BA,MAExBsa,EAAmC,YAAbnV,EAG5B,EAAwCjI,oBAAS,GAAjD,mBAAOqd,EAAP,KAAqBC,EAArB,KACA,EAA4Btd,mBAAS,GAArC,mBAAOud,EAAP,KAAeC,EAAf,KACA,EAA4Bxd,mBAAS,GAArC,mBAAOyd,EAAP,KAAeC,EAAf,KAyBA,OC/CsB,SAACC,EAAUC,GACjC,IAAMC,EAAgBhG,iBAAO8F,GAG7B9Y,qBAAU,WACRgZ,EAAc3R,QAAUyR,IACvB,CAACA,IAGJ9Y,qBAAU,WAER,GAAc,OAAV+Y,EAAJ,CAIA,IAAM9c,EAAKgd,aAAY,kBAAMD,EAAc3R,YAAW0R,GAEtD,OAAO,kBAAMG,cAAcjd,OAC1B,CAAC8c,IDoBJI,EAAS,WACHP,EAAS,GACXC,EAAUD,EAAS,IAEnBC,EAAU,GACVF,EAAUD,EAAS,MAEpBF,EAAe,IAAO,MAIvB,yBAAKzc,UAAW,cACd,kBAAC,GAAD,CACEub,aAAca,EACdX,WAAY,QACZ4B,WAAY,QACZ7B,OAAQ,CACN,CAAC7b,MAAO,MAAOE,MAAO,GACtB,CAACF,MAAO,MAAOE,MAAO,GACtB,CAACF,MAAO,MAAOE,MAAO,IAExB6b,iBACE,SAAA1Q,GACEqR,EAAarR,MAKnB,yBAAKhL,UAAW,uBAChB,kBAAC,GAAD,CACEiK,MAAOqS,EACPZ,iBACE,SAAAzR,GACEsS,EAAatS,MAKnB,yBAAKjK,UAAW,uBAEhB,yBAAKA,UAAW,iBACd,yBAAKA,UAAS,yBAAoB+H,IAAeT,EAAe,SAAW,IAAMlH,QAAS,WACxF+b,EAAc7U,KACb,kBAAC,IAAD,OAEH,yBAAKtH,UAAS,yBAAoB+H,IAAeT,EAAe,SAAW,IAAMlH,QAAS,WACxF+b,EAAc7U,KACb,kBAAC,IAAD,OAEFkV,GACD,yBAAKxc,UAAS,yBAAoB+H,IAAeT,EAAe,SAAW,IAAMlH,QAAS,WACxF+b,EAAc7U,KACb,kBAAC,IAAD,OAEFkV,GAAuB,yBAAKxc,UAAW,iBAAkBI,QAAS,WACjEsc,GAAiBD,KAChB,kBAAC,IAAD,OAEFD,GACD,yBAAKxc,UAAW,eACd,0BAAMA,UAAW,UAAW2c,EAAS,GAAK,IAAMA,EAASA,GACzD,0BAAM3c,UAAW,SAAjB,KACA,0BAAMA,UAAW,WAAY6c,EAAS,GAAK,IAAMA,EAASA,IAE3DL,GAAuB,yBAAKxc,UAAW,eAAgBI,QAAS,WA7ErE0c,EAAU,GACVF,EAAU,GACVF,GAAgB,KA6ET,kBAAC,IAAD,OAGFF,GAAuB,kBAAC,GAAD,CAAQvB,SAAS,GAAGC,SAAS,GAAGC,UAAU,EAAMC,UAAU,EAClDtb,SAAU,SAACD,GAAD,OA9Efyd,EA8EkDzd,OA7EjFkG,EAAOyD,KAAK,sBAAuB,CAACtH,QAAOob,cADb,IAACA,KAgF1Bd,GACD,yBAAKxc,UAAW,iBAAkBI,QAAS,WA5E/C2F,EAAOyD,KAAK,eAAgB,CAAC+T,aAAcrb,MA4EgC,kBAAC,IAAD,UE5GzEsb,GAAiBtX,wBAAc,ICA/BuX,GAAiBvX,wBAAc,ICsDtBwX,I,OA5CI,SAAC,GAAyB,IAAxBtX,EAAuB,EAAvBA,KAAMuX,EAAiB,EAAjBA,YACLtW,EAAa1I,IAA1BK,KAAOiB,KACA2d,EAAuBvX,qBAAWmX,IAAzCK,MACP,EAA0ExX,qBAAWoX,IAAvEK,EAAd,EAAOD,MAA2CE,EAAlD,EAAmCC,cAEnC,EAA4D,YAAb3W,EAAyBuW,EAAsBE,EAAtFpI,EAAR,EAAQA,IAAKtO,EAAb,EAAaA,IAAK0S,EAAlB,EAAkBA,cAAeC,EAAjC,EAAiCA,UAC3BiE,EAA6B,YAAb3W,GAAgC0W,EAEtD,EAAkC3e,mBAAS,GAA3C,mBAAO4I,EAAP,KAAkBqU,EAAlB,KACA,EAAkCjd,mBAAS,OAA3C,mBAAO6I,EAAP,KAAkBsU,EAAlB,KACA,EAAoCnd,mBAASkI,IAA7C,mBAAOS,EAAP,KAAmBoU,EAAnB,KAEA,OACE,yBAAKnc,UAAW,eACd,kBAAC,EAAD,CAASoH,IAAKA,IAEd,kBAAC,GAAD,CACEhB,KAAMA,EACNsP,IAAKA,EACLoE,cAAeA,EACfC,UAAWA,EACXjU,OAAQ6X,GAAeK,EACvBjW,WAAYA,EACZC,UAAWA,EACXC,UAAWA,IAGb,kBAAC,GAAD,CACEF,WAAYA,EACZoU,cAAeA,EACfC,SAAUpU,EACVqU,aAAcA,EACdC,SAAUrU,EACVsU,aAAcA,OCrBP0B,I,OAtBG,SAAC,GAAkD,IAAjDC,EAAgD,EAAhDA,kBAAmBC,EAA6B,EAA7BA,QAASC,EAAoB,EAApBA,eAE9C,OACE,yBAAKpe,UAAW,gBACd,yBAAKA,UAAS,eAAUme,EAAQjc,QAAUkc,EAAiB,UAAY,KAErE,yBAAKpe,UAAW,QACbme,EAAQve,MAGX,yBAAKI,UAAW,SAAUI,QAAS,kBAAM8d,EAAkBC,EAAQjc,SAAnE,8DCeOmc,GA1BO,SAAC,GAAkE,IAAjEC,EAAgE,EAAhEA,KAAMC,EAA0D,EAA1DA,QAASC,EAAiD,EAAjDA,SAAUN,EAAuC,EAAvCA,kBAAmBE,EAAoB,EAApBA,eAElE,OACE,yBAAKpe,UAAS,qCAAgCse,EAAO,OAAS,KAC5D,yBAAKte,UAAW,eACd,yBAAKA,UAAW,iBAAkBI,QAAS,kBAAMme,GAAQ,MAEzD,yBAAKve,UAAW,yBACbwe,EAASja,KAAI,SAAA4Z,GAAO,OAAI,kBAAC,GAAD,CAAa3Z,IAAK2Z,EAAQ1Z,IAAKyZ,kBAAmBA,EACrCC,QAASA,EAASC,eAAgBA,WCGnEK,GAbG,SAAC,GAAuB,IAAtBC,EAAqB,EAArBA,SAAUC,EAAW,EAAXA,MAC5B,OACE,yBAAK3e,UAAW,eAAgBI,QAASse,GACvC,yBAAK1e,UAAW,QAAS2e,EAAM/e,QCmBtBgf,GArBK,SAAC,GAAuC,IAAtCN,EAAqC,EAArCA,KAAMC,EAA+B,EAA/BA,QAASM,EAAsB,EAAtBA,OAAQH,EAAc,EAAdA,SAC3C,OACE,yBAAK1e,UAAS,mCAA8Bse,EAAO,OAAS,KAC1D,yBAAKte,UAAS,eACZ,yBAAKA,UAAW,iBAAkBI,QAAS,kBAAMme,GAAQ,MAEzD,yBAAKve,UAAW,uBACb6e,EAAOta,KAAI,SAAAoa,GAAK,OAAI,kBAAC,GAAD,CAAWna,IAAKma,EAAMla,IAAKia,SAAU,kBAAMA,EAASC,IAAQA,MAAOA,WCKnFG,GAbI,SAAC,GAAyB,IAAxBC,EAAuB,EAAvBA,UAAWC,EAAY,EAAZA,OAC9B,OACE,yBAAKhf,UAAW,eAAgBI,QAAS2e,GACvC,yBAAK/e,UAAW,QAASgf,EAAOpf,QCmBvBqf,GArBM,SAAC,GAAyC,IAAxCX,EAAuC,EAAvCA,KAAMC,EAAiC,EAAjCA,QAASW,EAAwB,EAAxBA,QAASH,EAAe,EAAfA,UAC7C,OACE,yBAAK/e,UAAS,oCAA+Bse,EAAO,OAAS,KAC3D,yBAAKte,UAAS,eACZ,yBAAKA,UAAW,iBAAkBI,QAAS,kBAAMme,GAAQ,MAEzD,yBAAKve,UAAW,uBACbkf,GAAWA,EAAQ3a,KAAI,SAAAya,GAAM,OAAI,kBAAC,GAAD,CAAYxa,IAAKwa,EAAOva,IAAKsa,UAAW,kBAAMA,EAAUC,IAASA,OAAQA,WCUtGf,GAlBG,SAAC,GAAuB,IAAtBkB,EAAqB,EAArBA,SAAUtB,EAAW,EAAXA,MAE5B,OACE,yBAAK7d,UAAS,6BAAwB6d,EAAMnI,IAAM,GAAK,SAAWtV,QAAS+e,GACzE,yBAAKnf,UAAW,eAEb6d,EAAMnI,IAAM,yBAAKjQ,IAAKoY,EAAMnI,IAAK/P,IAAI,mCAAY,yBAAK3F,UAAW,WAAhB,uICgB3Cof,GArBK,SAAC,GAAuC,IAAtCd,EAAqC,EAArCA,KAAMC,EAA+B,EAA/BA,QAASc,EAAsB,EAAtBA,OAAQF,EAAc,EAAdA,SAC3C,OACE,yBAAKnf,UAAS,mCAA8Bse,EAAO,OAAS,KAC1D,yBAAKte,UAAS,eACZ,yBAAKA,UAAW,wBAAyBI,QAAS,kBAAMme,GAAQ,MAEhE,yBAAKve,UAAW,uBACbqf,GAAUA,EAAO9a,KAAI,SAAAsZ,GAAK,OAAI,kBAAC,GAAD,CAAWrZ,IAAKqZ,EAAMpZ,IAAK0a,SAAU,kBAAMA,EAAStB,IAAQA,MAAOA,WCgL7FyB,I,OAjKG,SAAC,GAAc,IAAb3b,EAAY,EAAZA,OACXE,EAAW0b,cAAX1b,QACAkC,EAAUqF,KAAVrF,OACA/G,EAAQL,IAARK,KAEAof,EAAkB/X,qBAAWmX,IAA7BY,eACP,EAA8C/X,qBAAWoX,IAAlD+B,EAAP,EAAOA,cAAeC,EAAtB,EAAsBA,qBAEtB,EAA4BrgB,mBAAS,IAArC,mBAAO4f,EAAP,KAAeD,EAAf,KACA,EAA0B3f,mBAAS,IAAnC,mBAAOuf,EAAP,KAAcD,EAAd,KAEA,EAAgCtf,mBAAS,IAAzC,mBAAOof,EAAP,KAAiBkB,EAAjB,KACA,EAA4BtgB,mBAAS,IAArC,mBAAOyf,EAAP,KAAec,EAAf,KACA,EAA8BvgB,mBAAS,IAAvC,mBAAO8f,EAAP,KAAgBU,EAAhB,KACA,EAA4BxgB,mBAAS,IAArC,mBAAOigB,EAAP,KAAeQ,EAAf,KAEA,EAA8CzgB,oBAAS,GAAvD,mBAAO0gB,EAAP,KAAwBC,EAAxB,KACA,EAAgD3gB,oBAAS,GAAzD,mBAAO4gB,EAAP,KAAyBC,EAAzB,KACA,EAA8C7gB,oBAAS,GAAvD,mBAAO8gB,GAAP,KAAwBC,GAAxB,KAEA,GAAkD/gB,oBAAS,GAA3D,qBAAOghB,GAAP,MAA0BC,GAA1B,MAEApc,qBAAU,YACS,uCAAG,4BAAA1C,EAAA,yDACA,YAAdvC,EAAKiB,KADS,gCAEEO,EAAIiB,KAAK,wBAAyB,CAAC8b,aAAcve,EAAKkD,QAFxD,OAEVjB,EAFU,OAGhBye,EAAYze,EAAIS,KAAK8c,UAHL,2CAAH,qDAMjB8B,GAAclc,OAAM,SAAClD,GAAD,OAAS0B,QAAQyB,MAAMnD,QAE1C,CAAClC,IAEJiF,qBAAU,YACQ,uCAAG,4BAAA1C,EAAA,yDACC,YAAdvC,EAAKiB,KADQ,gCAEGO,EAAIiB,KAAK,oBAAqB,CAACS,MAAOlD,EAAKkD,QAF9C,OAETjB,EAFS,OAGf0e,EAAU1e,EAAIS,KAAKmd,QAHJ,2CAAH,qDAMhB0B,GAAanc,OAAM,SAAClD,GAAD,OAAS0B,QAAQyB,MAAMnD,QAEzC,CAAClC,IAEJiF,qBAAU,YACO,uCAAG,4BAAA1C,EAAA,yDACE,YAAdvC,EAAKiB,OAAsB0e,EAAMla,IADrB,gCAEIjE,EAAIiB,KAAK,qBAAsB,CAACkd,MAAOA,EAAMla,MAFjD,OAERxD,EAFQ,OAGd2e,EAAW3e,EAAIS,KAAKwd,SAHN,2CAAH,qDAMfsB,GAAYpc,OAAM,SAAClD,GAAD,OAAS0B,QAAQyB,MAAMnD,QAExC,CAACyd,IAEJ1a,qBAAU,YACO,uCAAG,4BAAA1C,EAAA,yDACE,YAAdvC,EAAKiB,OAAsB+e,EAAOva,IADtB,gCAEIjE,EAAIiB,KAAK,oBAAqB,CAACud,OAAQA,EAAOva,MAFlD,OAERxD,EAFQ,OAGd4e,EAAU5e,EAAIS,KAAK2d,QAHL,2CAAH,qDAMfoB,GAAYrc,OAAM,SAAClD,GAAD,OAAS0B,QAAQyB,MAAMnD,QAExC,CAAC8d,IAEJ/a,qBAAU,WACU,YAAdjF,EAAKiB,KAAoB8F,EAAOyD,KAAK,eAAgB,CAACpD,KAAMvC,EAAS3B,MAAOlD,EAAKkD,QAC9D,YAAdlD,EAAKiB,MAAoB8F,EAAOyD,KAAK,eAAgB,CAACpD,KAAMvC,EAAS3B,MAAOlD,EAAKkD,UACzF,CAAClD,EAAM+G,EAAQlC,IAuBlB,OACE,yBAAK7D,UAAW,cACd,kBAAC,EAAD,CAAe6F,QAAS4Z,EAAsB3Z,OAAQ0Z,IACtD,kBAAC,EAAD,CAAQ7b,OAAQA,IAChB,yBAAK3D,UAAW,qCAEd,6BAASA,UAAW,sBAClB,kBAAC,EAAD,CAAWoG,KAAMvC,IAEjB,kBAAC,GAAD,CACEuC,KAAMvC,EACN8Z,aAAcqC,IAAqBE,KAAoBE,KAG1C,YAAdphB,EAAKiB,KACJ,kBAAC,GAAD,CAAaqe,KAAMwB,EACRvB,QAASwB,EACTV,OAAQA,EACRF,SAvBD,SAACtf,GACnBkG,EAAOyD,KAAK,sBAAuB,CAAC+T,aAAc1Z,EAASga,MAAOhe,OAsBpB,GAGzB,YAAdb,EAAKiB,KACJ,yBAAKD,UAAW,WAGd,kBAAC,GAAD,CAAcse,KAAM0B,EACNzB,QAAS0B,EACTf,QAASA,EACTH,UAvCL,SAAC2B,GACpB3B,EAAU2B,GACVT,GAAoB,GACpBF,GAAmB,MAsCT,kBAAC,GAAD,CAAazB,KAAM4B,GACN3B,QAAS4B,GACTtB,OAAQA,EACRH,SAlDL,SAACiC,GACnBjC,EAASiC,GACTR,IAAmB,GACnBF,GAAoB,MAkDV,kBAAC,GAAD,CAAe3B,KAAM8B,GACN7B,QAAS8B,GACT7B,SAAUA,EACVN,kBA5DL,SAACre,GACrBkG,EAAOyD,KAAK,gBAAiB,CAAC+T,aAAc1Z,EAASK,aAAcrE,KA4D1Cue,eAAgBA,IAE/B,yBAAKpe,UAAW,kBAEZogB,IAAqB,yBAAKpgB,UAAW,wBACrC,yBAAKA,UAAW,SAAUI,QAAS,kBAAM+f,IAAoBD,MAA7D,0CAGAF,GAAoB,yBAAKhgB,UAAW,0BACpC,yBAAKA,UAAW,SAAUI,QAAS,kBAAMigB,IAAsBD,MAA/D,iDAMJ,QClGCQ,GAnEO,WACpB,IAAM5e,EAAQC,cACd,EAAqBsd,cAAdvgB,EAAP,EAAOA,KAAMiB,EAAb,EAAaA,KAEb,EAAsCb,qBAAtC,mBAAOyhB,EAAP,KAAoBC,EAApB,KACA,EAAgC1hB,qBAAhC,mBAAOgD,EAAP,KAAiBC,EAAjB,KACA,EAA8CjD,qBAA9C,mBAAO2hB,EAAP,KAAwBC,EAAxB,KAEMze,EAAY,uCAAG,sBAAAhB,EAAA,yDACfa,IAAa2e,EADE,yCAEV/e,EAAMe,KAAK,6GAFD,gCAKXvC,EAAIiB,KAAJ,WAAaxB,EAAb,iBAAkC,CAACiC,MAAOlD,EAAM6hB,cAAaze,aALlD,OAMjBJ,EAAMe,KAAK,wHANM,gDASjB,KAAEhC,SAASW,KAAKC,OAAOmB,SAAQ,SAAA5B,GAC7Bc,EAAMe,KAAK7B,EAAI8B,QAVA,yDAAH,qDAelB,OACE,yBAAKhD,UAAW,UAAWE,GAAI,iBAC7B,yBAAKF,UAAW,gBACd,0BAAMA,UAAU,OAAOiD,SAAU,SAAC5C,GAAD,OAAOkC,EAAalC,KACnD,yBAAKL,UAAU,gBACb,2BAAG,0BAAMA,UAAU,kBAAiB,0BAAMA,UAAU,YAAhB,WAApC,8EAEF,yBAAKA,UAAW,kBACd,yBAAKA,UAAU,oBACb,2BAAOC,KAAK,WAAWD,UAAU,aAAakD,YAAY,+FAAoBtD,KAAK,cAC5EM,GAAG,cACHJ,SAAU,SAAAO,GAAC,OAAIygB,EAAezgB,EAAE8C,OAAOtD,QAAQuD,UAAQ,IAC9D,2BAAO7C,QAAQ,cAAcP,UAAU,cAAvC,iGAGF,yBAAKA,UAAU,oBACb,2BAAOC,KAAK,WAAWD,UAAU,aAAakD,YAAY,iHAAuBtD,KAAK,WAC/EM,GAAG,WACHJ,SAAU,SAAAO,GAAC,OAAIgC,EAAYhC,EAAE8C,OAAOtD,QAAQuD,UAAQ,IAC3D,2BAAO7C,QAAQ,WAAWP,UAAU,cAApC,mHAGF,yBAAKA,UAAU,oBACb,2BAAOC,KAAK,WAAWD,UAAU,aAAakD,YAAY,kKACnDtD,KAAK,kBACLM,GAAG,kBACHJ,SAAU,SAAAO,GAAC,OAAI2gB,EAAmB3gB,EAAE8C,OAAOtD,QAAQuD,UAAQ,IAClE,2BAAO7C,QAAQ,kBAAkBP,UAAU,cAA3C,oKAGF,yBAAKA,UAAU,sBACb,4BAAQC,KAAK,SAASD,UAAU,MAAME,GAAG,YACvC,qHAKR,kBAAC,EAAD,S,SCmEO+gB,I,cAlHH,WAEVre,QAAQC,IADQqe,KAiBhB,MAAwBviB,IAAjBK,EAAP,EAAOA,KAAMJ,EAAb,EAAaA,QAEb,EAAwBQ,mBAAS,CAACJ,KAAMA,EAAMyD,gBAAiB0e,QAAQniB,GAAQA,EAAKoiB,OAAQ1e,WAAW,IAAvG,mBAAO0C,EAAP,KAAavD,EAAb,KAEM8B,EAAS,WACb9B,EAAQ,CAAC7C,UAAMG,EAAWsD,iBAAiB,EAAOC,WAAW,KAiB/D,OAPA8X,OAAO6G,iBAAiB,SAAS,SAAUhhB,GACzC,IAAMrB,EAAOJ,IACPiH,EAAUxF,EAAEgE,MAAMwB,SAAWxF,EAAEwF,SAAWxF,EAAEgE,MAC5Cid,EAAiBjhB,EAAEgE,MAAMkd,OAAS,GACxC/gB,EAAIiB,KAAK,UAAW,CAAC4C,MAAOwB,EAASyb,eAAgBA,EAAgBtiB,SAAOoF,MAAMxB,QAAQyB,UAI1F,kBAAC,iBAAD,CACEmd,kBAAmB9c,EACnB+c,QAjBmB,SAACphB,EAAGihB,GACzB,IAAMtiB,EAAOJ,IACPiH,EAAUxF,EACVkhB,EAAQD,EAAeA,gBAAkBA,EAC/C9gB,EAAIiB,KAAK,UAAW,CAAC4C,MAAOwB,EAASyb,eAAgBC,EAAOviB,SAAOoF,MAAMxB,QAAQyB,SAe/E,6BAASrE,UAAU,aACjB,kBAAC,IAAD,KACE,kBAAC,IAAD,KAEE,kBAAC,IAAD,CAAO0hB,OAAK,EAACC,KAAK,SACXrc,OAAQ,SAACC,GAAD,OACN,kBAAC,EAAD,iBAAWA,EAAX,CAAkB1D,QAASA,QAInCuD,EAAKpG,MAA2B,YAAnBoG,EAAKpG,KAAKiB,MACtB,kBAAC,EAAD,CAAcyhB,OAAK,EAACC,KAAK,WACXxc,UAAWzB,EACX0B,KAAM,CAAC3C,gBAAiB2C,EAAK3C,gBAAiBC,UAAW0C,EAAK1C,WAC9DiB,OAAQA,IAIvByB,EAAKpG,MAA2B,YAAnBoG,EAAKpG,KAAKiB,MACtB,kBAAC,EAAD,CAAcyhB,OAAK,EAACC,KAAK,WACXxc,UAAWR,EACXS,KAAM,CAAC3C,gBAAiB2C,EAAK3C,gBAAiBC,UAAW0C,EAAK1C,WAC9DiB,OAAQA,IAIvByB,EAAKpG,MAA2B,YAAnBoG,EAAKpG,KAAKiB,MACtB,kBAAC,EAAD,CAAcyhB,OAAK,EAACC,KAAK,iBACXxc,UAAWrB,EACXsB,KAAM,CAAC3C,gBAAiB2C,EAAK3C,gBAAiBC,UAAW0C,EAAK1C,aAI9E,kBAAC,EAAD,CAAcgf,OAAK,EAACC,KAAK,mBACXxc,UAAWma,GACXla,KAAMA,EACNpG,KAAMoG,EAAKpG,KACX2E,OAAQA,IAGtB,kBAAC,EAAD,CAAc+d,OAAK,EAACC,KAAK,8BACXxc,UAAWyb,GACXxb,KAAMA,EACNpG,KAAMoG,EAAKpG,KACX2E,OAAQA,IAGtB,kBAAC,IAAD,CAAOge,KAAK,IAAIrc,OACd,WACE,OAAIF,EAAK3C,gBACgB,YAAnB2C,EAAKpG,KAAKiB,KACL,kBAAC,IAAD,CAAUsD,GAAG,aACQ,YAAnB6B,EAAKpG,KAAKiB,KACZ,kBAAC,IAAD,CAAUsD,GAAG,aAEb,kBAAC,IAAD,CAAUA,GAAG,WAGf,kBAAC,IAAD,CAAUA,GAAG,oBCjHzBqe,GCToB,WAAoB,IAAD,uBAAfC,EAAe,yBAAfA,EAAe,gBAClD,OAAOA,EAAWC,QAChB,SAACC,EAAuBC,GACtB,OAAO,YAAmB,IAAhBC,EAAe,EAAfA,SACR,OACE,kBAACF,EAAD,KACE,kBAACC,EAAD,KAAmBC,QAK3B,gBAAGA,EAAH,EAAGA,SAAH,OAAkB,oCAAGA,ODF0B,WAAjB,EANhB,C/BMW,SAAC,GAAgB,IAAfA,EAAc,EAAdA,SACtBrjB,EAAWD,IAAXC,QAED+H,EAAUsQ,mBACVrQ,EAAYqQ,mBACZiL,EAAgBjL,iBAAO,IAE7B,EAA4B7X,mBAAS,IAArC,mBAAO+iB,EAAP,KAAeC,EAAf,KACA,EAAwChjB,qBAAxC,mBAAOijB,EAAP,KAAqBC,EAArB,KACA,EAA4BljB,qBAA5B,mBAAOmH,EAAP,KAAegc,EAAf,KACA,EAAwCnjB,oBAAS,GAAjD,mBAAOoH,EAAP,KAAqBgc,EAArB,KACA,EAA8BpjB,oBAAS,GAAvC,mBAAOqH,EAAP,KAAgBgc,EAAhB,KACA,EAA0CrjB,oBAAS,GAAnD,mBAAOsH,EAAP,KAAsBgc,EAAtB,KAGA,EAAwCtjB,oBAAS,GAAjD,mBAAOujB,EAAP,KAAqBC,EAArB,KACA,EAAwCxjB,oBAAS,GAAjD,mBAAOyjB,EAAP,KAAqBC,EAArB,KAGA7e,qBAAU,WACR,GAAIuC,EAAc,CAChB,IAAMxH,EAAOJ,IAEbujB,EAAOY,iBAAiBjgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUN,KACzDR,EAAOe,iBAAiBpgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUJ,MAEvC,YAAd7jB,EAAKiB,MAyBgB,YAAdjB,EAAKiB,QAxBdiiB,EAAc5W,QAAU,IAAI6X,IAAK,CAC/BC,WAAW,EACXC,SAAS,EACTlB,OAAQA,EACRmB,OAAQ,CACNC,WAAY,CAAC,CACXC,KAAM,yCACL,CACDA,KAAM,CAAC,sDAAsD,sDAAuD,sDACpHC,SAAU,WACVC,WAAY,kBAKlBxB,EAAc5W,QAAQf,GAAG,UAAU,SAAA7I,GACjCwgB,EAAc5W,QAAQqY,OAAOjiB,MAG/BwgB,EAAc5W,QAAQf,GAAG,UAAU,SAAAqZ,GAC7Bhd,EAAU0E,UAAS1E,EAAU0E,QAAQuY,UAAYD,UA8B1D,CAACjB,EAAcE,IAGlB,IA0HMiB,EAAS,WACbpB,GAAiB,GACjBF,GAAgB,GAChBC,GAAW,GAEXP,EAAc5W,QAAQyY,UACtBvJ,OAAOwJ,SAASC,UAGlB,OACE,kBAAChe,EAAaie,SAAd,CAAuBrkB,MAAO,CAC5ByG,MArIU,WACZ,IAAMtH,EAAOJ,IAGbmH,EAAOyD,KAAK,eAAgB,CAACtH,MAAOlD,EAAKkD,QAEzCiiB,UAAUC,aAAaC,aAAa,CAACC,OAAO,EAAMC,OAAO,IACtDC,MAAK,SAACC,GACLrC,EAAUqC,EAAcC,SACpB/d,EAAQ2E,UAAS3E,EAAQ2E,QAAQuY,UAAYY,MAIrD1e,EAAOwE,GAAG,mBAAmB,YAA6B,IAA3BrG,EAA0B,EAA1BA,aAAcyf,EAAY,EAAZA,OAC3CjB,GAAiB,GACjBH,EAAUre,GACVoe,EAAgBqB,MAGlB5d,EAAOwE,GAAG,qBAAqB,WAC7BuZ,QAkHAvd,SAEAC,eACAC,UACAC,gBAEAC,UACAC,YAEAC,YAhFgB,SAAC0W,GACnB,IAAMve,EAAOJ,IACbujB,EAAOY,iBAAiBjgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUN,KACzDR,EAAOe,iBAAiBpgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUJ,KAEzDJ,GAAW,GAEPP,EAAc5W,QAAQyY,SAAS7B,EAAc5W,QAAQyY,UAEzD,IAAMY,EAAc,IAAIxB,IAAK,CAC3BC,WAAW,EACXC,SAAS,EACTC,OAAQ,CACNC,WAAY,CAAC,CACXC,KAAM,yCACL,CACDA,KAAM,CAAC,sDAAsD,sDAAuD,sDACpHC,SAAU,WACVC,WAAY,gBAGhBvB,OAAQA,IAGVwC,EAAYpa,GAAG,UAAU,SAAA7I,GACvBqE,EAAOyD,KAAK,eAAgB,CAAC+T,eAAcrZ,aAAclF,EAAKkD,MAAO0iB,WAAYljB,OAGnFijB,EAAYpa,GAAG,UAAU,SAAAqZ,GACnBhd,EAAU0E,UAAS1E,EAAU0E,QAAQuY,UAAYD,MAGvD7d,EAAOwE,GAAG,yBAAyB,YAA6B,IAA3BgT,EAA0B,EAA1BA,aAAcoG,EAAY,EAAZA,OACjDpB,EAAUhF,GACVkF,GAAW,GACXD,GAAgB,GAEhBN,EAAc5W,QAAQqY,OAAOA,MAI/BgB,EAAYpa,GAAG,SAAS,SAACrJ,GACvB0B,QAAQyB,MAAMnD,MAKhByjB,EAAYpa,GAAG,SAAS,kBAAMuZ,OAI9B5B,EAAc5W,QAAUqZ,GA8BtB7d,WAvHe,SAAC5C,GAClB,IAAMlF,EAAOJ,IACbujB,EAAOY,iBAAiBjgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUN,KACzDR,EAAOe,iBAAiBpgB,SAAQ,SAAAkgB,GAAK,OAAIA,EAAMC,QAAUJ,KAEzD,IAAMgC,EAAc,IAAI1B,IAAK,CAC3BC,WAAW,EACXC,SAAS,EACTlB,OAAQA,EACRmB,OAAQ,CACNC,WAAY,CAAC,CACXC,KAAM,yCACL,CACDA,KAAM,CAAC,sDAAsD,sDAAuD,sDACpHC,SAAU,WACVC,WAAY,kBAKlBmB,EAAYta,GAAG,UAAU,SAAA7I,GACvB8gB,GAAgB,GAChBE,GAAiB,GACjB3c,EAAOyD,KAAK,gBAAiB,CAAC+T,aAAcve,EAAKkD,MAAOgC,eAAcyf,OAAQjiB,OAGhFmjB,EAAYta,GAAG,UAAU,SAAAqZ,GACnBhd,EAAU0E,UAAS1E,EAAU0E,QAAQuY,UAAYD,MAGvDiB,EAAYta,GAAG,SAAS,kBAAMuZ,OAE9Be,EAAYlB,OAAOtB,GAGnBH,EAAc5W,QAAUuZ,GAqFtB9d,UA5Bc,WAChBhB,EAAOyD,KAAK,aAAc,CAACjD,WAC3Bud,KA4BEnB,eACAE,eACAD,kBACAE,oBAGCb,IiB7OwB,SAAC,GAAkB,IAAhBA,EAAe,EAAfA,SAC1BjgB,EAAQC,cACP8D,EAAUqF,KAAVrF,OAEP,EAA0C3G,oBAAS,GAAnD,mBAAOogB,EAAP,KAAsBsF,EAAtB,KACA,EAAwD1lB,mBAAS,IAAjE,mBAAOqgB,EAAP,KAA6BsF,EAA7B,KACA,EAA4C3lB,qBAA5C,mBAAOgf,EAAP,KAAuBF,EAAvB,KACA,EAA0B9e,mBAAS,IAAnC,mBAAOye,EAAP,KAAcsB,EAAd,KAuBA,OArBAlb,qBAAU,WAER8B,EAAOwE,GAAG,6BAA6B,YAAa,IAAX3K,EAAU,EAAVA,KACvCoC,EAAMe,KAAN,+CAAqBnD,EAArB,6NAAuE,cAGzEmG,EAAOwE,GAAG,uBAAuB,YAAc,IAAZrI,EAAW,EAAXA,MACjCgc,EAAkBhc,MAGpB6D,EAAOwE,GAAG,uBAAuB,YAAc,IAAZsT,EAAW,EAAXA,MACjCsB,EAAStB,MAGX9X,EAAOwE,GAAG,kBAAkB,WAC1Bua,GAAiB,GACjBC,EAAwB,SAGzB,CAAC/iB,EAAO+D,IAGT,kBAACyX,GAAe0G,SAAhB,CAAyBrkB,MAAO,CAC9B2f,gBACAC,uBACA5B,QAEAO,mBAGC6D,ICvCwB,SAAC,GAAgB,IAAfA,EAAc,EAAdA,SACxBlc,EAAUqF,KAAVrF,OACAnH,EAAWD,IAAXC,QAGP,EAA0CQ,oBAAS,GAAnD,mBAAOogB,EAAP,KAAsBsF,EAAtB,KACA,EAAwD1lB,mBAAS,IAAjE,mBAAOqgB,EAAP,KAA6BsF,EAA7B,KACA,EAA0B3lB,mBAAS,IAAnC,mBAAOye,EAAP,KAAcsB,EAAd,KACA,EAA0C/f,oBAAS,GAAnD,mBAAO4e,EAAP,KAAsBgH,EAAtB,KA4CA,OAzCA/gB,qBAAU,WAER8B,EAAOwE,GAAG,sBAAsB,YAAa,IAAX3K,EAAU,EAAVA,KAEhCklB,GAAiB,GACjBC,EAAwB,mRAAD,OAAwDnlB,OAGjFmG,EAAOwE,GAAG,mBAAmB,YAAgB,IAAd1G,EAAa,EAAbA,QACvB7E,EAAOJ,IACbmH,EAAOyD,KAAK,eAAgB,CAACpD,KAAMvC,EAAS3B,MAAOlD,EAAKkD,WAG1D6D,EAAOwE,GAAG,kBAAkB,YAAa,IAAX3K,EAAU,EAAVA,KAC5BklB,GAAiB,GACjBC,EAAwB,8CAAD,OAAYnlB,EAAZ,kKAGzBmG,EAAOwE,GAAG,mBAAmB,YAA4B,IAAnBgT,EAAkB,EAAzBrb,MACvBlD,EAAOJ,IACbkmB,GAAiB,GACjBC,EAAwB,IACxBhf,EAAOyD,KAAK,eAAgB,CAACpD,KAAMmX,EAAcrb,MAAOlD,EAAKkD,WAG/D6D,EAAOwE,GAAG,kBAAkB,WAC1Bua,GAAiB,GACjBC,EAAwB,OAG1Bhf,EAAOwE,GAAG,wBAAwB,YAAc,IAAZsT,EAAW,EAAXA,MAClCsB,EAAStB,MAGX9X,EAAOwE,GAAG,uBAAuB,YAAsC,IAAzB0a,EAAwB,EAAnC3H,UACjC0H,EAAiBC,QAGlB,IAID,kBAACxH,GAAeyG,SAAhB,CAAyBrkB,MAAO,CAC9B2f,gBACAC,uBAEA5B,QACAG,kBAGCiE,Me1DDiD,I,OAAU,CAEdC,SAAUC,IAAUC,cACpBC,QAAS,IACTC,OAAQ,OAERC,WAAYC,IAAYC,QAG1BC,IAASrgB,OACP,kBAAC,IAAMsgB,WAAP,KACE,kBAAC,IAAD,eAAeC,SAAUC,KAAmBZ,IAC1C,kBAACtD,GAAD,KACE,kBAAC,GAAD,SAINvZ,SAASC,eAAe,U,2JC3B1Byd,EAAOC,QAAU,IAA0B,kC,mBCA3CD,EAAOC,QAAU,IAA0B,oC,mBCA3CD,EAAOC,QAAU,IAA0B,uC,mBCA3CD,EAAOC,QAAU,IAA0B,yC,mBCA3CD,EAAOC,QAAU,IAA0B,wC,mBCA3CD,EAAOC,QAAU,IAA0B,uC,mBCA3CD,EAAOC,QAAU,IAA0B,wC,mBCA3CD,EAAOC,QAAU,IAA0B,uC,mBCA3CD,EAAOC,QAAU,IAA0B,uC,mBCA3CD,EAAOC,QAAU,IAA0B,yC,mBCA3CD,EAAOC,QAAU,IAA0B,wC,mBCA3CD,EAAOC,QAAU,IAA0B,uC,mBCA3CD,EAAOC,QAAU,IAA0B,wC,mBCA3CD,EAAOC,QAAU,IAA0B,uC","file":"static/js/main.a06f8104.chunk.js","sourcesContent":["import {useState} from 'react';\n\nexport const useUser = () => {\n  const getUser = () => {\n    const userString = sessionStorage.getItem('user');\n    const user = JSON.parse(userString);\n    return user ? user : undefined\n  };\n\n  const [user, setUser] = useState(getUser());\n\n  const saveUser = user => {\n    sessionStorage.setItem('user', JSON.stringify(user));\n    setUser(user);\n  };\n\n  const unsetUser = () => {\n    sessionStorage.removeItem('user');\n    setUser(undefined);\n  }\n\n  return {\n    getUser,\n    setUser: saveUser,\n    user: user,\n    unsetUser: unsetUser\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport './Checkbox.scss'\n\nconst Checkbox = ({label, name, value, onChange, checked}) => {\n\n  return (\n    <div className=\"radio\">\n      <input className=\"custom-radio\" type=\"radio\" id={\"color-\" + value} name={name} value={value} defaultChecked={checked}\n             onClick={e => onChange(e.currentTarget.value)}/>\n      <label htmlFor={\"color-\" + value}>{label}</label>\n    </div>\n  );\n}\n\n\nCheckbox.propTypes = {\n  label: PropTypes.any.isRequired,\n  name: PropTypes.any.isRequired,\n  value: PropTypes.any.isRequired,\n  onChange: PropTypes.func.isRequired,\n  checked: PropTypes.bool\n}\n\nexport default Checkbox;","import axios from 'axios';\nimport {useUser} from \"../hooks/useUser\";\n\nimport {serverUrl} from '../config.json';\n\nconst api = axios.create({\n  baseURL: `${serverUrl}/api`,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n/**\n intercept any error responses from the api\n and check if the token is no longer valid.\n ie. Token has expired or user is no longer\n authenticated.\n logout the user if the token has expired\n **/\n\napi.interceptors.response.use(\n  res => res,\n  err => {\n    if (err.response.status === 401) {\n      const {unsetUser} = useUser();\n      unsetUser();\n    }\n    return Promise.reject(err);\n  }\n);\n\nexport default api;","import React, {useState} from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport { useAlert } from 'react-alert'\n\nimport Checkbox from \"../ui/Checkbox\";\n\nimport api from \"../../utils/api\";\n\nimport {useUser} from \"../../hooks/useUser\";\n\nimport './Login.scss'\n\nconst loginUser = async ({credentials, type}) => {\n  try {\n    if (type === 'teacher') {\n      const res = await api.post('/auth/teacher', credentials);\n      return res.data;\n    } else if (type === 'student') {\n      const res = await api.post('/auth/student', credentials);\n      return res.data;\n    }\n  } catch (e) {\n    throw e.response.data.errors;\n  }\n}\n\nconst Login = ({setAuth}) => {\n  const history = useHistory();\n  const alert = useAlert()\n\n  const {setUser} = useUser()\n\n  const [login, setLogin] = useState();\n  const [password, setPassword] = useState();\n  const [type, setType] = useState(\"student\");\n\n  const outputErrors = (errors) => {\n    errors.forEach(err => {\n      alert.show(err.msg)\n    })\n  }\n\n  const handleSubmit = async e => {\n    e.preventDefault()\n    setAuth({user: undefined, isAuthenticated: false, isLoading: true});\n    try {\n      const user = await loginUser({\n        credentials: {\n          login,\n          password,\n        },\n        type\n      });\n\n      setUser(user)\n      setAuth({user: user, isAuthenticated: true, isLoading: false});\n      history.push(\"/\" + user.type);\n\n    } catch (errors) {\n      console.log(errors)\n      setAuth({user: undefined, isAuthenticated: false, isLoading: false});\n      outputErrors(errors);\n    }\n  }\n\n  return (\n    <div className=\"login-wrapper\">\n      <div className='background-holder'>\n        <div className=\"login-form\">\n\n          <form className='form' onSubmit={(e) => handleSubmit(e)}>\n            <div className=\"login-header\">\n              <p>Добро пожаловать в <br/>\n                <span className='golden-compass'><span className='g-letter'>G</span>olden Compass</span></p>\n            </div>\n            <div className={'inputs-wrapper'}>\n              <div className=\"form-group field\">\n                <input type=\"input\" className=\"form-field\" placeholder=\"Логин\" name=\"login\" id='login'\n                       onChange={e => setLogin(e.target.value)} required/>\n                <label htmlFor=\"login\" className=\"form-label\">Логин</label>\n              </div>\n\n              <div className=\"form-group field\">\n                <input type=\"password\" className=\"form-field\" placeholder=\"Пароль\" name=\"password\" id='password'\n                       onChange={e => setPassword(e.target.value)} required/>\n                <label htmlFor=\"password\" className=\"form-label\">Пароль</label>\n              </div>\n\n              <Checkbox onChange={(value) => setType(value)}\n                        label={'Учитель'}\n                        name={'type'}\n                        value={'teacher'}/>\n\n              <Checkbox onChange={(value) => setType(value)}\n                        label={'Ученик'}\n                        name={'type'}\n                        value={'student'}\n                        checked={true}/>\n\n              {/*<Switch labelOne=\"Учитель\" labelTwo=\"Ученик\" valueOne=\"teacher\" valueTwo=\"student\"*/}\n              {/*        onChange={(value) => {*/}\n              {/*          setType(value);*/}\n              {/*        }}/>*/}\n\n              <div className='submit-btn-wrapper'>\n                <button type=\"submit\" className='btn' id='loginBtn'>\n                  <span>Войти</span>\n                </button>\n              </div>\n            </div>\n          </form>\n          <div className='login-image'>\n\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nLogin.propTypes = {\n  setAuth: PropTypes.func.isRequired,\n}\n\nexport default Login;","import React from \"react\";\nimport { Link } from 'react-router-dom';\nimport PropTypes from \"prop-types\";\n\nimport './MenuItem.scss'\n\nconst MenuItem = ({link, label}) => {\n  return (\n    <div className={\"menu-item underline\"}>\n      <Link to={link}>{label}</Link>\n    </div>\n  )\n}\n\nMenuItem.propTypes = {\n  link: PropTypes.string.isRequired,\n  label: PropTypes.string.isRequired\n}\n\nexport default MenuItem;","import React from \"react\";\nimport {useHistory} from \"react-router-dom\";\nimport {FaArrowLeft} from 'react-icons/fa';\n\nimport \"./GoBack.scss\"\n\nconst GoBack = () => {\n  const history = useHistory();\n\n  const goBack = () => {\n    history.goBack()\n  }\n\n  return (\n    <div className={\"back-btn\"}>\n      <div className={'back'} onClick={() => goBack()}>\n        <FaArrowLeft/>\n      </div>\n    </div>\n  );\n}\n\nexport default GoBack;","import React from \"react\";\nimport MenuItem from \"../ui/MenuItem\";\nimport PropTypes from \"prop-types\";\nimport {useUser} from \"../../hooks/useUser\";\n\nimport GoBack from \"../ui/GoBack\";\n\nconst TeacherMenu = ({logout}) => {\n  const {user} = useUser()\n\n  return (\n    <div className={\"menu-bg\"}>\n      <div className={\"menu-wrapper\"}>\n        <MenuItem link={`/canvas/${user.login}`} label={'Начать урок'}/>\n        <MenuItem link={`/reset-password/${user.login}/${user.type}`} label={'Сменить пароль'}/>\n        <button className={'menu-button underline'} onClick={logout} >Выйти</button>\n      </div>\n      <GoBack/>\n    </div>\n  );\n}\n\nTeacherMenu.propTypes = {\n  logout: PropTypes.func.isRequired\n}\n\nexport default TeacherMenu;","import React from \"react\";\nimport MenuItem from \"../ui/MenuItem\";\nimport PropTypes from \"prop-types\";\n\nconst TeacherItem = ({teacher}) => {\n  return (\n    <div>\n      <MenuItem link={`/canvas/${teacher.login}`} label={teacher.name}/>\n    </div>\n  )\n}\n\nTeacherItem.propTypes = {\n  teacher: PropTypes.object.isRequired,\n}\n\nexport default TeacherItem;","import React, {useEffect, useState} from \"react\";\n\nimport TeacherItem from \"./TeacherItem\";\nimport GoBack from \"../ui/GoBack\";\n\nimport {useUser} from \"../../hooks/useUser\";\n\nimport api from \"../../utils/api\";\n\nconst TeachersList = () => {\n  const [teachers, setTeachers] = useState([]);\n  const {user} = useUser()\n\n  useEffect(() => {\n    const getTeachers = async () => {\n      const res = await api.post('/student/get-teachers', {studentLogin: user.login});\n      setTeachers(res.data.teachers);\n    }\n    getTeachers().catch((err) => console.error(err))\n\n  }, [user]);\n\n  return (\n    <div className={\"menu-bg\"} id={'resetPassForm'}>\n      <div className={\"menu-wrapper\"}>\n        <div className=\"login-header\">\n          <p>{teachers.length ? 'Выберите учителя...' : 'Для вас не назначено ни одного учителя...'}</p>\n        </div>\n\n        {teachers.map(teacher => <TeacherItem key={teacher._id} teacher={teacher}/>)}\n\n        <GoBack/>\n\n      </div>\n    </div>\n  )\n}\n\nexport default TeachersList;","import React from 'react';\n\nimport './ErrorFallback.scss';\n\nconst ErrorFallback = () => {\n  return (\n    <div className={\"error-wrapper\"}>\n      <div className={\"error-text\"}>\n        Произошла ошибка, попробуйте обновить страницу\n      </div>\n    </div>\n  )\n}\n\nexport default ErrorFallback;","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport MenuItem from \"../ui/MenuItem\";\nimport {useUser} from \"../../hooks/useUser\";\n\nimport GoBack from \"../ui/GoBack\";\n\nconst StudentMenu = ({logout}) => {\n  const user = useUser()\n\n  return (\n    <div className={\"menu-bg\"}>\n      <div className={\"menu-wrapper\"}>\n        <MenuItem link={'/teachers-list'} label={'Начать урок'}/>\n        <MenuItem link={`/reset-password/${user.login}/${user.type}`} label={'Сменить пароль'}/>\n        <button className={'menu-button underline'} onClick={logout} >Выйти</button>\n      </div>\n      <GoBack/>\n    </div>\n  )\n}\n\nStudentMenu.propTypes = {\n  logout: PropTypes.func.isRequired\n}\n\nexport default StudentMenu;","import React from 'react';\nimport './Spinner.scss'\n\n\nconst Spinner = () => {\n  return (\n    <div className=\"holder\">\n      <svg className=\"loader\" viewBox=\"0 0 24 24\">\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n        <circle className=\"loader__value\" cx=\"12\" cy=\"12\" r=\"10\"/>\n      </svg>\n    </div>\n  )\n}\n\nexport default Spinner;","import React from 'react';\nimport {Route, Redirect} from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport Spinner from \"./Spinner\";\n\nconst PrivateRoute = ({component: Component, auth: {isAuthenticated, isLoading}, ...rest}) => {\n\n  return (\n    <Route\n      {...rest}\n      render={props =>\n        isLoading ? (\n          <Spinner/>\n        ) : isAuthenticated ? (\n          <Component {...props} {...rest} />\n        ) : (\n          <Redirect to=\"/login\"/>\n        )\n      }\n    />\n  );\n}\n\nPrivateRoute.propTypes = {\n  auth: PropTypes.object.isRequired\n};\n\nexport default PrivateRoute;\n","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport {FaSignOutAlt} from \"react-icons/all\";\n\nimport './Header.scss'\nimport logo from \"../../img/logo.png\";\n\nconst Header = ({logout}) => {\n\n  return (\n    <header className='header'>\n      <div className='logo'>\n        <div className='logo-icon'>\n          <img src={logo} alt=\"Золотой компас\"/>\n        </div>\n      </div>\n      <div className={'logout'}>\n        <div id='logoutBtn' onClick={logout}>\n          <FaSignOutAlt/>\n        </div>\n      </div>\n    </header>\n  )\n}\n\nHeader.propTypes = {\n  logout: PropTypes.func.isRequired,\n}\n\nexport default Header;","import React from 'react';\n\nimport \"./WaitingScreen.scss\";\nimport PropTypes from \"prop-types\";\nimport GoBack from \"./GoBack\";\n\nconst WaitingScreen = ({message, active}) => {\n  return (\n    <div className={`waiting-screen ${!active ? 'hidden' : ''}`}>\n      <div className={'title'}>{message ? message : 'Подождите, пожалуйста...'}</div>\n      <GoBack/>\n    </div>\n  )\n}\n\nWaitingScreen.propTypes = {\n  message: PropTypes.string.isRequired,\n  active: PropTypes.bool.isRequired,\n};\n\nexport default WaitingScreen;\n","import React, {createContext, useEffect, useRef, useState} from 'react';\nimport Peer from 'simple-peer';\nimport {useUser} from \"../hooks/useUser\";\nimport io from 'socket.io-client'\n\nimport {serverUrl} from '../config.json';\n\nconst socket = io(serverUrl);\n\nconst VideoContext = createContext('');\n\nconst VideoContextProvider = ({children}) => {\n  const {getUser} = useUser();\n\n  const myVideo = useRef();\n  const userVideo = useRef();\n  const connectionRef = useRef({});\n\n  const [stream, setStream] = useState({});\n  const [callerSignal, setCallerSignal] = useState();\n  const [caller, setCaller] = useState();\n  const [callAccepted, setCallAccepted] = useState(false);\n  const [calling, setCalling] = useState(false);\n  const [receivingCall, setReceivingCall] = useState(false);\n\n\n  const [captureVideo, setCaptureVideo] = useState(true);\n  const [captureAudio, setCaptureAudio] = useState(true);\n\n  // Обработка отключения/включения видео/аудио\n  useEffect(() => {\n    if (callAccepted) {\n      const user = getUser()\n\n      stream.getVideoTracks().forEach(track => track.enabled = captureVideo);\n      stream.getAudioTracks().forEach(track => track.enabled = captureAudio);\n\n      if (user.type === 'student') {\n        connectionRef.current = new Peer({\n          initiator: false,\n          trickle: false,\n          stream: stream,\n          config: {\n            iceServers: [{\n              urls: \"stun:stun.golden-compass-app.com:3478\",\n            }, {\n              urls: ['turn:turn.golden-compass-app.com:3478?transport=udp','turn:turn.golden-compass-app.com:3478?transport=tcp', 'turn:turn.golden-compass-app.com:443?transport=tcp'],\n              username: \"tiredman\",\n              credential: \"pleasework\"\n            }]\n          },\n        })\n\n        connectionRef.current.on('signal', data => {\n          connectionRef.current.signal(data);\n        })\n\n        connectionRef.current.on(\"stream\", otherStream => {\n          if (userVideo.current) userVideo.current.srcObject = otherStream;\n        });\n\n\n      } else if (user.type === 'teacher') {\n        connectionRef.current = new Peer({\n          initiator: false,\n          trickle: false,\n          stream: stream,\n          config: {\n            iceServers: [{\n              urls: \"stun:stun.golden-compass-app.com:3478\",\n            }, {\n              urls: ['turn:turn.golden-compass-app.com:3478?transport=udp','turn:turn.golden-compass-app.com:3478?transport=tcp', 'turn:turn.golden-compass-app.com:443?transport=tcp'],\n              username: \"tiredman\",\n              credential: \"pleasework\"\n            }]\n          },\n        });\n\n        connectionRef.current.on('signal', data => {\n          connectionRef.current.signal(data)\n        })\n\n        connectionRef.current.on(\"stream\", otherStream => {\n          if (userVideo.current) userVideo.current.srcObject = otherStream;\n        });\n      }\n    }\n\n  }, [captureVideo, captureAudio])\n\n  // Необходимые приготовления\n  const setup = () => {\n    const user = getUser()\n\n    // Добавляем в список подключений\n    socket.emit('add-to-video', {login: user.login});\n\n    navigator.mediaDevices.getUserMedia({video: true, audio: true})\n      .then((currentStream) => {\n        setStream(currentStream.clone());\n        if (myVideo.current) myVideo.current.srcObject = currentStream;\n      });\n\n\n    socket.on('student-calling', ({studentLogin, signal}) => {\n      setReceivingCall(true);\n      setCaller(studentLogin);\n      setCallerSignal(signal);\n    });\n\n    socket.on('caller-ended-call', () => {\n      hangUp();\n    });\n\n  }\n\n  const answerCall = (studentLogin) => {\n    const user = getUser()\n    stream.getVideoTracks().forEach(track => track.enabled = captureVideo);\n    stream.getAudioTracks().forEach(track => track.enabled = captureAudio);\n\n    const teacherPeer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: stream,\n      config: {\n        iceServers: [{\n          urls: \"stun:stun.golden-compass-app.com:3478\",\n        }, {\n          urls: ['turn:turn.golden-compass-app.com:3478?transport=udp','turn:turn.golden-compass-app.com:3478?transport=tcp', 'turn:turn.golden-compass-app.com:443?transport=tcp'],\n          username: \"tiredman\",\n          credential: \"pleasework\"\n        }]\n      },\n    });\n\n    teacherPeer.on('signal', data => {\n      setCallAccepted(true);\n      setReceivingCall(false);\n      socket.emit('call-accepted', {teacherLogin: user.login, studentLogin, signal: data});\n    })\n\n    teacherPeer.on(\"stream\", otherStream => {\n      if (userVideo.current) userVideo.current.srcObject = otherStream;\n    });\n\n    teacherPeer.on('close', () => hangUp())\n\n    teacherPeer.signal(callerSignal)\n    // teacherPeer._debug = console.log\n\n    connectionRef.current = teacherPeer;\n  };\n\n  const callTeacher = (teacherLogin) => {\n    const user = getUser();\n    stream.getVideoTracks().forEach(track => track.enabled = captureVideo);\n    stream.getAudioTracks().forEach(track => track.enabled = captureAudio);\n\n    setCalling(true);\n\n    if (connectionRef.current.destroy) connectionRef.current.destroy();\n\n    const studentPeer = new Peer({\n      initiator: true,\n      trickle: false,\n      config: {\n        iceServers: [{\n          urls: \"stun:stun.golden-compass-app.com:3478\",\n        }, {\n          urls: ['turn:turn.golden-compass-app.com:3478?transport=udp','turn:turn.golden-compass-app.com:3478?transport=tcp', 'turn:turn.golden-compass-app.com:443?transport=tcp'],\n          username: \"tiredman\",\n          credential: \"pleasework\"\n        }]\n      },\n      stream: stream\n    })\n\n    studentPeer.on('signal', data => {\n      socket.emit('call-teacher', {teacherLogin, studentLogin: user.login, signalData: data});\n    })\n\n    studentPeer.on(\"stream\", otherStream => {\n      if (userVideo.current) userVideo.current.srcObject = otherStream;\n    });\n\n    socket.on('teacher-accepted-call', ({teacherLogin, signal}) => {\n      setCaller(teacherLogin);\n      setCalling(false);\n      setCallAccepted(true);\n\n      connectionRef.current.signal(signal);\n    });\n\n\n    studentPeer.on('error', (err) => {\n      console.error(err)\n      // alert('При передаче видео произошла ошибка, обновите страницу')\n      // window.location.reload();\n    })\n\n    studentPeer.on('close', () => hangUp())\n\n    // studentPeer._debug = console.log\n\n    connectionRef.current = studentPeer;\n  };\n\n  const leaveCall = () => {\n    socket.emit('call-ended', {caller})\n    hangUp();\n  };\n\n  const hangUp = () => {\n    setReceivingCall(false);\n    setCallAccepted(false);\n    setCalling(false);\n\n    connectionRef.current.destroy();\n    window.location.reload();\n  }\n\n  return (\n    <VideoContext.Provider value={{\n      setup,\n      caller,\n\n      callAccepted,\n      calling,\n      receivingCall,\n\n      myVideo,\n      userVideo,\n\n      callTeacher,\n      answerCall,\n      leaveCall,\n\n      captureVideo,\n      captureAudio,\n      setCaptureVideo,\n      setCaptureAudio,\n    }}\n    >\n      {children}\n    </VideoContext.Provider>\n  );\n};\n\nexport {VideoContextProvider, VideoContext};\n","import React, {useContext, useEffect} from 'react';\n// import {FaVideo, FaVideoSlash, FaVolumeUp, FaVolumeMute, FaPhone, FaPhoneSlash} from 'react-icons/fa';\nimport {FaPhone, FaPhoneSlash} from 'react-icons/fa';\n\nimport PropTypes from \"prop-types\";\nimport {useUser} from \"../../../hooks/useUser\";\n\nimport {VideoContext} from \"../../../context/VideoContext\";\n\nimport './VideoArea.scss';\n\nconst VideoArea = ({room}) => {\n  const {\n    setup,\n    caller,\n\n    callAccepted,\n    calling,\n    receivingCall,\n\n    myVideo,\n    userVideo,\n\n    callTeacher,\n    answerCall,\n    leaveCall,\n\n    // captureVideo,\n    // captureAudio,\n    // setCaptureVideo,\n    // setCaptureAudio,\n\n  } = useContext(VideoContext);\n\n\n  useEffect(() => {\n    setup()\n  }, [])\n\n  const {getUser} = useUser();\n  const user = getUser();\n\n  return (\n    <div className={\"video-wrapper\"}>\n      {calling && <div className={'notification'}>\n        <div className={'notification-inner'}>Отправлен вызов учителю</div>\n      </div>}\n\n      {receivingCall && <div className={'notification'}>\n        <div className={'notification-inner'}>Ученик вас вызывает</div>\n      </div>}\n\n      {!callAccepted && !calling && user.type === 'student' && <div className={'notification'}>\n        <div className={'notification-inner'}>Чтобы начать видеосвязь, нажмите на кнопку над вашим видео</div>\n      </div>}\n\n      <div className={\"teacher-video video\"}>\n\n        <video\n          ref={myVideo}\n          muted\n          autoPlay\n          className=\"my-video\"\n        />\n\n        <div className={'video-buttons start-call-buttons'}>\n\n          {\n            user.type === 'student' && !calling && !callAccepted &&\n            <div className='video-button green' onClick={() => callTeacher(room)}><FaPhone/></div>\n          }\n          {\n            user.type === 'teacher' && receivingCall &&\n            <div className='video-button green' onClick={() => answerCall(caller)}><FaPhone/></div>\n          }\n          {\n            callAccepted &&\n            <div className='video-button red' onClick={() => leaveCall(caller)}><FaPhoneSlash/></div>\n          }\n        </div>\n\n        {/*<div className={'video-buttons'}>*/}\n        {/*  {captureVideo ?*/}\n        {/*    <div className={'video-button stop-video'} onClick={() => setCaptureVideo(false)}><FaVideoSlash/></div> :*/}\n        {/*    <div className={'video-button start-video'} onClick={() => setCaptureVideo(true)}><FaVideo/></div>}*/}\n\n        {/*  {captureAudio ?*/}\n        {/*    <div className={'video-button stop-audio'} onClick={() => setCaptureAudio(false)}><FaVolumeMute/></div> :*/}\n        {/*    <div className={'video-button start-audio'} onClick={() => setCaptureAudio(true)}><FaVolumeUp/></div>}*/}\n        {/*</div>*/}\n      </div>\n\n      <div className={'video-border'}/>\n\n      <div className={\"student-video video\"}>\n        <video\n          ref={userVideo}\n          autoPlay\n          className=\"accepted-video\"\n        />\n      </div>\n    </div>\n  )\n}\n\nVideoArea.propTypes = {\n  room: PropTypes.string.isRequired,\n}\n\nexport default VideoArea;","import React from 'react';\nimport PropTypes from \"prop-types\";\nimport {useUser} from \"../../../../hooks/useUser\";\n\nconst TipArea = ({tip}) => {\n  const {user: {type: usertype}} = useUser();\n\n  return (\n    <div className={\"tip-area\"}>\n      <div className={\"tip-text\"}>\n        {usertype === 'teacher' ? <p>{tip || \"\"}</p> : ''}\n      </div>\n    </div>\n  )\n}\n\nTipArea.propTypes = {\n  tip: PropTypes.string,\n}\n\nexport default TipArea;","export const TOOLS = {\n  UNDO: \"UNDO\",\n  PENCIL: \"PENCIL\",\n  ERASER: \"ERASER\",\n  CURSOR: \"CURSOR\",\n  TIMER: \"TIMER\",\n  SWITCH: \"SWITCH\",\n  RELOAD: \"RELOAD\",\n  DEFAULT: \"\"\n}\n","import image from '../../../../img/cursor.png'\nimport {TOOLS} from '../../../../utils/types'\n\nexport default function sketch(p) {\n  // TODO Разобраться с https (SSL)\n  let socket;\n  let room;\n\n  let canvas;\n  let drawingCanvas;\n  let cursorCanvas;\n\n  let cursorImg;\n\n  let activeTool = TOOLS.DEFAULT;\n  let active = true;\n\n  let drawWidth = 10;\n  let drawColor = 'white';\n\n  let sketchWidth;\n  let sketchHeight;\n\n  p.setup = () => {\n    cursorImg = p.loadImage(image);\n    const container = document.getElementById(\"mainCanvas\");\n    if(!container){\n      return\n    }\n    sketchWidth = container.offsetWidth;\n    sketchHeight = container.offsetHeight;\n\n    // TODO можно удалить повторное создание обработчиков события в socket'е\n    const canvases = container.getElementsByTagName(\"canvas\");\n    for (let i = 0; i < canvases.length; i++){\n      if (canvases[i]) canvases[i].parentElement.removeChild(canvases[i])\n    }\n    canvas = p.createCanvas(sketchWidth, sketchHeight);\n    drawingCanvas = p.createGraphics(sketchWidth, sketchHeight);\n    cursorCanvas = p.createGraphics(sketchWidth, sketchHeight);\n    canvas.parent(\"mainCanvas\");\n  }\n\n  p.draw = () => {\n    p.clear();\n    p.image(drawingCanvas, 0, 0);\n    p.image(cursorCanvas, 0, 0);\n\n    if (activeTool === TOOLS.CURSOR) {\n\n      p.noCursor();\n\n      let data = {\n        x: p.mouseX/(sketchWidth/100),\n        y: p.mouseY/(sketchHeight/100),\n      }\n      socket.emit(\"canvas-cursor\", {room, data});\n\n    } else {\n\n      p.cursor();\n\n      if (activeTool === TOOLS.ERASER) {\n        eraserCursor({x: p.mouseX, y: p.mouseY});\n      }\n\n    }\n  }\n\n  p.mouseDragged = () => {\n    if (!active) return\n    if (activeTool === TOOLS.PENCIL) {\n      let data = {\n        x: p.mouseX/(sketchWidth/100),\n        y: p.mouseY/(sketchHeight/100),\n        pMouseX: p.pmouseX/(sketchWidth/100),\n        pMouseY: p.pmouseY/(sketchHeight/100),\n        size: drawWidth,\n        color: drawColor\n      }\n      socket.emit(\"canvas-pencil\", {room, data});\n    } else if (activeTool === TOOLS.ERASER) {\n      let data = {\n        x: p.mouseX/(sketchWidth/100),\n        y: p.mouseY/(sketchHeight/100),\n      }\n      socket.emit(\"canvas-eraser\", {room, data});\n    }\n  }\n\n  p.mouseClicked = () => {\n    if (!active) return\n    if (activeTool === TOOLS.ERASER) {\n      let data = {\n        x: p.mouseX/(sketchWidth/100),\n        y: p.mouseY/(sketchHeight/100),\n      }\n      socket.emit(\"canvas-eraser\", {room, data});\n    }\n  }\n\n  const resetCanvas = () => {\n    drawingCanvas.clear();\n  }\n\n  const pencilDraw = ({x, y, pMouseX, pMouseY, size, color}) => {\n    let c = drawingCanvas.color(color);\n    drawingCanvas.stroke(c)\n    drawingCanvas.strokeWeight(size);\n    drawingCanvas.line(sketchWidth/100*x, sketchHeight/100*y, sketchWidth/100*pMouseX, sketchHeight/100*pMouseY, size);\n  }\n\n  const eraser = ({x, y}) => {\n    drawingCanvas.erase();\n    drawingCanvas.circle(sketchWidth/100*x, sketchHeight/100*y, 30);\n    drawingCanvas.noErase();\n  }\n\n  const cursor = ({x, y}) => {\n    cursorCanvas.clear();\n\n    cursorCanvas.image(cursorImg, sketchWidth/100*x, sketchHeight/100*y, cursorImg.width / 50, cursorImg.height / 50)\n\n    p.image(cursorCanvas, 0, 0);\n  }\n\n  const eraserCursor = ({x, y}) => {\n    cursorCanvas.clear();\n    cursorCanvas.fill(0, 255, 0, 100);\n    cursorCanvas.circle(x, y, 30);\n    p.image(cursorCanvas, 0, 0);\n  }\n\n  p.myCustomRedrawAccordingToNewPropsHandler = newProps => {\n    room = newProps.room;\n\n    active = newProps.active;\n    activeTool = newProps.activeTool;\n    drawWidth = newProps.drawWidth;\n    drawColor = newProps.drawColor;\n\n    if (!newProps.socket) return;\n    if (!!socket) return;\n\n    socket = newProps.socket;\n\n    socket.on('draw', (data) => {\n      pencilDraw(data);\n    })\n\n    socket.on('erase', (data) => {\n      eraser(data);\n    })\n\n    socket.on('cursor', (data) => {\n      cursor(data);\n    })\n\n    socket.on('canvas-reset', () => {\n      resetCanvas();\n    })\n\n    socket.on('loaded-image', () => {\n      p.setup()\n    })\n  }\n}","import io from 'socket.io-client'\nimport {serverUrl} from '../config.json';\n\nconst socket = io(serverUrl, {transports: ['websocket'], upgrade: false});\n\nexport const useSocket = () => {\n  return { socket }\n}\n","import React, {useEffect, useState} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport {useSocket} from \"../../../../../hooks/useSocket\";\n\nimport './Abacus.scss'\n\nconst bottomRowInitial = [\n  {current: 0, number: 1, beads: [1, 2, 3, 4]},\n  {current: 0, number: 2, beads: [1, 2, 3, 4]},\n  {current: 0, number: 3, beads: [1, 2, 3, 4]},\n  {current: 0, number: 4, beads: [1, 2, 3, 4]},\n\n  {current: 0, number: 5, beads: [1, 2, 3, 4]},\n  {current: 0, number: 6, beads: [1, 2, 3, 4]},\n  {current: 0, number: 7, beads: [1, 2, 3, 4]},\n  {current: 0, number: 8, beads: [1, 2, 3, 4]},\n\n  {current: 0, number: 9, beads: [1, 2, 3, 4]},\n  {current: 0, number: 10, beads: [1, 2, 3, 4]},\n  {current: 0, number: 11, beads: [1, 2, 3, 4]},\n  {current: 0, number: 12, beads: [1, 2, 3, 4]},\n\n  {current: 0, number: 13, beads: [1, 2, 3, 4]},\n  {current: 0, number: 14, beads: [1, 2, 3, 4]},\n  {current: 0, number: 15, beads: [1, 2, 3, 4]},\n  // {current: 0, number: 16, beads: [1, 2, 3, 4]},\n\n  // {current: 0, number: 17, beads: [1, 2, 3, 4]},\n]\n\nconst upperRowInitial = [\n  {current: 0, number: 1, beads: [1]},\n  {current: 0, number: 2, beads: [1]},\n  {current: 0, number: 3, beads: [1]},\n  {current: 0, number: 4, beads: [1]},\n  {current: 0, number: 5, beads: [1]},\n  {current: 0, number: 6, beads: [1]},\n  {current: 0, number: 7, beads: [1]},\n  {current: 0, number: 8, beads: [1]},\n  {current: 0, number: 9, beads: [1]},\n  {current: 0, number: 10, beads: [1]},\n  {current: 0, number: 11, beads: [1]},\n  {current: 0, number: 12, beads: [1]},\n  {current: 0, number: 13, beads: [1]},\n  {current: 0, number: 14, beads: [1]},\n  {current: 0, number: 15, beads: [1]},\n  // {current: 0, number: 16, beads: [1]},\n  // {current: 0, number: 17, beads: [1]},\n]\n\nconst Abacus = ({room}) => {\n  const {socket} = useSocket();\n  const [bottomRow, setBottomRow] = useState(bottomRowInitial)\n  const [upperRow, setUpperRow] = useState(upperRowInitial)\n\n  const emmit = (section, number, bead) => {\n    const previous = section === 'bottom' ? bottomRow : upperRow\n\n    const state = previous.map((row) => {\n      if (row.number === number) {\n        let current = bead;\n        if (row.current >= bead) {\n          current = bead - 1\n        }\n\n        return {...row, current}\n      }\n      return row;\n    })\n\n    socket.emit(\"abacus-clicked\", {room, section, state});\n  }\n\n  useEffect(() => {\n    socket.on(\"change-abacus\", ({section, state}) => {\n      const setter = section === 'bottom' ? setBottomRow : setUpperRow\n      try {\n        setter(state)\n      } catch (e) {\n        console.log(e)\n        console.log('Abacus not open')\n      }\n\n    })\n  }, [])\n\n  return (\n    <div className={\"abacus-holder\"}>\n      <div className={'section upper-row'}>\n        {upperRow.map((row) =>\n          <div key={row.number} className={\"spoke\"}>\n            {row.beads.map(value =>\n              <div key={value} onClick={() => emmit('upper', row.number, value)}\n                   className={`bead bead-${value} ${value === row.current ? 'active' : ''}`}/>\n            )}\n          </div>\n        )}\n      </div>\n      <div className={\"abacus-divider\"}/>\n      <div className={'section bottom-row'}>\n        {bottomRow.map((row) =>\n          <div key={row.number} className={\"spoke\"}>\n            {row.beads.map(value =>\n              <div key={value} onClick={() => emmit('bottom', row.number, value)}\n                   className={`bead bead-${value} ${value === row.current ? 'active' : ''}`}/>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nAbacus.propTypes = {\n  room: PropTypes.string.isRequired,\n}\n\nexport default Abacus;","import React from \"react\";\n\nimport './Abacus.scss'\nimport Abacus from \"./Abacus\";\nimport PropTypes from \"prop-types\";\n\nconst AbacusSlide = ({room, visible}) => {\n\n  return (\n    <div className={`abacus-slide ${!visible ? 'hidden' : ''}`}>\n      <div className={\"abacus-border\"}>\n        <div className={\"border left\"}/>\n        <div className={\"border right\"}/>\n        <div className={\"border top\"}/>\n        <div className={\"border bottom\"}/>\n\n        <Abacus room={room}/>\n      </div>\n    </div>\n  );\n}\n\nAbacusSlide.propTypes = {\n  room: PropTypes.string.isRequired,\n  visible: PropTypes.bool,\n}\n\nexport default AbacusSlide;","import blackPawn from \"../../../../../img/chessPieces/blackPawn.png\";\nimport blackBishop from \"../../../../../img/chessPieces/blackBishop.png\";\nimport blackHorse from \"../../../../../img/chessPieces/blackHorse.png\";\nimport blackRook from \"../../../../../img/chessPieces/blackRook.png\";\nimport blackQueen from \"../../../../../img/chessPieces/blackQueen.png\";\nimport blackKing from \"../../../../../img/chessPieces/blackKing.png\";\nimport whitePawn from \"../../../../../img/chessPieces/whitePawn.png\";\nimport whiteBishop from \"../../../../../img/chessPieces/whiteBishop.png\";\nimport whiteHorse from \"../../../../../img/chessPieces/whiteHorse.png\";\nimport whiteRook from \"../../../../../img/chessPieces/whiteRook.png\";\nimport whiteQueen from \"../../../../../img/chessPieces/whiteQueen.png\";\nimport whiteKing from \"../../../../../img/chessPieces/whiteKing.png\";\n\nclass ChessLogic {\n  static colors = {\n    WHITE: \"WHITE\",\n    BLACK: \"BLACK\"\n  }\n  static figures = {\n    PAWN: \"PAWN\",\n    HORSE: \"HORSE\",\n    BISHOP: \"BISHOP\",\n    ROOK: \"ROOK\",\n    QUEEN: \"QUEEN\",\n    KING: \"KING\",\n  }\n  static sides = {\n    OPPONENT: \"OPPONENT\",\n    ME: \"ME\"\n  }\n\n  constructor(rows, columns) {\n    this.rows = rows\n    this.columns = columns\n  }\n\n  // *** MAIN METHODS *** //\n\n  getCell(boardState, x, y) {\n    if (x < 0 || x > 7 || y < 0 || y > 7) return\n\n    return boardState[x][y]\n  }\n\n  getKing(boardState) {\n    let kingCell\n    boardState.forEach(_ => _.forEach(cell => {\n      if (cell.figure === ChessLogic.figures.KING && cell.side === ChessLogic.sides.ME) {\n        kingCell = cell\n      }\n    }))\n    return kingCell\n  }\n\n  getImg(figureColor) {\n    switch (figureColor) {\n      case (ChessLogic.figures.PAWN + ChessLogic.colors.BLACK):\n        return blackPawn;\n      case (ChessLogic.figures.BISHOP + ChessLogic.colors.BLACK):\n        return blackBishop;\n      case (ChessLogic.figures.HORSE + ChessLogic.colors.BLACK):\n        return blackHorse;\n      case (ChessLogic.figures.ROOK + ChessLogic.colors.BLACK):\n        return blackRook;\n      case (ChessLogic.figures.QUEEN + ChessLogic.colors.BLACK):\n        return blackQueen;\n      case (ChessLogic.figures.KING + ChessLogic.colors.BLACK):\n        return blackKing;\n      case (ChessLogic.figures.PAWN + ChessLogic.colors.WHITE):\n        return whitePawn;\n      case (ChessLogic.figures.BISHOP + ChessLogic.colors.WHITE):\n        return whiteBishop;\n      case (ChessLogic.figures.HORSE + ChessLogic.colors.WHITE):\n        return whiteHorse;\n      case (ChessLogic.figures.ROOK + ChessLogic.colors.WHITE):\n        return whiteRook;\n      case (ChessLogic.figures.QUEEN + ChessLogic.colors.WHITE):\n        return whiteQueen;\n      case (ChessLogic.figures.KING + ChessLogic.colors.WHITE):\n        return whiteKing;\n    }\n  }\n\n  prepareCellInitialState = (i, isPlayingAsWhite) => {\n    const [x, y] = i.split(\"\")\n    let figure;\n    let side;\n    let color;\n    if ([\"1\", \"2\"].includes(y)) {\n      side = isPlayingAsWhite ? ChessLogic.sides.ME : ChessLogic.sides.OPPONENT\n      color = ChessLogic.colors.WHITE\n    }\n    if ([\"7\", \"8\"].includes(y)) {\n      side = isPlayingAsWhite ? ChessLogic.sides.OPPONENT : ChessLogic.sides.ME\n      color = ChessLogic.colors.BLACK\n    }\n    if (y === \"2\" || y === \"7\") {\n      figure = ChessLogic.figures.PAWN\n    }\n    if ([\"a1\", \"h1\", \"a8\", \"h8\"].includes(i)) {\n      figure = ChessLogic.figures.ROOK\n    }\n    if ([\"b1\", \"g1\", \"b8\", \"g8\"].includes(i)) {\n      figure = ChessLogic.figures.HORSE\n    }\n    if ([\"c1\", \"f1\", \"c8\", \"f8\"].includes(i)) {\n      figure = ChessLogic.figures.BISHOP\n    }\n    if ([\"d1\", \"d8\"].includes(i)) {\n      figure = ChessLogic.figures.QUEEN\n    }\n    if ([\"e1\", \"e8\"].includes(i)) {\n      figure = ChessLogic.figures.KING\n    }\n    return {\n      x,\n      y,\n      figure: figure ? figure : null,\n      side: side ? side : null,\n      color: color ? color : null,\n      possibleMove: false\n    }\n  }\n\n  // *** MAIN METHODS END *** //\n\n  // *** GET ATTACKERS METHODS *** //\n\n  getAttackingPawns(boardState, cell, i, j) {\n    const moves = [\n      this.getCell(boardState, i - 1, j - 1),\n      this.getCell(boardState, i - 1, j + 1)\n    ]\n\n    return moves.filter(move => move && move.figure === ChessLogic.figures.PAWN && move.side === ChessLogic.sides.OPPONENT)\n  }\n\n  getAttackingHorses(boardState, cell, i, j) {\n    const moves = this.getPossibleMovesForHorse(boardState, cell, i, j)\n    return moves.filter(i => i.figure === ChessLogic.figures.HORSE)\n  }\n\n  getAttackingBishopsOrQueens(boardState, cell, i, j) {\n    const moves = this.getPossibleMovesForBishop(boardState, cell, i, j)\n    return moves.filter(i => i.figure === ChessLogic.figures.BISHOP || i.figure === ChessLogic.figures.QUEEN)\n  }\n\n  getAttackingRooksOrQueens(boardState, cell, i, j) {\n    const moves = this.getPossibleMovesForRook(boardState, cell, i, j)\n    return moves.filter(i => i.figure === ChessLogic.figures.ROOK || i.figure === ChessLogic.figures.QUEEN)\n  }\n\n  getAttackingKings(boardState, cell, i, j) {\n    const moves = this.getAllMovesForKing(boardState, cell, i, j)\n    return moves.filter(i => i.figure === ChessLogic.figures.KING && i.side === ChessLogic.sides.OPPONENT)\n  }\n\n  isUnderAttack(boardState, cell) {\n    const i = this.rows.indexOf(Number(cell.y))\n    const j = this.columns.indexOf(cell.x)\n    const attackingPieces = []\n    attackingPieces.push(...this.getAttackingPawns(boardState, cell, i, j))\n    attackingPieces.push(...this.getAttackingHorses(boardState, cell, i, j))\n    attackingPieces.push(...this.getAttackingBishopsOrQueens(boardState, cell, i, j))\n    attackingPieces.push(...this.getAttackingRooksOrQueens(boardState, cell, i, j))\n    attackingPieces.push(...this.getAttackingKings(boardState, cell, i, j))\n    return attackingPieces.length > 0\n  }\n\n  getAttackers(boardState, kingCell) {\n    const i = this.rows.indexOf(Number(kingCell.y))\n    const j = this.columns.indexOf(kingCell.x)\n    const attackers = []\n    attackers.push(...this.getAttackingPawns(boardState, kingCell, i, j))\n    attackers.push(...this.getAttackingHorses(boardState, kingCell, i, j))\n    attackers.push(...this.getAttackingBishopsOrQueens(boardState, kingCell, i, j))\n    attackers.push(...this.getAttackingRooksOrQueens(boardState, kingCell, i, j))\n    return attackers\n  }\n\n  // *** GET ATTACKERS METHODS END *** //\n\n  // *** GET DIAGONAL/HORIZONTAL METHODS *** //\n\n  getDiagonalCells(boardState, start, end) {\n    const startI = this.rows.indexOf(Number(start.y))\n    const startJ = this.columns.indexOf(start.x)\n\n    const endI = this.rows.indexOf(Number(end.y))\n    const endJ = this.columns.indexOf(end.x)\n\n    if (Math.max(startI, endI) - Math.min(startI, endI) !== Math.max(startJ, endJ) - Math.min(startJ, endJ)) {\n      return []\n    }\n\n    const cells = []\n\n    let modI = startI < endI ? 1 : -1\n    let modJ = startJ < endJ ? 1 : -1\n\n    for (let i = endI, j = endJ; i !== startI && j !== startJ; i -= modI, j -= modJ) {\n      cells.push(this.getCell(boardState, i, j))\n    }\n    return cells\n  }\n\n  getHorizontalCells(boardState, start, end) {\n    const startI = this.rows.indexOf(Number(start.y))\n    const startJ = this.columns.indexOf(start.x)\n\n    const endI = this.rows.indexOf(Number(end.y))\n    const endJ = this.columns.indexOf(end.x)\n\n    const cells = []\n\n    if (startI === endI) {\n      if (startJ < endJ) {\n        for (let i = startJ + 1; i <= endJ; i++) {\n          cells.push(this.getCell(boardState, startI, i))\n        }\n      } else if (startJ > endJ) {\n        for (let i = endJ; i < startJ; i++) {\n          cells.push(this.getCell(boardState, startI, i))\n        }\n      }\n    } else if (startJ === endJ) {\n      if (startI < endI) {\n        for (let i = startI + 1; i <= endI; i++) {\n          cells.push(this.getCell(boardState, i, startJ))\n        }\n      } else if (startI > endI) {\n        for (let i = endI; i < startI; i++) {\n          cells.push(this.getCell(boardState, i, startJ))\n        }\n      }\n    } else {\n      return []\n    }\n    return cells\n  }\n\n  // *** GET DIAGONAL/HORIZONTAL METHODS END *** //\n\n  // *** GET MOVES FOR FIGURES METHODS *** //\n\n  filterAttackingBishopsForPin(boardState, cell, king, attackingBishopsOrQueens) {\n    return attackingBishopsOrQueens.filter(attacker => {\n      const diagonalCells = this.getDiagonalCells(boardState, king, attacker)\n      if (!diagonalCells.length) return false\n      for (let i = 0; i < diagonalCells.length; i++) {\n        let diagonalCell = diagonalCells[i]\n        if (diagonalCell.figure\n          && (diagonalCell.x !== cell.x && diagonalCell.y !== cell.y)\n          && (diagonalCell.x !== attacker.x && diagonalCell.y !== attacker.y))\n          return false\n      }\n      return true\n    })\n  }\n\n  filterAttackingRooksForPin(boardState, cell, king, attackingRooksOrQueens) {\n    return attackingRooksOrQueens.filter(attacker => {\n      const horizontalCells = this.getHorizontalCells(boardState, king, attacker)\n      if (!horizontalCells.length) return false\n      for (let i = 0; i < horizontalCells.length; i++) {\n        let horizontalCell = horizontalCells[i]\n        if (horizontalCell.figure\n          && (horizontalCell.x !== cell.x && horizontalCell.y !== cell.y)\n          && (horizontalCell.x !== attacker.x && horizontalCell.y !== attacker.y))\n          return false\n      }\n      return true\n    })\n  }\n\n\n  getAllMovesForPawn(boardState, previousMove, cell, i, j) {\n    const activeCells = []\n\n    const oneForward = this.getCell(boardState, i - 1, j)\n    if (!oneForward.figure) {\n      activeCells.push(oneForward)\n      if (i === 6) {\n        const twoForward = this.getCell(boardState, i - 2, j)\n        if (!twoForward.figure) activeCells.push(twoForward)\n      }\n    }\n\n    const [left, right] = [this.getCell(boardState, i - 1, j - 1), this.getCell(boardState, i - 1, j + 1)]\n    if (left && left.figure && left.side === ChessLogic.sides.OPPONENT) activeCells.push(left)\n    if (right && right.figure && right.side === ChessLogic.sides.OPPONENT) activeCells.push(right)\n\n    if (!previousMove.to) return activeCells\n\n    const prevToI = this.rows.indexOf(Number(previousMove.to.y))\n    const prevFromI = this.rows.indexOf(Number(previousMove.from.y))\n    if (prevToI === 3 && prevFromI === 1 && i === 3) {\n      const [enPassantLeft, enPassantRight] = [this.getCell(boardState, i, j - 1), this.getCell(boardState, i, j + 1)]\n\n      if (previousMove.to.x === enPassantLeft.x) {\n        activeCells.push(this.getCell(boardState, i - 1, j - 1))\n      }\n      if (previousMove.to.x === enPassantRight.x) {\n        activeCells.push(this.getCell(boardState, i - 1, j + 1))\n      }\n    }\n\n    return activeCells\n  }\n\n  getPossibleMovesForPawn(boardState, previousMove, cell, i, j, king) {\n    const activeCells = []\n\n    activeCells.push(...this.getAllMovesForPawn(boardState, previousMove, cell, i, j))\n\n    let attackingBishopsOrQueens = this.getAttackingBishopsOrQueens(boardState, cell, i, j)\n    if (attackingBishopsOrQueens.length) {\n      attackingBishopsOrQueens = attackingBishopsOrQueens.filter(attacker => this.getDiagonalCells(boardState, king, attacker).length)\n      if (attackingBishopsOrQueens.length) {\n        const attackersCoordinates = attackingBishopsOrQueens.map(i => i.x + i.y)\n        return activeCells.filter(aCell => attackersCoordinates.includes(aCell.x + aCell.y))\n      }\n    }\n\n    let attackingRooksOrQueens = this.getAttackingRooksOrQueens(boardState, cell, i, j)\n    if (attackingRooksOrQueens.length) {\n      attackingRooksOrQueens = this.filterAttackingRooksForPin(boardState, cell, king, attackingRooksOrQueens)\n\n      for (let i = 0; i < attackingRooksOrQueens.length; i++) {\n        let attacker = attackingRooksOrQueens[i]\n        if (attacker.y === cell.y) {\n          return []\n        } else if (attacker.x === cell.x) {\n          return activeCells.filter(aCell => aCell.x === cell.x)\n        }\n      }\n    }\n\n    return activeCells\n  }\n\n  getPossibleMovesForHorse(boardState, cell, i, j, king = null) {\n    const horseMoves = [\n      this.getCell(boardState, i - 2, j + 1),\n      this.getCell(boardState, i - 2, j - 1),\n      this.getCell(boardState, i + 2, j + 1),\n      this.getCell(boardState, i + 2, j - 1),\n      this.getCell(boardState, i + 1, j - 2),\n      this.getCell(boardState, i - 1, j - 2),\n      this.getCell(boardState, i + 1, j + 2),\n      this.getCell(boardState, i - 1, j + 2),\n    ]\n\n    if (!king) {\n      return horseMoves.filter(i => {\n        return i && (!i.figure || i.side === ChessLogic.sides.OPPONENT)\n      })\n    }\n\n    let attackingBishopsOrQueens = this.getAttackingBishopsOrQueens(boardState, cell, i, j)\n    if (attackingBishopsOrQueens.length) {\n      attackingBishopsOrQueens = this.filterAttackingBishopsForPin(boardState, cell, king, attackingBishopsOrQueens)\n      if (attackingBishopsOrQueens.length) return []\n    }\n\n    let attackingRooksOrQueens = this.getAttackingRooksOrQueens(boardState, cell, i, j)\n    if (attackingRooksOrQueens.length) {\n      attackingRooksOrQueens = this.filterAttackingRooksForPin(boardState, cell, king, attackingRooksOrQueens)\n      if (attackingRooksOrQueens.length) return []\n    }\n    return horseMoves.filter(i => {\n      return i && (!i.figure || i.side === ChessLogic.sides.OPPONENT)\n    })\n  }\n\n  getPossibleMovesForBishop(boardState, cell, i, j, king = null) {\n    const activeCells = []\n    let cursorX = i\n    let cursorY = j\n    while (true) {\n      cursorX++\n      cursorY++\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorX--\n      cursorY--\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorY++\n      cursorX--\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorY--\n      cursorX++\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n\n    if (!king)\n      return activeCells\n\n    let attackingBishopsOrQueens = this.getAttackingBishopsOrQueens(boardState, cell, i, j)\n    if (attackingBishopsOrQueens.length) {\n      attackingBishopsOrQueens = this.filterAttackingBishopsForPin(boardState, cell, king, attackingBishopsOrQueens)\n      if (attackingBishopsOrQueens.length) {\n        const attacker = attackingBishopsOrQueens[0]\n        const cellCoordinate = cell.x + cell.y\n        return this.getDiagonalCells(boardState, king, attacker).filter(i => i.x + i.y !== cellCoordinate && i.side !== ChessLogic.sides.ME)\n      }\n    }\n\n    let attackingRooksOrQueens = this.getAttackingRooksOrQueens(boardState, cell, i, j)\n    if (attackingRooksOrQueens.length) {\n      attackingRooksOrQueens = this.filterAttackingRooksForPin(boardState, cell, king, attackingRooksOrQueens)\n      if (attackingRooksOrQueens.length) return []\n    }\n    return activeCells\n  }\n\n  getPossibleMovesForRook(boardState, cell, i, j, king = null) {\n    const activeCells = []\n    let cursorX = i\n    let cursorY = j\n    while (true) {\n      cursorX++\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorX--\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorY++\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n    cursorX = i\n    cursorY = j\n    while (true) {\n      cursorY--\n      let gotCell = this.getCell(boardState, cursorX, cursorY)\n      if (gotCell) {\n        if (!gotCell.figure) activeCells.push(gotCell)\n        else if (gotCell.side === ChessLogic.sides.OPPONENT) {\n          activeCells.push(gotCell)\n          break\n        } else {\n          break\n        }\n      } else break;\n    }\n\n    if (!king)\n      return activeCells\n\n    let attackingBishopsOrQueens = this.getAttackingBishopsOrQueens(boardState, cell, i, j)\n    if (attackingBishopsOrQueens.length) {\n      attackingBishopsOrQueens = this.filterAttackingBishopsForPin(boardState, cell, king, attackingBishopsOrQueens)\n      if (attackingBishopsOrQueens.length) return []\n\n    }\n\n    let attackingRooksOrQueens = this.getAttackingRooksOrQueens(boardState, cell, i, j)\n    if (attackingRooksOrQueens.length) {\n      attackingRooksOrQueens = this.filterAttackingRooksForPin(boardState, cell, king, attackingRooksOrQueens)\n      if (attackingRooksOrQueens.length) {\n        const attacker = attackingRooksOrQueens[0]\n        const cellCoordinate = cell.x + cell.y\n        return this.getHorizontalCells(boardState, king, attacker).filter(i => i.x + i.y !== cellCoordinate)\n      }\n    }\n    return activeCells\n  }\n\n  getPossibleMovesForQueen = (boardState, cell, i, j, kingCell) => {\n    const activeCells = []\n    activeCells.push(...this.getPossibleMovesForRook(boardState, cell, i, j, kingCell))\n    activeCells.push(...this.getPossibleMovesForBishop(boardState, cell, i, j, kingCell))\n    return activeCells\n  }\n\n  getCastlingMoves(boardState, cell, i, j, kingMoved, shortRookMoved, longRookMoved) {\n    let sign\n    if (cell.color === ChessLogic.colors.WHITE) {\n      sign = 1\n    } else {\n      sign = -1\n    }\n\n    const activeCells = []\n    if (!kingMoved) {\n      if (!shortRookMoved) {\n        const moves = [\n          this.getCell(boardState, i, j + (sign)),\n          this.getCell(boardState, i, j + (2 * sign)),\n        ]\n        const movesWithoutFigures = moves.filter(move => move && !move.figure)\n        const movesNotUnderAttack = movesWithoutFigures.filter(move => move && !this.isUnderAttack(boardState, move))\n\n        if (movesNotUnderAttack.length === 2) {\n          activeCells.push(this.getCell(boardState, i, j + (2 * sign)))\n        }\n      }\n      if (!longRookMoved) {\n        const moves = [\n          this.getCell(boardState, i, j - (sign)),\n          this.getCell(boardState, i, j - (2 * sign)),\n          this.getCell(boardState, i, j - (3 * sign)),\n        ]\n        const movesWithoutFigures = moves.filter(move => move && !move.figure)\n        const movesNotUnderAttack = movesWithoutFigures.filter(move => move && !this.isUnderAttack(boardState, move))\n\n        if (movesNotUnderAttack.length === 3) {\n          activeCells.push(this.getCell(boardState, i, j - (2 * sign)))\n        }\n      }\n    }\n    return activeCells\n  }\n\n  getAllMovesForKing(boardState, cell, i, j) {\n    return [\n      this.getCell(boardState, i - 1, j),\n      this.getCell(boardState, i + 1, j),\n\n      this.getCell(boardState, i, j + 1),\n      this.getCell(boardState, i, j - 1),\n\n      this.getCell(boardState, i + 1, j + 1),\n      this.getCell(boardState, i - 1, j + 1),\n\n      this.getCell(boardState, i + 1, j - 1),\n      this.getCell(boardState, i - 1, j - 1),\n    ].filter(move => !!move)\n\n  }\n\n  getPossibleMovesForKing(boardState, cell, i, j, kingMoved, shortRookMoved, longRookMoved) {\n    let kingMoves = this.getAllMovesForKing(boardState, cell, i, j)\n    const boardStateWithNoKing = boardState.map(_ => _.map(i => {\n      if (i.figure === ChessLogic.figures.KING && i.side === ChessLogic.sides.ME) {\n        return {\n          ...i,\n          figure: null,\n          side: null,\n          color: null\n        }\n\n      }\n      return i\n    }))\n    kingMoves = kingMoves.filter(move => {\n      return (!move.figure || move.side === ChessLogic.sides.OPPONENT) && !this.isUnderAttack(boardStateWithNoKing, move)\n    })\n\n    kingMoves.push(...this.getCastlingMoves(boardState, cell, i, j, kingMoved, shortRookMoved, longRookMoved))\n\n    return kingMoves\n  }\n\n  // *** GET MOVES FOR FIGURES METHODS END *** //\n\n  // *** GET POSSIBLE MOVES METHODS *** //\n\n  getLegalMovesDuringCheck(boardState, kingCell, attackers) {\n    const legalMoves = []\n\n    if (attackers.length === 1) {\n      const attacker = attackers[0]\n      if (attacker.figure === ChessLogic.figures.PAWN || attacker.figure === ChessLogic.figures.HORSE) {\n        legalMoves.push(attacker)\n      } else {\n        legalMoves.push(...this.getDiagonalCells(boardState, kingCell, attacker))\n        legalMoves.push(...this.getHorizontalCells(boardState, kingCell, attacker))\n      }\n    }\n\n    return legalMoves\n  }\n\n  getPossibleMoves(boardState, previousMove, cell, kingMoved, shortRookMoved, longRookMoved) {\n    let activeCells = []\n    const i = this.rows.indexOf(Number(cell.y))\n    const j = this.columns.indexOf(cell.x)\n    const kingCell = this.getKing(boardState)\n    const isCheck = this.isUnderAttack(boardState, kingCell)\n\n    switch (cell.figure) {\n      case (ChessLogic.figures.PAWN):\n        activeCells.push(...this.getPossibleMovesForPawn(boardState, previousMove, cell, i, j, kingCell))\n        break;\n      case (ChessLogic.figures.HORSE):\n        activeCells.push(...this.getPossibleMovesForHorse(boardState, cell, i, j, kingCell))\n        break;\n      case (ChessLogic.figures.BISHOP):\n        activeCells.push(...this.getPossibleMovesForBishop(boardState, cell, i, j, kingCell))\n        break;\n      case (ChessLogic.figures.ROOK):\n        activeCells.push(...this.getPossibleMovesForRook(boardState, cell, i, j, kingCell))\n        break;\n      case (ChessLogic.figures.QUEEN):\n        activeCells.push(...this.getPossibleMovesForQueen(boardState, cell, i, j, kingCell))\n        break;\n      case (ChessLogic.figures.KING):\n        activeCells.push(...this.getPossibleMovesForKing(boardState, cell, i, j, kingMoved, shortRookMoved, longRookMoved))\n        break;\n    }\n\n    if (isCheck) {\n      const attackers = this.getAttackers(boardState, kingCell)\n      const legalMovesDuringCheck = this.getLegalMovesDuringCheck(boardState, kingCell, attackers)\n      const legalMovesCoordinates = legalMovesDuringCheck.map(i => i.x + i.y)\n\n      if (cell.figure !== ChessLogic.figures.KING) {\n        activeCells = activeCells.filter(aCell => legalMovesCoordinates.includes(aCell.x + aCell.y))\n      }\n\n    }\n\n    return activeCells\n  }\n\n  // *** GET POSSIBLE MOVES METHODS END *** //\n\n  // *** CHECK MOVES METHODS END *** //\n\n  checkCastlingMoves(boardState, from, to) {\n    let fromTwo, toTwo\n    const fromJ = this.columns.indexOf(from.x)\n    const toI = this.rows.indexOf(Number(to.y))\n    const toJ = this.columns.indexOf(to.x)\n    const rules = new ChessLogic(this.rows, this.columns)\n\n    if (from.figure === ChessLogic.figures.KING) {\n      if (fromJ - toJ === -2) {\n        fromTwo = rules.getCell(boardState, toI, 7)\n        toTwo = rules.getCell(boardState, toI, fromJ + 1)\n      } else if (fromJ - toJ === 2) {\n        fromTwo = rules.getCell(boardState, toI, 0)\n        toTwo = rules.getCell(boardState, toI, toJ + 1)\n      }\n    }\n\n    return [fromTwo, toTwo]\n  }\n\n  checkAnPassant(boardState, from, to) {\n    const i = this.rows.indexOf(Number(to.y))\n    const j = this.columns.indexOf(to.x)\n    if (from.figure === ChessLogic.figures.PAWN && from.x !== to.x && !to.figure) {\n      return new ChessLogic(this.rows, this.columns).getCell(boardState, i + 1, j)\n    }\n  }\n\n  checkQueen(boardState, from, to) {\n    const fromY = this.rows.indexOf(Number(from.y))\n    const toY = this.rows.indexOf(Number(to.y))\n\n    return ((fromY === 1 && toY === 0) || (fromY === 6 && toY === 7)) && from.figure === ChessLogic.figures.PAWN\n  }\n}\n\nexport {\n  ChessLogic\n}\n","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport {ChessLogic} from \"./ChessLogic\";\n\nimport './Chessboard.scss'\n\nconst Chessboard = ({\n                      boardState,\n                      setBoardState,\n                      makeMove,\n                      hideMoves,\n                      rows,\n                      columns,\n                      isPlayingAsWhite,\n                      isWhiteTurn,\n                      previousMove,\n                      castingInfo: {\n                        whiteKingMoved,\n                        blackKingMoved,\n                        whiteShortRookMoved,\n                        blackShortRookMoved,\n                        whiteLongRookMoved,\n                        blackLongRookMoved\n                      }\n                    }) => {\n\n  const [clickedCell, setClickedCell] = useState(null)\n\n  const showPossibleMoves = (cell) => {\n    const kingMoved = cell.color === ChessLogic.colors.WHITE ? whiteKingMoved : blackKingMoved\n    const shortRookMoved = cell.color === ChessLogic.colors.WHITE ? whiteShortRookMoved : blackShortRookMoved\n    const longRookMoved = cell.color === ChessLogic.colors.WHITE ? whiteLongRookMoved : blackLongRookMoved\n    const activeCells = new ChessLogic(rows, columns).getPossibleMoves(boardState, previousMove, cell, kingMoved, shortRookMoved, longRookMoved)\n    const activeCellsCoordinates = activeCells.map(i => i.x + i.y)\n\n    setBoardState(boardState.map(_ => _.map(i => {\n      i.possibleMove = activeCellsCoordinates.includes(i.x + i.y);\n      return i\n    })))\n  }\n\n  const handleClick = (cell) => {\n    if (cell.possibleMove) {\n      if ((isWhiteTurn && isPlayingAsWhite) || (!isWhiteTurn && !isPlayingAsWhite)) {\n        makeMove(clickedCell, cell)\n      }\n    } else {\n      if (cell.figure && cell.side === ChessLogic.sides.ME) {\n        setClickedCell(cell)\n        showPossibleMoves(cell)\n      } else {\n        setClickedCell(null)\n        hideMoves(boardState)\n      }\n    }\n  }\n\n  let isBlack = true;\n\n  return (\n    <div className={\"chessboard-holder\"}>\n      {\n        boardState.map((i, rowIndex) => {\n          isBlack = !isBlack\n          return i.map((cell, index) => {\n            const img = new ChessLogic(rows, columns).getImg(cell.figure + cell.color)\n\n            let el = (\n              <div onClick={() => handleClick(cell)} key={cell.x + cell.y}\n                   className={`chessboard-cell ${isBlack ? \"black\" : \"white\"}`}>\n\n                <div className={`chess-number ${index === 0 ? \"visible\" : \"\"}`}>{cell.y}</div>\n                <div className={`chess-letter ${rowIndex === 7 ? \"visible\" : \"\"}`}>{cell.x}</div>\n\n                {img && <img className={\"chess-piece-img\"} src={img} alt=\"\"/>}\n\n                <span className={`point ${cell.possibleMove ? \"active\" : \"\"}`}/>\n\n              </div>\n            )\n            isBlack = !isBlack\n            return el\n          })\n        })\n      }\n    </div>\n  );\n}\n\n\nChessboard.propTypes = {\n  boardState: PropTypes.array.isRequired,\n  setBoardState: PropTypes.func.isRequired,\n  makeMove: PropTypes.func.isRequired,\n  hideMoves: PropTypes.func.isRequired,\n  rows: PropTypes.array.isRequired,\n  columns: PropTypes.array.isRequired,\n  isPlayingAsWhite: PropTypes.bool.isRequired,\n  isWhiteTurn: PropTypes.bool.isRequired,\n  previousMove: PropTypes.object.isRequired,\n  castingInfo: PropTypes.object.isRequired,\n}\n\nexport default Chessboard;","import React, {useEffect, useRef, useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport Chessboard from \"./Chessboard\";\nimport {ChessLogic} from \"./ChessLogic\";\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome'\nimport {faArrowsRotate, faRepeat, faLeftLong, faRightLong} from '@fortawesome/free-solid-svg-icons'\n\nimport './Chessboard.scss'\nimport {useUser} from \"../../../../../hooks/useUser\";\nimport {useSocket} from \"../../../../../hooks/useSocket\";\n\nconst ChessboardSlide = ({room, visible}) => {\n  const {user: {type: usertype}} = useUser();\n\n  const [whiteKingMoved, setWhiteKingMoved] = useState(false)\n  const [blackKingMoved, setBlackKingMoved] = useState(false)\n  const [whiteShortRookMoved, setWhiteShortRookMoved] = useState(false)\n  const [blackShortRookMoved, setBlackShortRookMoved] = useState(false)\n  const [whiteLongRookMoved, setWhiteLongRookMoved] = useState(false)\n  const [blackLongRookMoved, setBlackLongRookMoved] = useState(false)\n\n  const [isPlayingAsWhite, setIsPlayingAsWhite] = useState(true)\n  const [isWhiteTurn, setIsWhiteTurn] = useState(true)\n  const [activeSwitch, setActiveSwitch] = useState(false)\n\n  const [rows, setRows] = useState([8, 7, 6, 5, 4, 3, 2, 1])\n  const [columns, setColumns] = useState([\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\"])\n  const [desk, setDesk] = useState(rows.map(i => columns.map(j => `${j}${i}`)))\n\n  const [previousMoves, setPreviousMoves] = useState([])\n  const [takenBackMoves, setTakenBackMoves] = useState([])\n\n  const [boardState, setBoardState] = useState(desk.map(_ => _.map(i => {\n    return new ChessLogic(rows, columns).prepareCellInitialState(i, isPlayingAsWhite)\n  })))\n\n  const stateRef = useRef(boardState);\n  React.useEffect(() => {\n    stateRef.current = boardState;\n  }, [boardState]);\n\n  const previousMovesRef = useRef(previousMoves);\n  React.useEffect(() => {\n    previousMovesRef.current = previousMoves;\n  }, [previousMoves]);\n\n  const takenBackMovesRef = useRef(takenBackMoves);\n  React.useEffect(() => {\n    takenBackMovesRef.current = takenBackMoves;\n  }, [takenBackMoves]);\n\n  const isPlayingAsWhiteRef = useRef(isPlayingAsWhite);\n  React.useEffect(() => {\n    isPlayingAsWhiteRef.current = isPlayingAsWhite;\n  }, [isPlayingAsWhite]);\n\n  useEffect(() => {\n    if (!activeSwitch) {\n      setActiveSwitch(true)\n      return\n    }\n    const oldRows = [...rows]\n    const oldColumns = [...columns]\n    const newRows = rows.reverse()\n    const newColumns = columns.reverse()\n    const oldState = boardState\n    const newDesk = newRows.map(i => newColumns.map(j => `${j}${i}`))\n\n    setBoardState(newDesk.map(_ => _.map(field => {\n\n      const [x, y] = field.split(\"\")\n      const i = oldRows.indexOf(Number(y))\n      const j = oldColumns.indexOf(x)\n      const logic = new ChessLogic(rows, columns)\n\n      const cell = logic.getCell(oldState, i, j)\n\n      let side\n      if (isPlayingAsWhite) {\n        if (cell.color === ChessLogic.colors.WHITE) {\n          side = ChessLogic.sides.ME\n        } else if (cell.color === ChessLogic.colors.BLACK) {\n          side = ChessLogic.sides.OPPONENT\n        } else {\n          side = null\n        }\n      } else {\n        if (cell.color === ChessLogic.colors.WHITE) {\n          side = ChessLogic.sides.OPPONENT\n        } else if (cell.color === ChessLogic.colors.BLACK) {\n          side = ChessLogic.sides.ME\n        } else {\n          side = null\n        }\n      }\n\n      return {\n        ...cell,\n        side: side\n      }\n    })))\n\n    setRows(newRows)\n    setColumns(newColumns)\n    setDesk(newDesk)\n\n  }, [isPlayingAsWhite])\n\n  const {socket} = useSocket();\n\n  useEffect(() => {\n    socket.on(\"move-made\", ({from, to}) => {\n      moveMade(from, to)\n    })\n\n    socket.on(\"sides-switched\", ({isWhite}) => {\n      setIsPlayingAsWhite(isWhite)\n    })\n\n    socket.on(\"new-game-started\", ({isPlayingAsWhite: isWhite}) => {\n      setIsPlayingAsWhite(isWhite)\n      newGameStarted(isWhite)\n    })\n\n    socket.on(\"move-taken-back\", ({previousMove: pMove}) => {\n      moveTakenBack(pMove)\n    })\n\n    startNewGame()\n  }, [])\n\n  const checkCastlingRights = (from) => {\n    if (from.figure === ChessLogic.figures.KING) {\n      if (from.color === ChessLogic.colors.WHITE) {\n        setWhiteKingMoved(true)\n      } else {\n        setBlackKingMoved(true)\n      }\n    }\n    if (from.figure === ChessLogic.figures.ROOK && from.x === \"a\") {\n      if (from.color === ChessLogic.colors.WHITE) {\n        setWhiteShortRookMoved(true)\n      } else {\n        setBlackShortRookMoved(true)\n      }\n    }\n    if (from.figure === ChessLogic.figures.ROOK && from.x === \"h\") {\n      if (from.color === ChessLogic.colors.WHITE) {\n        setWhiteLongRookMoved(true)\n      } else {\n        setBlackLongRookMoved(true)\n      }\n    }\n  }\n\n  const hideMoves = (state) => {\n    setBoardState(state.map(_ => _.map(i => {\n      i.possibleMove = false;\n      return i\n    })))\n  }\n\n  const makeMove = (from, to) => {\n    socket.emit(\"chess-make-move\", {room, from, to});\n  }\n\n  const moveMade = (from, to) => {\n    const state = stateRef.current\n    const pMoves = previousMovesRef.current\n    const logic = new ChessLogic(rows, columns)\n    const [fromTwo, toTwo] = logic.checkCastlingMoves(state, from, to)\n    const isQueen = logic.checkQueen(state, from, to)\n    checkCastlingRights(from)\n    const anPassant = logic.checkAnPassant(state, from, to)\n    setPreviousMoves([...pMoves, {\n      from,\n      to,\n      figure: from.figure,\n      anPassant,\n      fromTwo,\n      toTwo,\n      isCastle: !!fromTwo,\n      isAnPassant: !!anPassant\n    }])\n    hideMoves(state)\n    setStateMakeMove(from, to, fromTwo, toTwo, anPassant, state, isQueen)\n    setIsWhiteTurn(from.color === ChessLogic.colors.BLACK)\n  }\n\n  const setStateMakeMove = (from, to, fromTwo, toTwo, anPassant, state, isQueen) => {\n    const isWhite = isPlayingAsWhiteRef.current;\n    const toFigure = isQueen ? ChessLogic.figures.QUEEN : from.figure\n    const WHITE = ChessLogic.colors.WHITE\n    const BLACK = ChessLogic.colors.BLACK\n    const ME = ChessLogic.sides.ME\n    const OPPONENT = ChessLogic.sides.OPPONENT\n\n    setBoardState(state.map(_ => _.map(i => {\n      if (i.x === from.x && i.y === from.y) return {...i, figure: null, side: null, color: null}\n      if (i.x === to.x && i.y === to.y) {\n        let color = from.color\n        let side = (color === WHITE && isWhite) || (color === BLACK && !isWhite) ? ME : OPPONENT\n        return {...i, figure: toFigure, side: side, color: from.color}\n      }\n      if (fromTwo && i.x === fromTwo.x && i.y === fromTwo.y) return {...i, figure: null, side: null, color: null}\n      if (toTwo && i.x === toTwo.x && i.y === toTwo.y){\n        let color = fromTwo.color\n        let side = (color === WHITE && isWhite) || (color === BLACK && !isWhite) ? ME : OPPONENT\n        return {...i, figure: fromTwo.figure, side: side, color: fromTwo.color}\n      }\n      if (anPassant && i.x === anPassant.x && i.y === anPassant.y)\n        return {...i, figure: null, side: null, color: null}\n\n      return i\n    })))\n  }\n\n  const startNewGame = () => {\n    socket.emit(\"start-new-game\", {room, isPlayingAsWhite});\n  }\n\n  const newGameStarted = (isWhite) => {\n    let newRows\n    let newColumns\n    if (isWhite) {\n      newRows = [8, 7, 6, 5, 4, 3, 2, 1]\n      newColumns = [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\"]\n    } else {\n      newRows = [8, 7, 6, 5, 4, 3, 2, 1].reverse()\n      newColumns = [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\"].reverse()\n    }\n    const newDesk = newRows.map(i => newColumns.map(j => `${j}${i}`))\n\n    setBoardState(newDesk.map(_ => _.map(i => {\n      return new ChessLogic(newRows, newColumns).prepareCellInitialState(i, isWhite)\n    })))\n    setIsWhiteTurn(true)\n  }\n\n  const switchSides = () => {\n    socket.emit(\"switch-sides\", {room, isPlayingAsWhite: !isPlayingAsWhite});\n  }\n\n  const takeMoveBack = () => {\n    if (previousMoves.length === 0) return\n    const previousMove = previousMoves[previousMoves.length - 1]\n    socket.emit(\"take-move-back\", {room, previousMove, state: boardState, previousMoves, takenBackMoves});\n  }\n\n  const moveTakenBack = (pMove) => {\n    const state = stateRef.current\n    const pMoves = previousMovesRef.current\n    const tbMoves = takenBackMovesRef.current\n    const WHITE = ChessLogic.colors.WHITE\n    const BLACK = ChessLogic.colors.BLACK\n    const ME = ChessLogic.sides.ME\n    const OPPONENT = ChessLogic.sides.OPPONENT\n\n    if (pMove.isCastle) {\n      if (pMove.fromTwo.color === WHITE) {\n        setWhiteKingMoved(false)\n      } else {\n        setBlackKingMoved(false)\n      }\n      if (pMove.fromTwo.x === \"h\") {\n        if (pMove.fromTwo.color === WHITE) {\n          setWhiteShortRookMoved(false)\n        } else {\n          setBlackShortRookMoved(false)\n        }\n      } else {\n        if (pMove.fromTwo.color === WHITE) {\n          setWhiteLongRookMoved(false)\n        } else {\n          setBlackLongRookMoved(false)\n        }\n      }\n    }\n\n    setBoardState(state.map(_ => _.map(i => {\n      if (i.x === pMove.from.x && i.y === pMove.from.y) {\n        let color = pMove.from.color\n        let side = (color === WHITE && isPlayingAsWhite) || (color === BLACK && !isPlayingAsWhite) ? ME : OPPONENT\n        side = color ? side : null\n        return {...i, figure: pMove.from.figure, side: side, color: pMove.from.color}\n      }\n      if (i.x === pMove.to.x && i.y === pMove.to.y) {\n        let color = pMove.to.color\n        let side = (color === WHITE && isPlayingAsWhite) || (color === BLACK && !isPlayingAsWhite) ? ME : OPPONENT\n        side = color ? side : null\n        return {...i, figure: pMove.to.figure, side: side, color: pMove.to.color}\n      }\n      if (pMove.isCastle && i.x === pMove.fromTwo.x && i.y === pMove.fromTwo.y) {\n        let color = pMove.fromTwo.color\n        let side = (color === WHITE && isPlayingAsWhite) || (color === BLACK && !isPlayingAsWhite) ? ME : OPPONENT\n        side = color ? side : null\n        return {...i, figure: pMove.fromTwo.figure, side: side, color: pMove.fromTwo.color}\n      }\n      if (pMove.isCastle && i.x === pMove.toTwo.x && i.y === pMove.toTwo.y) {\n        let color = pMove.toTwo.color\n        let side = (color === WHITE && isPlayingAsWhite) || (color === BLACK && !isPlayingAsWhite) ? ME : OPPONENT\n        side = color ? side : null\n        return {...i, figure: pMove.toTwo.figure, side: side, color: pMove.toTwo.color}\n      }\n      if (pMove.isAnPassant && i.x === pMove.anPassant.x && i.y === pMove.anPassant.y) {\n        let color = pMove.anPassant.color\n        let side = (color === WHITE && isPlayingAsWhite) || (color === BLACK && !isPlayingAsWhite) ? ME : OPPONENT\n        side = color ? side : null\n        return {...i, figure: pMove.anPassant.figure, side: side, color: pMove.anPassant.color}\n      }\n      return i\n    })))\n\n    setIsWhiteTurn(pMove.from.color === ChessLogic.colors.WHITE)\n    setPreviousMoves(pMoves.slice(0, -1))\n    setTakenBackMoves([...tbMoves, pMove])\n  }\n\n  const unTakeMoveBack = () => {\n    if (takenBackMoves.length === 0) return\n    const logic = new ChessLogic(rows, columns)\n    const previousMove = takenBackMoves[takenBackMoves.length - 1]\n\n    const fromJ = columns.indexOf(previousMove.from.x)\n    const fromI = rows.indexOf(Number(previousMove.from.y))\n    const toJ = columns.indexOf(previousMove.to.x)\n    const toI = rows.indexOf(Number(previousMove.to.y))\n\n    const fromCell = logic.getCell(boardState, fromI, fromJ)\n    const toCell = logic.getCell(boardState, toI, toJ)\n\n    makeMove(fromCell, toCell)\n    setTakenBackMoves(takenBackMoves.slice(0, -1))\n  }\n\n  return (\n    <div className={`chess-slide ${!visible ? 'hidden' : ''}`}>\n      {usertype && <div className={\"chess-buttons\"}>\n        <div className={\"chess-button\"} title=\"Новая игра\" onClick={() => startNewGame()}><FontAwesomeIcon\n          icon={faArrowsRotate}/></div>\n        <div className={\"chess-button\"} title=\"Поменять стороны\" onClick={() => switchSides()}><FontAwesomeIcon\n          icon={faRepeat}/></div>\n        <div className={\"chess-button\"} title=\"Отменить предыдущий ход\" onClick={() => takeMoveBack()}><FontAwesomeIcon\n          icon={faLeftLong}/></div>\n        <div className={\"chess-button\"} title=\"Повторить отмененный ход\" onClick={() => unTakeMoveBack()}>\n          <FontAwesomeIcon icon={faRightLong}/></div>\n      </div>}\n\n      <Chessboard\n        boardState={boardState}\n        setBoardState={setBoardState}\n        makeMove={makeMove}\n        hideMoves={hideMoves}\n        rows={rows}\n        columns={columns}\n        isPlayingAsWhite={isPlayingAsWhite}\n        isWhiteTurn={isWhiteTurn}\n        previousMove={previousMoves.length > 0 ? previousMoves[previousMoves.length - 1] : {}}\n        castingInfo={{\n          whiteKingMoved,\n          blackKingMoved,\n          whiteShortRookMoved,\n          blackShortRookMoved,\n          whiteLongRookMoved,\n          blackLongRookMoved\n        }}\n      />\n    </div>\n  );\n}\n\nChessboardSlide.propTypes = {\n  room: PropTypes.string.isRequired,\n  visible: PropTypes.bool,\n}\n\nexport default ChessboardSlide;","import React, {useState} from 'react';\nimport PropTypes from \"prop-types\";\nimport P5Wrapper from \"react-p5-wrapper\";\nimport sketch from \"./Sketch\";\n\nimport AbacusSlide from \"./Abacus/AbacusSlide\";\nimport ChessboardSlide from \"./Chessboard/ChessboardSlide\";\nimport {useSocket} from \"../../../../hooks/useSocket\";\nimport {useUser} from \"../../../../hooks/useUser\";\n\nconst Canvas = ({room, img, hasChessboard, hasAbacus, activeTool, drawWidth, drawColor, active}) => {\n  const {socket} = useSocket();\n  const {getUser} = useUser();\n  const [width, setWidth] = useState('100px');\n  // const [width, setWidth] = useState('800px');\n  const [height, setHeight] = useState('100px');\n  // const [height, setHeight] = useState('800px');\n  const canvasBackground = React.createRef();\n\n  const onImgLoad = ({target: img}) => {\n    const maxHeight = canvasBackground.current.offsetHeight;\n    const maxWidth = canvasBackground.current.offsetWidth;\n    const padding = window.innerWidth > 1300 ? '4em' : '.3em'\n    const maxProportion = maxWidth / maxHeight;\n    const imageProportion = img.width / img.height;\n\n    let proportion = 1;\n\n    if (img.height > maxHeight || img.width > maxWidth) {\n      if (maxProportion >= imageProportion) {\n        proportion = img.height / img.width;\n\n        setHeight(`calc(${maxHeight}px - ${padding})`)\n        setWidth(`calc((${maxHeight}px - ${padding}) / ${proportion})`);\n      } else {\n        proportion = img.width / img.height;\n\n        setWidth(`calc(${maxWidth}px - ${padding})`)\n        setHeight(`calc((${maxWidth}px - ${padding}) / ${proportion})`);\n      }\n    } else {\n      setWidth(img.width);\n      setHeight(img.height);\n    }\n    const user = getUser();\n    socket.emit(\"image-loaded\", {login: user.login});\n  }\n\n  return (\n\n    <div className={'canvas-background'} ref={canvasBackground}>\n\n      <div className={`canvas-border ${img ? '' : 'hidden'}`}>\n\n        <img className={'slide-img'} src={img} alt=\"Картинка для слайда не загрузилась\" onLoad={onImgLoad}/>\n\n        <div id='mainCanvas' className={'canvas'}\n             style={{\n               backgroundImage: img ? `url(${img})` : 'none',\n               width: width,\n               height: height\n             }}\n        >\n          <AbacusSlide visible={hasAbacus} room={room}/>\n          <ChessboardSlide visible={hasChessboard} room={room}/>\n          {/*<ChessboardSlide visible={hasChessboard || true} room={room}/>*/}\n\n          <P5Wrapper\n            sketch={sketch}\n            socket={socket}\n            room={room}\n\n            width={parseInt(width)}\n            height={parseInt(height)}\n\n            active={active}\n            activeTool={activeTool}\n            drawWidth={drawWidth}\n            drawColor={drawColor}\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nCanvas.propTypes = {\n  room: PropTypes.string.isRequired,\n  img: PropTypes.string,\n  slideType: PropTypes.string,\n  hasAbacus: PropTypes.bool,\n  active: PropTypes.bool.isRequired,\n  activeTool: PropTypes.string.isRequired,\n  drawWidth: PropTypes.number.isRequired,\n  drawColor: PropTypes.string.isRequired,\n}\n\nexport default Canvas;\n\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport './Switch.scss'\n\nconst Switch = ({labelOne, labelTwo, onChange, valueOne, valueTwo}) => {\n  const switchChange = (checked) => {\n    onChange(checked ? valueTwo : valueOne);\n  }\n\n  return (\n    <div className=\"switch\">\n      {labelOne !== '' ? <div className=\"label\">{labelOne}</div> : ''}\n\n      <label className=\"toggle-control\">\n        <input type=\"checkbox\" onChange={e => switchChange(e.target.checked)}/>\n        <span className=\"control\"/>\n      </label>\n\n      {labelTwo !== '' ? <div className=\"label\">{labelTwo}</div> : ''}\n    </div>\n  );\n}\n\nSwitch.propTypes = {\n  labelOne: PropTypes.string.isRequired,\n  labelTwo: PropTypes.string.isRequired,\n  valueOne: PropTypes.any.isRequired,\n  valueTwo: PropTypes.any.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default Switch;","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport './InlinePicker.scss';\n\nconst InlinePicker = ({defaultValue, values, valueField, onChangeComplete}) => {\n  const defItem = values.find((i) => i[valueField] === defaultValue)\n\n  const [activeItem, setActiveItem] = useState(defItem)\n  return (\n\n    <div className={'inline-picker-wrapper'}>\n      <div className={'p-item-picker-wrapper'}>\n\n        {values.map(i =>\n          <div onClick={\n            () => {\n              onChangeComplete(i[valueField]);\n              setActiveItem(i);\n            }\n          } className={`p-item-wrapper ${activeItem.value === i.value ? 'active' : ''}`} key={i[valueField]}>\n            <span className={`p-item size${i[valueField]}`}/>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nInlinePicker.propTypes = {\n  defaultValue: PropTypes.any.isRequired,\n  values: PropTypes.array.isRequired,\n  valueField: PropTypes.string.isRequired,\n  onChangeComplete: PropTypes.func.isRequired,\n}\n\nexport default InlinePicker;","import React, {useState} from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport './InlineColorPicker.scss';\n\nconst InlineColorPicker = ({color, onChangeComplete}) => {\n  const [activeColor, setActiveColor] = useState(color)\n  let colors = [\n    'red',\n    'blue',\n    'yellow',\n    'green',\n  ]\n\n  return (\n\n    <div className={'inline-color-picker-wrapper'}>\n      <div className={'p-item-picker-wrapper'}>\n\n        {colors.map(i =>\n          <div onClick={\n            () => {\n              onChangeComplete(i);\n              setActiveColor(i);\n            }\n          } className={`p-item-wrapper ${activeColor === i ? 'active' : ''}`} key={i}>\n            <span className={`p-item ${i}`}/>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nInlineColorPicker.propTypes = {\n  color: PropTypes.any.isRequired,\n  onChangeComplete: PropTypes.func.isRequired,\n}\n\nexport default InlineColorPicker;","import React, {useState} from 'react';\nimport PropTypes from \"prop-types\";\nimport {FaPencilAlt, FaEraser, FaSyncAlt, FaMousePointer, FaClock, FaMinusCircle} from 'react-icons/fa';\n\nimport {Interval} from \"../../../../utils/interval\";\nimport Switch from \"../../../ui/Switch\";\nimport {TOOLS} from \"../../../../utils/types\";\nimport {useUser} from \"../../../../hooks/useUser\";\nimport {useSocket} from \"../../../../hooks/useSocket\";\nimport InlinePicker from \"../../../ui/InlinePicker\";\nimport InlineColorPicker from \"../../../ui/InlineColorPicker\";\n\n\nconst ToolPanel = ({activeTool, setActiveTool, defWidth, setDrawWidth, defColor, setDrawColor}) => {\n\n  const {socket} = useSocket();\n\n  const {user: {type: usertype, login}} = useUser();\n\n  const displayTeacherTools = usertype === 'teacher';\n\n\n  const [timerRunning, setTimerRunning] = useState(false);\n  const [minute, setMinute] = useState(0);\n  const [second, setSecond] = useState(0);\n\n  const resetTimer = () => {\n    setSecond(0);\n    setMinute(0);\n    setTimerRunning(false);\n  }\n\n  const setStudentAllowedToDraw = (isEnabled) => {\n    socket.emit(\"set-drawing-enabled\", {login, isEnabled});\n  }\n\n  const resetStudentCanvas = () => {\n    socket.emit(\"reset-canvas\", {teacherLogin: login});\n  }\n\n  Interval(() => {\n    if (second < 59) {\n      setSecond(second + 1);\n    } else {\n      setSecond(0);\n      setMinute(minute + 1);\n    }\n  }, timerRunning ? 1000 : null)\n\n  return (\n\n    <div className={\"tool-panel\"}>\n      <InlinePicker\n        defaultValue={defWidth}\n        valueField={'value'}\n        labelField={'label'}\n        values={[\n          {label: '2px', value: 2},\n          {label: '5px', value: 5},\n          {label: '8px', value: 8},\n        ]}\n        onChangeComplete={\n          width => {\n            setDrawWidth(width)\n          }\n        }\n      />\n\n      <div className={'tool-panel-divider'}/>\n      <InlineColorPicker\n        color={defColor}\n        onChangeComplete={\n          color => {\n            setDrawColor(color);\n          }\n        }\n      />\n\n      <div className={'tool-panel-divider'}/>\n\n      <div className={'tools-buttons'}>\n        <div className={`tool-btn salad ${activeTool === TOOLS.PENCIL ? 'active' : ''}`} onClick={() => {\n          setActiveTool(TOOLS.PENCIL)\n        }}><FaPencilAlt/></div>\n\n        <div className={`tool-btn salad ${activeTool === TOOLS.ERASER ? 'active' : ''}`} onClick={() => {\n          setActiveTool(TOOLS.ERASER)\n        }}><FaEraser/></div>\n\n        {displayTeacherTools &&\n        <div className={`tool-btn salad ${activeTool === TOOLS.CURSOR ? 'active' : ''}`} onClick={() => {\n          setActiveTool(TOOLS.CURSOR)\n        }}><FaMousePointer/></div>}\n\n        {displayTeacherTools && <div className={'tool-btn green'} onClick={() => {\n          setTimerRunning(!timerRunning);\n        }}><FaClock/></div>}\n\n        {displayTeacherTools &&\n        <div className={'time-holder'}>\n          <span className={'minute'}>{minute < 10 ? '0' + minute : minute}</span>\n          <span className={'colon'}>:</span>\n          <span className={'seconds'}>{second < 10 ? '0' + second : second}</span>\n        </div>}\n        {displayTeacherTools && <div className={'tool-btn red'} onClick={() => {\n          resetTimer();\n        }}><FaMinusCircle/></div>\n        }\n\n        {displayTeacherTools && <Switch labelOne=\"\" labelTwo=\"\" valueOne={true} valueTwo={false}\n                                        onChange={(value) => setStudentAllowedToDraw(value)}/>}\n\n        {displayTeacherTools &&\n        <div className={'tool-btn salad'} onClick={() => resetStudentCanvas()}><FaSyncAlt/></div>}\n\n      </div>\n    </div>\n  )\n}\n\nToolPanel.propTypes = {\n  activeTool: PropTypes.string.isRequired,\n  setActiveTool: PropTypes.func.isRequired,\n  defWidth: PropTypes.number.isRequired,\n  setDrawWidth: PropTypes.func.isRequired,\n  defColor: PropTypes.string.isRequired,\n  setDrawColor: PropTypes.func.isRequired,\n}\n\nexport default ToolPanel;","import { useEffect, useRef } from 'react'\n\nexport const Interval = (callback, delay) => {\n  const savedCallback = useRef(callback)\n\n  // Remember the latest callback if it changes.\n  useEffect(() => {\n    savedCallback.current = callback\n  }, [callback])\n\n  // Set up the interval.\n  useEffect(() => {\n    // Don't schedule if no delay is specified.\n    if (delay === null) {\n      return\n    }\n\n    const id = setInterval(() => savedCallback.current(), delay)\n\n    return () => clearInterval(id)\n  }, [delay])\n}\n","import React, { createContext, useState, useEffect } from 'react';\nimport {useSocket} from \"../hooks/useSocket\";\nimport { useAlert } from 'react-alert'\n\n\nconst TeacherContext = createContext('');\n\nconst TeacherContextProvider = ({ children }) => {\n  const alert = useAlert()\n  const {socket} = useSocket()\n\n  const [waitingScreen, setWaitingScreen] = useState(false);\n  const [waitingScreenMessage, setWaitingScreenMessage] = useState('');\n  const [allowedStudent, setAllowedStudent] = useState();\n  const [slide, setSlide] = useState({});\n\n  useEffect(() => {\n\n    socket.on('student-requests-entrance', ({name}) => {\n      alert.show(`Ученик ${name} отправил запрос на вход в класную комнату`, 'primary')\n    })\n\n    socket.on('allowed-student-set', ({login}) => {\n      setAllowedStudent(login)\n    })\n\n    socket.on('canvas-slide-picked', ({slide}) => {\n      setSlide(slide);\n    })\n\n    socket.on('teacher-joined', () => {\n      setWaitingScreen(false);\n      setWaitingScreenMessage('')\n    })\n\n  }, [alert, socket]);\n\n  return (\n    <TeacherContext.Provider value={{\n      waitingScreen,\n      waitingScreenMessage,\n      slide,\n      // type,\n      allowedStudent,\n    }}\n    >\n      {children}\n    </TeacherContext.Provider>\n  );\n};\n\nexport { TeacherContextProvider, TeacherContext };\n","import React, {createContext, useState, useEffect} from 'react';\n\nimport {useSocket} from \"../hooks/useSocket\";\nimport {useUser} from \"../hooks/useUser\";\n\nconst StudentContext = createContext('');\n\nconst StudentContextProvider = ({children}) => {\n  const {socket} = useSocket();\n  const {getUser} = useUser();\n\n\n  const [waitingScreen, setWaitingScreen] = useState(false);\n  const [waitingScreenMessage, setWaitingScreenMessage] = useState('');\n  const [slide, setSlide] = useState({});\n  const [allowedToDraw, setAllowedToDraw] = useState(true);\n\n\n  useEffect(() => {\n\n    socket.on('student-disallowed', ({name}) => {\n\n      setWaitingScreen(true);\n      setWaitingScreenMessage(`Отправлен запрос на вход в классную комнату учителю ${name}`)\n    })\n\n    socket.on('student-allowed', ({teacher}) => {\n      const user = getUser()\n      socket.emit('join-student', {room: teacher, login: user.login});\n    })\n\n    socket.on('teacher-absent', ({name}) => {\n      setWaitingScreen(true);\n      setWaitingScreenMessage(`Учитель ${name} отсутствует на рабочем месте`)\n    })\n\n    socket.on('teacher-present', ({login: teacherLogin}) => {\n      const user = getUser()\n      setWaitingScreen(false);\n      setWaitingScreenMessage('')\n      socket.emit('join-student', {room: teacherLogin, login: user.login});\n    })\n\n    socket.on('student-joined', () => {\n      setWaitingScreen(false);\n      setWaitingScreenMessage('')\n    })\n\n    socket.on('canvas-slide-changed', ({slide}) => {\n      setSlide(slide);\n    })\n\n    socket.on('drawing-enabled-set', ({isEnabled: allowStudentToDraw}) => {\n      setAllowedToDraw(allowStudentToDraw);\n    })\n\n  }, []);\n\n\n  return (\n    <StudentContext.Provider value={{\n      waitingScreen,\n      waitingScreenMessage,\n      // type,\n      slide,\n      allowedToDraw,\n    }}\n    >\n      {children}\n    </StudentContext.Provider>\n  );\n};\n\nexport {StudentContextProvider, StudentContext};\n","import React, {useContext, useState} from 'react';\nimport PropTypes from \"prop-types\";\n\nimport TipArea from \"./canvasAreaLayout/TipArea\";\nimport Canvas from \"./canvasAreaLayout/Canvas\";\nimport ToolPanel from \"./canvasAreaLayout/ToolPanel\";\n\nimport {TOOLS} from \"../../../utils/types\";\n\nimport {useUser} from \"../../../hooks/useUser\";\nimport {TeacherContext} from \"../../../context/TeacherContext\";\nimport {StudentContext} from \"../../../context/StudentContext\";\n\nimport './CanvasArea.scss'\n\nconst CanvasArea = ({room, sidebarOpen}) => {\n  const {user: {type: usertype}} = useUser();\n  const {slide: teacherContextSlide} = useContext(TeacherContext)\n  const {slide: studentContextSlide, allowedToDraw: contextAllowedToDraw} = useContext(StudentContext)\n\n  const { img, tip, hasChessboard, hasAbacus } = usertype === 'teacher' ? teacherContextSlide : studentContextSlide;\n  const allowedToDraw = usertype === 'teacher' ? true : contextAllowedToDraw;\n\n  const [drawWidth, setDrawWidth] = useState(2);\n  const [drawColor, setDrawColor] = useState('red');\n  const [activeTool, setActiveTool] = useState(TOOLS.DEFAULT);\n\n  return (\n    <div className={\"canvas-area\"}>\n      <TipArea tip={tip}/>\n\n      <Canvas\n        room={room}\n        img={img}\n        hasChessboard={hasChessboard}\n        hasAbacus={hasAbacus}\n        active={sidebarOpen && allowedToDraw}\n        activeTool={activeTool}\n        drawWidth={drawWidth}\n        drawColor={drawColor}\n      />\n\n      <ToolPanel\n        activeTool={activeTool}\n        setActiveTool={setActiveTool}\n        defWidth={drawWidth}\n        setDrawWidth={setDrawWidth}\n        defColor={drawColor}\n        setDrawColor={setDrawColor}\n      />\n    </div>\n  )\n}\n\nCanvasArea.propTypes = {\n  room: PropTypes.string.isRequired,\n  sidebarOpen: PropTypes.bool.isRequired,\n}\n\nexport default CanvasArea;","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport './StudentItem.scss'\n\nconst SlideItem = ({setAllowedStudent, student, allowedStudent}) => {\n\n  return (\n    <div className={'item-wrapper'}>\n      <div className={`item ${student.login === allowedStudent ? 'current' : ''}`}>\n\n        <div className={'name'}>\n          {student.name}\n        </div>\n\n        <div className={'button'} onClick={() => setAllowedStudent(student.login)}>Допустить</div>\n      </div>\n    </div>\n  )\n}\n\nSlideItem.propTypes = {\n  setAllowedStudent: PropTypes.func.isRequired,\n  student: PropTypes.object.isRequired,\n  allowedStudent: PropTypes.string\n}\n\nexport default SlideItem;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport StudentItem from \"./StudentItem\";\n\nconst StudentPicker = ({open, setOpen, students, setAllowedStudent, allowedStudent}) => {\n\n  return (\n    <div className={`item-picker student-picker ${open ? 'open' : ''}`}>\n      <div className={'picker-area'}>\n        <div className={'picker-menu-bg'} onClick={() => setOpen(false)}/>\n\n        <div className={'picker-items students'}>\n          {students.map(student => <StudentItem key={student._id} setAllowedStudent={setAllowedStudent}\n                                                student={student} allowedStudent={allowedStudent}/>)}\n        </div>\n\n      </div>\n\n    </div>\n  )\n}\n\nStudentPicker.propTypes = {\n  open: PropTypes.bool.isRequired,\n  setOpen: PropTypes.func.isRequired,\n  students: PropTypes.array.isRequired,\n  setAllowedStudent: PropTypes.func.isRequired,\n  allowedStudent: PropTypes.string,\n}\n\nexport default StudentPicker;\n\n\n\n\n\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst LevelItem = ({setLevel, level}) => {\n  return (\n    <div className={'item-wrapper'} onClick={setLevel}>\n      <div className={'item'}>{level.name}</div>\n    </div>\n  )\n}\n\nLevelItem.propTypes = {\n  setLevel: PropTypes.func.isRequired,\n  level: PropTypes.object.isRequired,\n}\n\nexport default LevelItem;","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport LevelItem from \"./LevelItem\";\n\nconst LevelPicker = ({open, setOpen, levels, setLevel}) => {\n  return (\n    <div className={`item-picker level-picker ${open ? 'open' : ''}`}>\n      <div className={`picker-area`}>\n        <div className={'picker-menu-bg'} onClick={() => setOpen(false)}/>\n\n        <div className={'picker-items levels'}>\n          {levels.map(level => <LevelItem key={level._id} setLevel={() => setLevel(level)} level={level}/>)}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nLevelPicker.propTypes = {\n  levels: PropTypes.array.isRequired,\n  setLevel: PropTypes.func.isRequired,\n  open: PropTypes.bool.isRequired,\n  setOpen: PropTypes.func.isRequired,\n}\n\nexport default LevelPicker;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst LessonItem = ({setLesson, lesson}) => {\n  return (\n    <div className={'item-wrapper'} onClick={setLesson}>\n      <div className={'item'}>{lesson.name}</div>\n    </div>\n  )\n}\n\nLessonItem.propTypes = {\n  setLesson: PropTypes.func.isRequired,\n  lesson: PropTypes.object.isRequired,\n}\n\nexport default LessonItem;","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport LessonItem from \"./LessonItem\";\n\nconst LessonPicker = ({open, setOpen, lessons, setLesson}) => {\n  return (\n    <div className={`item-picker lesson-picker ${open ? 'open' : ''}`}>\n      <div className={`picker-area`}>\n        <div className={'picker-menu-bg'} onClick={() => setOpen(false)}/>\n\n        <div className={'picker-items levels'}>\n          {lessons && lessons.map(lesson => <LessonItem key={lesson._id} setLesson={() => setLesson(lesson)} lesson={lesson}/>)}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nLessonPicker.propTypes = {\n  lessons: PropTypes.array,\n  setLesson: PropTypes.func.isRequired,\n  open: PropTypes.bool.isRequired,\n  setOpen: PropTypes.func.isRequired,\n}\n\nexport default LessonPicker;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst SlideItem = ({setSlide, slide}) => {\n\n  return (\n    <div className={`item-wrapper slide ${slide.img ? '' : 'empty'}`} onClick={setSlide}>\n      <div className={'img-wrapper'}>\n\n        {slide.img ? <img src={slide.img} alt=\"Слайд\"/> : <div className={'content'}>Информация для педагога</div>}\n\n      </div>\n    </div>\n  )\n}\n\nSlideItem.propTypes = {\n  setSlide: PropTypes.func.isRequired,\n  slide: PropTypes.object.isRequired,\n}\n\nexport default SlideItem;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport SlideItem from \"./SlideItem\";\n\nconst SlidePicker = ({open, setOpen, slides, setSlide}) => {\n  return (\n    <div className={`item-picker slide-picker ${open ? 'open' : ''}`}>\n      <div className={`picker-area`}>\n        <div className={'picker-menu-bg slides'} onClick={() => setOpen(false)}/>\n\n        <div className={'picker-items slides'}>\n          {slides && slides.map(slide => <SlideItem key={slide._id} setSlide={() => setSlide(slide)} slide={slide}/>)}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nSlidePicker.propTypes = {\n  slides: PropTypes.array,\n  setSlide: PropTypes.func.isRequired,\n  open: PropTypes.bool.isRequired,\n  setOpen: PropTypes.func.isRequired,\n}\n\nexport default SlidePicker;\n","import React, {useContext, useEffect, useState} from 'react';\nimport PropTypes from \"prop-types\";\nimport {useParams} from \"react-router-dom\";\n\nimport Header from \"../ui/Header\";\n\nimport WaitingScreen from \"../ui/WaitingScreen\";\n\nimport VideoArea from \"./videoArea/VideoArea\";\nimport CanvasArea from \"./canvasArea/CanvasArea\";\n\nimport StudentPicker from \"./pickersArea/studentPicker/StudentPicker\";\n\nimport LevelPicker from \"./pickersArea/levelPicker/LevelPicker\";\nimport LessonPicker from \"./pickersArea/lessonPicker/LessonPicker\";\nimport SlidePicker from \"./pickersArea/slidePicker/SlidePicker\";\n\nimport api from \"../../utils/api\";\n\nimport {useSocket} from \"../../hooks/useSocket\";\nimport {useUser} from \"../../hooks/useUser\";\n\nimport \"./ClassRoom.scss\";\nimport {TeacherContext} from \"../../context/TeacherContext\";\nimport {StudentContext} from \"../../context/StudentContext\";\n\nconst ClassRoom = ({logout}) => {\n  const {teacher} = useParams();\n  const {socket} = useSocket();\n  const {user} = useUser();\n\n  const {allowedStudent} = useContext(TeacherContext)\n  const {waitingScreen, waitingScreenMessage} = useContext(StudentContext)\n\n  const [lesson, setLesson] = useState({});\n  const [level, setLevel] = useState({});\n\n  const [students, setStudents] = useState([]);\n  const [levels, setLevels] = useState([]);\n  const [lessons, setLessons] = useState([]);\n  const [slides, setSlides] = useState([]);\n\n  const [slidePickerOpen, setSlidePickerOpen] = useState(false);\n  const [lessonPickerOpen, setLessonPickerOpen] = useState(false);\n  const [levelPickerOpen, setLevelPickerOpen] = useState(false);\n\n  const [studentPickerOpen, setStudentPickerOpen] = useState(false);\n\n  useEffect(() => {\n    const getStudents = async () => {\n      if (user.type === 'teacher') {\n        const res = await api.post('/teacher/get-students', {teacherLogin: user.login});\n        setStudents(res.data.students);\n      }\n    }\n    getStudents().catch((err) => console.error(err))\n\n  }, [user]);\n\n  useEffect(() => {\n    const getLessons = async () => {\n      if (user.type === 'teacher') {\n        const res = await api.post('/level/get-levels', {login: user.login});\n        setLevels(res.data.levels);\n      }\n    }\n    getLessons().catch((err) => console.error(err))\n\n  }, [user]);\n\n  useEffect(() => {\n    const getLevels = async () => {\n      if (user.type === 'teacher' && level._id) {\n        const res = await api.post('/level/get-lessons', {level: level._id});\n        setLessons(res.data.lessons);\n      }\n    }\n    getLevels().catch((err) => console.error(err))\n\n  }, [level]);\n\n  useEffect(() => {\n    const getSlides = async () => {\n      if (user.type === 'teacher' && lesson._id) {\n        const res = await api.post('/level/get-slides', {lesson: lesson._id});\n        setSlides(res.data.slides);\n      }\n    }\n    getSlides().catch((err) => console.error(err))\n\n  }, [lesson]);\n\n  useEffect(() => {\n    if (user.type === 'teacher') socket.emit(\"join-teacher\", {room: teacher, login: user.login});\n    else if (user.type === 'student') socket.emit(\"join-student\", {room: teacher, login: user.login});\n  }, [user, socket, teacher]);\n\n  const studentPicked = (value) => {\n    socket.emit(\"student-allow\", {teacherLogin: teacher, studentLogin: value});\n  }\n\n  const levelPicked = (newLevel) => {\n    setLevel(newLevel);\n    setLevelPickerOpen(false);\n    setLessonPickerOpen(true);\n  }\n\n  const lessonPicked = (newLesson) => {\n    setLesson(newLesson);\n    setLessonPickerOpen(false);\n    setSlidePickerOpen(true);\n  }\n\n  const slidePicked = (value) => {\n    socket.emit(\"canvas-change-slide\", {teacherLogin: teacher, slide: value});\n  }\n\n\n  return (\n    <div className={\"class-room\"}>\n      <WaitingScreen message={waitingScreenMessage} active={waitingScreen}/>\n      <Header logout={logout}/>\n      <div className={'waiting-screen-class-room-wrapper'}>\n\n        <section className={\"class-room-wrapper\"}>\n          <VideoArea room={teacher}/>\n\n          <CanvasArea\n            room={teacher}\n            sidebarOpen={!lessonPickerOpen && !levelPickerOpen && !studentPickerOpen}\n          />\n\n          {user.type === 'teacher' ?\n            <SlidePicker open={slidePickerOpen}\n                       setOpen={setSlidePickerOpen}\n                       slides={slides}\n                       setSlide={slidePicked}/> : ''}\n\n\n          {user.type === 'teacher' ?\n            <div className={'pickers'}>\n\n\n              <LessonPicker open={lessonPickerOpen}\n                            setOpen={setLessonPickerOpen}\n                            lessons={lessons}\n                            setLesson={lessonPicked}/>\n\n              <LevelPicker open={levelPickerOpen}\n                           setOpen={setLevelPickerOpen}\n                           levels={levels}\n                           setLevel={levelPicked}/>\n\n\n              <StudentPicker open={studentPickerOpen}\n                             setOpen={setStudentPickerOpen}\n                             students={students}\n                             setAllowedStudent={studentPicked}\n                             allowedStudent={allowedStudent}/>\n\n              <div className={'menus-buttons'}>\n\n                {!studentPickerOpen && <div className={'button-holder levels'}>\n                  <div className={'button'} onClick={() => setLevelPickerOpen(!levelPickerOpen)}>Уровни</div>\n                </div>}\n\n                {!lessonPickerOpen && <div className={'button-holder students'}>\n                  <div className={'button'} onClick={() => setStudentPickerOpen(!studentPickerOpen)}>Ученики</div>\n                </div>}\n\n              </div>\n            </div>\n\n            : ''}\n\n        </section>\n\n      </div>\n    </div>\n  )\n}\n\nClassRoom.propTypes = {\n  user: PropTypes.object.isRequired,\n  logout: PropTypes.func.isRequired,\n};\n\nexport default ClassRoom;","import React, {useState} from \"react\";\nimport api from \"../../utils/api\";\nimport { useAlert } from 'react-alert'\n\nimport GoBack from \"../ui/GoBack\";\n\nimport {useParams} from \"react-router-dom\";\n\nconst ResetPassword = () => {\n  const alert = useAlert()\n  const {user, type} = useParams();\n\n  const [oldPassword, setOldPassword] = useState()\n  const [password, setPassword] = useState()\n  const [passwordConfirm, setPasswordConfirm] = useState()\n\n  const handleSubmit = async () => {\n    if (password !== passwordConfirm) {\n      return alert.show('Пароли не совпадают')\n    }\n    try {\n      await api.post(`/${type}/set-password`, {login: user, oldPassword, password});\n      alert.show('Пароль сменен успешно')\n\n    } catch (e) {\n      e.response.data.errors.forEach(err => {\n        alert.show(err.msg)\n      })\n    }\n  }\n\n  return (\n    <div className={\"menu-bg\"} id={'resetPassForm'}>\n      <div className={\"menu-wrapper\"}>\n        <form className='form' onSubmit={(e) => handleSubmit(e)}>\n          <div className=\"login-header\">\n            <p><span className='golden-compass'><span className='g-letter'>С</span></span>менить пароль</p>\n          </div>\n          <div className={'inputs-wrapper'}>\n            <div className=\"form-group field\">\n              <input type=\"password\" className=\"form-field\" placeholder=\"Ваш старый пароль\" name=\"oldPassword\"\n                     id='oldPassword'\n                     onChange={e => setOldPassword(e.target.value)} required/>\n              <label htmlFor=\"oldPassword\" className=\"form-label\">Ваш старый пароль</label>\n            </div>\n\n            <div className=\"form-group field\">\n              <input type=\"password\" className=\"form-field\" placeholder=\"Введите новый пароль\" name=\"password\"\n                     id='password'\n                     onChange={e => setPassword(e.target.value)} required/>\n              <label htmlFor=\"password\" className=\"form-label\">Введите новый пароль</label>\n            </div>\n\n            <div className=\"form-group field\">\n              <input type=\"password\" className=\"form-field\" placeholder=\"Введите новый пароль повторно\"\n                     name=\"passwordConfirm\"\n                     id='passwordConfirm'\n                     onChange={e => setPasswordConfirm(e.target.value)} required/>\n              <label htmlFor=\"passwordConfirm\" className=\"form-label\">Введите новый пароль повторно</label>\n            </div>\n\n            <div className='submit-btn-wrapper'>\n              <button type=\"submit\" className='btn' id='loginBtn'>\n                <span>Сменить пароль</span>\n              </button>\n            </div>\n          </div>\n        </form>\n        <GoBack/>\n\n      </div>\n    </div>\n  );\n}\n\nexport default ResetPassword;","import React, {useState} from 'react';\nimport {HashRouter as Router, Redirect, Route, Switch} from 'react-router-dom';\n\nimport {useUser} from \"./hooks/useUser\";\n\nimport Login from \"./components/login/Login\";\nimport TeacherMenu from \"./components/teacherMenu/TeacherMenu\";\nimport TeachersList from \"./components/teachersList/TeachersList\";\n\nimport ErrorFallback from \"./components/ui/ErrorFallback\"\nimport StudentMenu from \"./components/studentMenu/StudentMenu\"\nimport PrivateRoute from \"./components/ui/PrivateRoute\";\nimport ClassRoom from \"./components/classRoom/ClassRoom\";\nimport ResetPassword from \"./components/resetPassword/ResetPassword\";\nimport {ErrorBoundary} from 'react-error-boundary';\n\nimport \"./App.css\"\nimport \"./Common.scss\"\nimport api from \"./utils/api\";\n// import {serverUrl} from './config.json';\n// import io from 'socket.io-client'\nconst App = () => {\n  const baseURL = process.env.PUBLIC_URL\n  console.log(baseURL)\n  // const socket = io(serverUrl);\n  // let startTime;\n  //\n  // useEffect(() => {\n  //   setInterval(function () {\n  //     startTime = Date.now();\n  //     socket.emit('ping');\n  //   }, 2000);\n  //\n  //   socket.on('pong', function () {\n  //     let latency = Date.now() - startTime;\n  //     console.log(latency);\n  //   });\n  // }, [])\n\n  const {user, getUser} = useUser();\n\n  const [auth, setAuth] = useState({user: user, isAuthenticated: Boolean(user && user.token), isLoading: false})\n\n  const logout = () => {\n    setAuth({user: undefined, isAuthenticated: false, isLoading: false});\n  };\n\n  const myErrorHandler = (e, componentStack) => {\n    const user = getUser()\n    const message = e\n    const stack = componentStack.componentStack || componentStack\n    api.post('/errors', {error: message, componentStack: stack, user}).catch(console.error);\n  };\n\n  window.addEventListener(\"error\", function (e) {\n    const user = getUser()\n    const message = e.error.message || e.message || e.error\n    const componentStack = e.error.stack || \"\"\n    api.post('/errors', {error: message, componentStack: componentStack, user}).catch(console.error);\n  })\n\n  return (\n    <ErrorBoundary\n      FallbackComponent={ErrorFallback}\n      onError={myErrorHandler}\n    >\n      <section className=\"container\">\n        <Router>\n          <Switch>\n            {/* Sign In Page */}\n            <Route exact path=\"/login\"\n                   render={(props) =>\n                     <Login {...props} setAuth={setAuth}/>\n                   }/>\n\n            {/* Teacher Menu */}\n            {auth.user && auth.user.type === 'teacher' &&\n              <PrivateRoute exact path=\"/teacher\"\n                            component={TeacherMenu}\n                            auth={{isAuthenticated: auth.isAuthenticated, isLoading: auth.isLoading}}\n                            logout={logout}/>\n            }\n\n            {/* Student Menu */}\n            {auth.user && auth.user.type === 'student' &&\n              <PrivateRoute exact path=\"/student\"\n                            component={StudentMenu}\n                            auth={{isAuthenticated: auth.isAuthenticated, isLoading: auth.isLoading}}\n                            logout={logout}/>\n            }\n\n            {/* Student Available Teachers */}\n            {auth.user && auth.user.type === 'student' &&\n              <PrivateRoute exact path=\"/teachers-list\"\n                            component={TeachersList}\n                            auth={{isAuthenticated: auth.isAuthenticated, isLoading: auth.isLoading}}/>\n            }\n\n            {/* canvas will determine content by type and room */}\n            <PrivateRoute exact path=\"/canvas/:teacher\"\n                          component={ClassRoom}\n                          auth={auth}\n                          user={auth.user}\n                          logout={logout}/>\n\n            {/* Reset pass word */}\n            <PrivateRoute exact path=\"/reset-password/:user/:type\"\n                          component={ResetPassword}\n                          auth={auth}\n                          user={auth.user}\n                          logout={logout}/>\n\n            {/* 404 Page */}\n            <Route path=\"*\" render={\n              () => {\n                if (auth.isAuthenticated) {\n                  if (auth.user.type === 'student') {\n                    return <Redirect to=\"/student\"/>\n                  } else if (auth.user.type === 'teacher') {\n                    return <Redirect to=\"/teacher\"/>\n                  } else {\n                    return <Redirect to=\"/login\"/>\n                  }\n                } else {\n                  return <Redirect to=\"/login\"/>\n                }\n              }\n            }/>\n          </Switch>\n        </Router>\n      </section>\n    </ErrorBoundary>\n  );\n};\n\nexport default App;","import { VideoContextProvider } from \"./VideoContext\";\nimport { TeacherContextProvider } from './TeacherContext';\nimport { StudentContextProvider } from './StudentContext';\nimport { combineComponents } from '../utils/combineComponents';\n\nconst providers = [\n  VideoContextProvider,\n  TeacherContextProvider,\n  StudentContextProvider,\n]\n\nexport const AppContextProvider = combineComponents(...providers);\n","import React from 'react';\n\nexport const combineComponents = (...components) => {\n  return components.reduce(\n    (AccumulatedComponents, CurrentComponent) => {\n      return ({ children }) => {\n        return (\n          <AccumulatedComponents>\n            <CurrentComponent>{children}</CurrentComponent>\n          </AccumulatedComponents>\n        );\n      }\n    },\n    ({ children }) => <>{children}</>,\n  );\n};","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {transitions, positions, Provider as AlertProvider} from 'react-alert'\nimport AlertTemplate from 'react-alert-template-basic'\n\nimport App from './App';\nimport {AppContextProvider} from \"./context/AppContextProvider\";\n\nimport './index.css';\n// optional configuration\nconst options = {\n  // you can also just use 'bottom center'\n  position: positions.BOTTOM_CENTER,\n  timeout: 5000,\n  offset: '30px',\n  // you can also just use 'scale'\n  transition: transitions.SCALE\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <AlertProvider template={AlertTemplate} {...options}>\n      <AppContextProvider>\n        <App/>\n      </AppContextProvider>\n    </AlertProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","module.exports = __webpack_public_path__ + \"static/media/logo.7352a14e.png\";","module.exports = __webpack_public_path__ + \"static/media/cursor.7fd2b441.png\";","module.exports = __webpack_public_path__ + \"static/media/blackPawn.1315ca02.png\";","module.exports = __webpack_public_path__ + \"static/media/blackBishop.eaf3b510.png\";","module.exports = __webpack_public_path__ + \"static/media/blackHorse.fecb1acf.png\";","module.exports = __webpack_public_path__ + \"static/media/blackRook.d4a99eb8.png\";","module.exports = __webpack_public_path__ + \"static/media/blackQueen.eb705e84.png\";","module.exports = __webpack_public_path__ + \"static/media/blackKing.90fe0414.png\";","module.exports = __webpack_public_path__ + \"static/media/whitePawn.1926aeb5.png\";","module.exports = __webpack_public_path__ + \"static/media/whiteBishop.4e79228b.png\";","module.exports = __webpack_public_path__ + \"static/media/whiteHorse.9621487d.png\";","module.exports = __webpack_public_path__ + \"static/media/whiteRook.29917334.png\";","module.exports = __webpack_public_path__ + \"static/media/whiteQueen.ece13601.png\";","module.exports = __webpack_public_path__ + \"static/media/whiteKing.c8f01d9c.png\";"],"sourceRoot":""}